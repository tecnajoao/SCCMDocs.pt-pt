---
title: "Планирование обновлений программного обеспечения | Документы Майкрософт"
description: "Перед использованием обновлений программного обеспечения в рабочей среде System Center Configuration Manager необходимо спланировать инфраструктуру точек обновления программного обеспечения."
keywords: 
author: dougeby
ms.author: dougeby
manager: angrobe
ms.date: 06/27/2017
ms.topic: article
ms.prod: configuration-manager
ms.service: 
ms.technology: configmgr-sum
ms.assetid: d071b0ec-e070-40a9-b7d4-564b92a5465f
ms.openlocfilehash: 8b739a01a6bb5cacf0f7109e2e6fa3b31dd666d3
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="plan-for-software-updates-in-system-center-configuration-manager"></a>Планирование обновлений программного обеспечения в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Прежде чем использовать обновления ПО в рабочей среде System Center Configuration Manager, важно выполнить процесс планирования. Правильный план для инфраструктуры точек обновления ПО — залог успешного внедрения функций обновления ПО.

## <a name="capacity-planning-recommendations-for-software-updates"></a>Рекомендации по планированию ресурсов для обновлений программного обеспечения  
 Следующие рекомендации можно принять за основу при определении того, какие сведения подходят вашей организации для процесса планирования ресурсов, необходимых для поддержки обновления программного обеспечения. Фактические требования к ресурсам могут отличаться от рекомендованных в этом разделе в зависимости от следующих критериев: используемая сетевая среда, оборудование, на котором размещена система сайта точки обновления ПО, количество установленных клиентов и количество ролей системы сайта, установленных на сервере.  

###  <a name="BKMK_SUMCapacity"></a> Планирование ресурсов для точки обновления программного обеспечения  
 Число поддерживаемых клиентов зависит от версии служб Windows Server Update Services (WSUS), которая запущена на точке обновления программного обеспечения, а также от наличия у системы сайта другой роли, помимо роли точки обновления программного обеспечения:  

-   Точка обновления программного обеспечения может поддерживать до 25 000 клиентов, если на компьютере точки обновления программного обеспечения запущены службы WSUS и эта точка сосуществует с другой ролью системы сайта.  

-   Точка обновления программного обеспечения может поддерживать до 150 000 клиентов при условии, что удаленный компьютер удовлетворяет требованиям WSUS, WSUS используется с Configuration Manager и вы произвели указанные ниже настройки.

    Пулы приложений IIS.
    - Увеличьте длину очереди WsusPool до 2000.
    - Увеличьте предельное значение выделенной памяти WsusPool в 4 раза или установите его в 0 (без ограничений).      

    Подробные сведения о требованиях к оборудованию для точки обновления программного обеспечения см. в разделе [Рекомендуемое оборудование для систем сайта](/sccm/core/plan-design/configs/recommended-hardware#a-namebkmkscalesiesystemsa-site-systems).

-   По умолчанию Configuration Manager не поддерживает настройку точек обновления программного обеспечения для работы в качестве кластеров балансировки сетевой нагрузки (NLB). Для Configuration Manager версии ниже 1702 вы можете использовать пакет SDK для Configuration Manager, чтобы настроить до четырех точек обновления программного обеспечения в кластере NLB. Однако начиная с версии Configuration Manager 1702 точки обновления программного обеспечения не поддерживаются в качестве кластеров NLB. Кроме того, если эта конфигурация будет обнаружена, обновления до Configuration Manager версии 1702 будут заблокированы.

### <a name="capacity-planning-for-software-updates-objects"></a>Планирование ресурсов для объектов обновлений программного обеспечения  
 При планировании объектов обновлений ПО используйте следующую информацию о ресурсах.  

-   **Ограничение в 1000 обновлений ПО в составе развертывания**  

     Необходимо установить ограничение количества обновлений, равное 1000, для каждого развертывания обновлений программного обеспечения. При создании правила автоматического развертывания укажите критерий, ограничивающий количество возвращаемых обновлений программного обеспечения. Выполнение правила автоматического развертывания завершается неудачно, когда указанный критерий возвращает более 1000 обновлений программного обеспечения. Состояние правила автоматического обновления можно проверить с помощью узла **Правила автоматического развертывания** в консоли Configuration Manager. При развертывании обновлений вручную выбирайте не более 1000 обновлений для развертывания.  

     Кроме того, количество обновлений ПО в конфигурационной базе должно быть ограничено 1000. Дополнительные сведения см. в разделе [Создание конфигурационных баз](../../compliance/deploy-use/create-configuration-baselines.md).

##  <a name="BKMK_SUPInfrastructure"></a> Определение инфраструктуры точек обновления программного обеспечения  
 Для развертывания обновлений ПО на сайте центра администрирования и на всех первичных дочерних сайтах должна быть точка обновления программного обеспечения. В ходе планирования инфраструктуры точки обновления программного обеспечения необходимо определить следующие зависимости:
 - где именно следует установить точку обновления программного обеспечения для сайта;
 - какие сайты требуют наличия точки обновления программного обеспечения, способной обмениваться данными с интернет-клиентами;
 - нужна ли точка обновления программного обеспечения на дополнительном сайте.

Используйте информацию в следующих разделах при определении инфраструктуры точек обновления программного обеспечения.  

> [!IMPORTANT]  
>  Сведения о внутренних и внешних зависимостях, которые необходимы для обновления программного обеспечения, см. в разделе [Необходимые условия для обновлений программного обеспечения](prerequisites-for-software-updates.md).  

 На первичном сайте Configuration Manager можно добавить несколько точек обновления программного обеспечения. Возможность иметь несколько точек обновления программного обеспечения на одном сайте позволяет обеспечить отказоустойчивость, не прибегая к сложной системе балансировки сетевой нагрузки. Однако резервирование с помощью нескольких точек обновления программного обеспечения не настолько надежно, как применение специализированной системы балансировки сетевой нагрузки, оно скорее рассчитано на обеспечение отказоустойчивости. Кроме того, схема отработки отказа точки обновления программного обеспечения несколько отличается от модели чисто случайного выбора, применяемой при проектировании точек управления. В отличие от точек управления, переключение на новую точку обновления программного обеспечения приводит к затратам на стороне клиента и снижению производительности сети. Когда клиент переключается на новый сервер WSUS для сканирование на наличие обновлений программного обеспечения, это вызывает рост размеров каталога и повышение требований к производительности клиента и сети. В связи с этим клиент сохраняет сопоставление с последней точкой обновления программного обеспечения, которую он успешно просканировал.  

 Первая точка обновления программного обеспечения, установленная на первичном сайте, служит источником синхронизации для всех дополнительных точек обновления программного обеспечения, добавляемых к первичному сайту. Завершив добавление точек обновления программного обеспечения и инициализацию синхронизации обновлений программного обеспечения, можно просмотреть состояние точек обновления программного обеспечения и источника синхронизации с помощью узла **Состояние синхронизации точки обновления программного обеспечения** в рабочей области **Мониторинг** .  

 В случае отказа точки обновления программного обеспечения, настроенной в качестве источника синхронизации для других точек обновления программного обеспечения на этом сайте, необходимо вручную удалить сбойную точку обновления программного обеспечения и выбрать новую точку обновления программного обеспечения в качестве источника синхронизации. Дополнительные сведения об удалении точки обновления программного обеспечения см. в разделе [Удаление роли системы сайта "Точка обновления программного обеспечения"](../get-started/remove-a-software-update-point.md).  

###  <a name="BKMK_SUPList"></a> Список точек обновления программного обеспечения  
 Configuration Manager предоставляет клиенту список точек обновления программного обеспечения в следующих сценариях: когда новый клиент получает политику, разрешающую обновления программного обеспечения, или когда клиент не может связаться со своей точкой обновления программного обеспечения и ему нужно переключиться на другую точку обновления. Клиент случайным образом выбирает из списка точку обновления программного обеспечения, отдавая предпочтение точкам обновления программного обеспечения, расположенным в одном лесу. Configuration Manager предоставляет клиентам различные списки в зависимости от их типов.  

-   **Интранет-клиенты**: Получают список точек обновления программного обеспечения, которые можно настроить для получения соединений только из интрасети, или же список точек обновления программного обеспечения, поддерживающих соединения из интрасети и из Интернета.  

-   **Интернет-клиенты**: получают список точек обновления программного обеспечения, которые можно настроить для получения соединений только из Интернета, или же список точек обновления программного обеспечения, поддерживающих соединения из интрасети и из Интернета.  

###  <a name="BKMK_SUPSwitching"></a> Переключение точек обновления программного обеспечения  
> [!NOTE]
> Начиная с версии 1702 клиенты используют группы границ для поиска точки обновления программного обеспечения. Они используют механизм резервирования, чтобы найти новую точку обновления ПО, если текущая точка становится недоступной. Вы можете добавлять отдельные точки обновления в разные группы границ, чтобы контролировать, какие серверы может найти каждый клиент. Дополнительные сведения см. в разделе [о точках обновления программного обеспечения](/sccm/core/servers/deploy/configure/boundary-groups#software-update-points) статьи [о настройке групп границ](/sccm/core/servers/deploy/configure/boundary-groups).

Если на одном сайте имеется несколько точек обновления программного обеспечения, а затем одна из них становится неисправной или недоступной. то клиенты подключаются к другой точке обновления программного обеспечения и продолжают сканировать ее на наличие новейших обновлений программного обеспечения. Когда клиент впервые назначается точке обновления программного обеспечения, он остается назначенным этой точке до тех пор, пока сканирование на наличие обновлений программного обеспечения на этой точке не завершится неудачей.  

Сбой сканирования на наличие обновлений программного обеспечения может быть связан с выдачей различных кодов ошибок, которые могут допускать или не допускать повторение операции. Когда сканирование завершается сбоем и выдачей кода ошибки, допускающей повторение операции, клиент запускает повторную процедуру сканирования на наличие обновлений программного обеспечения на точке обновления программного обеспечения. Как правило, высокоуровневым условием выдачи кода ошибки, допускающей повторение операции, является недоступность или временная перегруженность сервера WSUS. В случае сбоя сканирования на наличие обновлений программного обеспечения клиент прибегает к следующей процедуре:  

1.  Клиент выполняет сканирование на наличие обновлений программного обеспечения согласно расписанию или в случае инициирования этой процедуры при помощи панели управления клиентом или SDK. В случае сбоя сканирования клиент ожидает 30 минут перед повторным сканированием той же самой точки обновления программного обеспечения.  

2.  Клиент повторяет эту процедуру минимум четыре раза через 30-минутные интервалы. После четвертой неудачной попытки, подождав еще две минуты, клиент переходит к следующей точке обновления программного обеспечения в списке точек обновления программного обеспечения.  

3.  Клиент выполняет те же действия для новой точки обновления программного обеспечения. После успешного сканирования клиент будет подключаться к новой точке обновления программного обеспечения.

 Следующие список содержит дополнительные сведения, полезные при анализе сценариев повторного доступа к точкам обновления программного обеспечения и переключения между точками:  

-   Если клиент отключен от корпоративной интрасети и процедура сканирования обновлений программного обеспечения завершается неудачно, то он не переключается на новую точку обновления программного обеспечения. Этот сбой является ожидаемым, поскольку клиент не может подключиться к корпоративной сети или точке обновления программного обеспечения, поддерживающей подключения из интрасети. Клиент Configuration Manager определяет доступность точки обновления программного обеспечения в интрасети.  

-   Если включено интернет-управление клиентами и имеется несколько точек обновления программного обеспечения, настроенных для обмена данными с клиентами через Интернет, то процедура переключения аналогична стандартной процедуре повторного подключения, описанной в предыдущем сценарии.  

-   Если процедура сканирования начата, но клиент отключился перед завершением сканирования, то это не считается сбоем сканирования и не включается в число четырех повторов.  

При получении ошибки с одним из следующих кодов от агента обновления Windows Configuration Manager попросит клиента установить подключение повторно:  

2149842970, 2147954429, 2149859352, 2149859362, 2149859338, 2149859344, 2147954430, 2147747475, 2149842974, 2149859342, 2149859372, 2149859341, 2149904388, 2149859371, 2149859367, 2149859366, 2149859364, 2149859363, 2149859361, 2149859360, 2149859359, 2149859358, 2149859357, 2149859356, 2149859354, 2149859353, 2149859350, 2149859349, 2149859340, 2149859339, 2149859332, 2149859333, 2149859334, 2149859337, 2149859336, 2149859335

Чтобы понять содержание ошибки, нужно преобразовать десятичный код ошибки в шестнадцатеричный и затем найти его на одном из сайтов, например [Агент обновления Windows — вики-сайт по кодам ошибок](https://social.technet.microsoft.com/wiki/contents/articles/15260.windows-update-agent-error-codes.aspx).


###  <a name="BKMK_ManuallySwitchSUPs"></a> Ручное переключение клиентов на новую точку обновления программного обеспечения
Начиная с версии Configuration Manager 1606, можно включить возможность для клиентов Configuration Manager перейти на новую точку обновления программного обеспечения, если возникают проблемы с активной точкой. Выбор этого параметра приводит к изменениям только в том случае, если клиент получает несколько точек обновления программного обеспечения из точки управления.

> [!IMPORTANT]    
> При переходе на новый сервер устройства используют механизм резервирования для поиска этого сервера. Поэтому важно следить за конфигураций групп границ, чтобы перед началом таких изменений все точки обновления программного обеспечения были правильно включены в группы границ. Подробные сведения см. в статье о [точках обновления программного обеспечения](/sccm/core/servers/deploy/configure/boundary-groups#software-update-points).
>
> Переключение на новую точку обновления программного обеспечения может создавать дополнительный сетевой трафик. Объем трафика зависит от параметров конфигурации WSUS (классификации обновлений, продукты, совместное использование базы данных WSUS точками обновления программного обеспечения и т. д.). Если вы планируете переключить несколько устройств, постарайтесь сделать это в периоды обслуживания, чтобы снизить влияние на сеть во время синхронизации с новым сервером точки обновления программного обеспечения.

#### <a name="to-enable-the-option-to-switch-software-update-points"></a>Включение возможности перехода между точками обновления программного обеспечения  
Включите этот параметр для коллекции устройств или набора выбранных устройств. После его включения клиенты будут выполнять поиск другой точки обновления программного обеспечения во время следующей проверки.

1.  В консоли Configuration Manager перейдите в раздел **Активы и соответствие > Обзор > Коллекции устройств**.  

2.  На вкладке **Главная** в группе **Коллекция** щелкните **Уведомление клиента**, а затем щелкните **Перейти к следующей точке обновления программного обеспечения**.  


###  <a name="BKMK_SUP_CrossForest"></a> Точки обновления программного обеспечения в лесу без доверия  
 На сайте можно создать одну или несколько точек обновления программного обеспечения для поддержки клиентов в лесу без доверия. Чтобы добавить точку обновления программного обеспечения в другом лесу, необходимо сначала установить и настроить сервер WSUS в этом лесу. Затем запустите мастер, чтобы добавить сервер сайта Configuration Manager с ролью системы сайта "Точка обновления программного обеспечения". В этом мастере настройте следующие параметры для успешного подключения к WSUS в лесу без доверия:  

-   Укажите учетную запись установки системы сайта, которая обладает доступом к серверу WSUS в этом лесу.  

-   Укажите учетную запись подключения к серверу WSUS, которую следует использовать для подключения к серверу WSUS.  

 Например, имеется первичный сайт в лесу A с двумя точками обновления программного обеспечения (SUP01 и SUP02). Кроме того, для этого же первичного сайта имеются две точки обновления программного обеспечения (SUP03 и SUP04) в лесу B. Когда в этом примере происходит переключение, точки обновления программного обеспечения из одного леса в качестве клиента получают наибольший приоритет.  

###  <a name="BKMK_WSUSSyncSource"></a> Использование существующего сервера WSUS в качестве источника синхронизации для сайта верхнего уровня  
 Как правило, сайт верхнего уровня в иерархии настроен для синхронизации метаданных обновлений программного обеспечения с Центром обновления Майкрософт. Если корпоративная политика безопасности не разрешает доступ сайта верхнего уровня в Интернет, в качестве источника синхронизации для сайта верхнего уровня можно настроить существующий сервер WSUS, не принадлежащий к иерархии Configuration Manager. Например, сервер WSUS может быть установлен в сети периметра с доступом в Интернет, однако сайт верхнего уровня может быть установлен иначе. Сервер WSUS в сети периметра можно настроить в качестве источника синхронизации метаданных об обновлениях программного обеспечения. Необходимо убедиться в том, что сервер WSUS в сети периметра синхронизирует обновления ПО, соответствующие требуемым критериям иерархии Configuration Manager. В противном случае сайт верхнего уровня может не синхронизировать ожидаемые вами обновления программного обеспечения. При установке точки обновления программного обеспечения настройте учетную запись подключения к WSUS, которая имеет доступ к серверу WSUS в сети периметра и убедитесь, что брандмауэр пропускает трафик для соответствующих портов. Дополнительные сведения см. в списке [портов, используемых точкой обновления программного обеспечения для подключения к источнику синхронизации](../../core/plan-design/hierarchy/ports.md#BKMK_PortsSUP-WSUS).  

###  <a name="BKMK_NLBSUPSP1"></a> Точка обновления программного обеспечения, настроенная для использования балансировки сетевой нагрузки  
 Переключение точек обновления программного обеспечения, вероятнее всего, поможет решить стоящие перед вами задачи обеспечения отказоустойчивости. По умолчанию Configuration Manager не поддерживает настройку точек обновления программного обеспечения для работы в качестве кластеров балансировки сетевой нагрузки (NLB). Для Configuration Manager версии ниже 1702 вы можете использовать пакет SDK для Configuration Manager, чтобы настроить до четырех точек обновления программного обеспечения в кластере NLB. Однако начиная с версии Configuration Manager 1702 точки обновления программного обеспечения не поддерживаются в качестве кластеров NLB. Кроме того, если эта конфигурация будет обнаружена, обновления до Configuration Manager версии 1702 будут заблокированы. Дополнительные сведения о командлете PowerShell Set-CMSoftwareUpdatePoint см. в разделе [Set-CMSoftwareUpdatePoint](http://go.microsoft.com/fwlink/?LinkId=276834).

###  <a name="BKMK_SUPSecSite"></a> Точка обновления программного обеспечения на вторичном сайте  
 Устанавливать точку обновления программного обеспечения на вторичном сайте необязательно. При установке точки обновления ПО на дополнительном сайте база данных WSUS настраивается в качестве реплики точки обновления ПО по умолчанию на родительском основном сайте. На дополнительном сайте можно установит только одну точку обновления ПО. Присвоенные дополнительному сайту устройства настраиваются для использования активной точки обновления ПО на родительском сайте, если точка обновления ПО не установлена на дополнительном сайте. Как правило, активная точка обновления ПО устанавливается на дополнительном сайте при ограниченной пропускной способности сети между устройствами, присвоенными дополнительному сайту, и активной точкой обновления ПО на родительском сайте, или при исчерпании ресурсов точки обновления ПО. После успешной установки и настройки активной точки обновления ПО на вторичном сайте происходит обновление политики сайта на клиентских компьютерах, назначенных сайту, и эти клиентские компьютеры начинают использовать новую точку обновления ПО.  

##  <a name="BKMK_SUPInstallation"></a> Планирование установки точки обновления программного обеспечения  
 Перед созданием роли системы сайта для точки обновления ПО в Configuration Manager необходимо учесть ряд требований, зависящих от инфраструктуры Configuration Manager. С этим разделом особенно важно ознакомиться при настройке активной точки обновления на передачу данных по протоколу SSL, поскольку в этом случае потребуется выполнить дополнительные действия, чтобы добиться правильной работы точек обновления в вашей иерархии. В этом разделе содержатся сведения о необходимых действиях для успешного планирования и подготовки к установке точки обновления ПО.  

###  <a name="BKMK_SUPSystemRequirements"></a> Требования к точке обновления программного обеспечения  
 Роль системы сайта "Точка обновления программного обеспечения" необходимо установить в системе сайта, соответствующей минимальным требованиям для служб WSUS и для поддерживаемых конфигураций систем сайта Configuration Manager.  

-   Дополнительные сведения о минимальных требованиях к роли сервера WSUS в Windows Server 2012 см. в разделе [Проверка выполнения рекомендаций и требований к системе](https://technet.microsoft.com/library/hh852344.aspx#BKMK_1.1) в библиотеке документации по Windows Server 2012.  

-   Дополнительные сведения о поддерживаемых конфигурациях для систем сайта Configuration Manager см. в разделе [Необходимые условия для сайта и систем сайта](../../core/plan-design/configs/site-and-site-system-prerequisites.md).  

###  <a name="BKMK_PlanningForWSUS"></a> Планирование установки служб WSUS  

Для обновлений программного обеспечения требуется установка поддерживаемой версии WSUS на всех серверах систем сайтов, настроенных для роли точки обновления программного обеспечения. Кроме того, при установке активной точка обновления ПО на удаленной системе сайта необходимо установить консоль администрирования WSUS на компьютере сервера сайта, если эта консоль администрирования еще не установлена на этом компьютере. Это позволит серверу сайта обмениваться информацией со службами WSUS, работающими на активной точке обновления ПО.  

 При использовании служб WSUS совместно с Windows Server 2012 необходимо настроить дополнительные разрешения, которые позволят **WSUS Configuration Manager** в Configuration Manager подключаться к WSUS для периодической проверки работоспособности. Выберите один из следующих параметров для настройки разрешений.  

-   Добавьте учетную запись **SYSTEM** в группу **Администраторы WSUS**  

-   Добавьте учетную запись **NT AUTHORITY\SYSTEM** в качестве пользователя базы данных WSUS (SUSDB) и настройте минимальные параметры участия в роли базы данных webService.  

 Дополнительные сведения об установке WSUS в Windows Server 2012 см. в статье [IШаг 2. Установка роли сервера WSUS](http://go.microsoft.com/fwlink/p/?LinkId=272355) в библиотеке документации Windows Server 2012.  

 При установке нескольких точек обновления программного обеспечения на первичном сайте следует использовать одну и те же базу данных WSUS для всех точек обновления программного обеспечения в одном лесу Active Directory. Совместное использование одной и той же базы данных во многом помогает устранить эффект снижения производительности клиентов и сети, который может стать заметным при переключении клиентов на новую точку обновления ПО. Однако данный способ не позволяет полностью устранить этот эффект. Переключение клиента на новую точку обновления ПО, которая использует ту же самую базу, что и старая точка, все равно приводит к сканированию новой точки для обнаружения различий между ними. Однако масштабы этого сканирования куда меньше, чем в той ситуации, когда сервер WSUS имеет собственную базу данных.  

####  <a name="BKMK_CustomWebSite"></a> Настройка служб WSUS для использования настраиваемого веб-сайта  
 При установке WSUS можно либо использовать существующий веб-сайт IIS по умолчанию или создать настраиваемый веб-сайт WSUS. Следует создать настраиваемый веб-сайт для WSUS, чтобы службы IIS разместили службы WSUS на выделенном виртуальном веб-сайте вместо совместного использования того же самого веб-сайта, который используется другими системами сайта Configuration Manager и другими приложениями. Это особенно важно при установке роли системы сайта для точки обновления ПО на сервере сайта. Когда вы запускаете службы WSUS в Windows Server 2012 или Windows Server 2016, для них по умолчанию настраивается использование HTTP-порта 8530 и HTTPS-порта 8531. Необходимо указать эти параметры портов при создании активной точки обновления программного обеспечения для сайта.  

####  <a name="BKMK_WSUSInfrastructure"></a> Использование существующей инфраструктуры WSUS  
 Вы можете выбрать сервер WSUS, который уже использовался в вашей среде до того, как вы установили Configuration Manager в качестве точки обновления ПО. После завершения настройки точки обновления ПО необходимо указать параметры синхронизации. Configuration Manager подключается к серверу WSUS, который работает на сервере точки обновления ПО, и настраивает для WSUS такие же параметры. Если сервер WSUS до его назначения точкой обновления ПО выполнял синхронизацию с продуктами или классами, которые не указаны в параметрах синхронизации для точки обновления ПО, то метаданные обновлений ПО для продуктов и классов синхронизируются с метаданными всех обновлений ПО, содержащихся в базе данных WSUS, без учета параметров синхронизации, указанных вами для точки обновления ПО. Это может привести к непредвиденным программным обновлениям метаданных в базе данных сайта. Аналогичное поведение можно наблюдать в том случае, если напрямую добавить продукты и классы с помощью консоли администрирования WSUS, а затем незамедлительно инициировать синхронизацию. По умолчанию Configuration Manager подключается к службам WSUS, запущенным в точке обновления ПО, и сбрасывает все параметры, которые были изменены вне Configuration Manager. Все обновления программного обеспечения, не соответствующие указанным в параметрах синхронизации продуктам и классификациям, получают истекший срок действия, а затем удаляются из базы данных.

 Если сервер WSUS настроен как точка обновления программного обеспечения, вы больше не сможете использовать его как изолированный сервер WSUS. Если вам нужен изолированный сервер WSUS, не управляемый через Configuration Manager, его следует настроить на другом сервере.

####  <a name="BKMK_WSUSAsReplica"></a> Настройка служб WSUS в качестве сервера реплики  
 При создании роли активной точки обновления ПО на первичном сервере сайта невозможно использовать сервер WSUS, настроенный в качестве реплики. Если сервер WSUS настроен в качестве реплики, Configuration Manager не сможет настроить сервер WSUS и синхронизация WSUS будет невозможна. Если точка обновления ПО создана на вторичном сайте, Configuration Manager настраивает WSUS в качестве сервера реплики WSUS в точке обновления ПО для родительского первичного сайта. Первая установленная на первичном сайте точка обновления программного обеспечения используется по умолчанию. Дополнительные точки обновления ПО на этом сайте настраиваются в качестве реплик точки обновления ПО по умолчанию.  

####  <a name="BKMK_WSUSandSSL"></a> Принятие решения о настройке служб WSUS для подключения по протоколу SSL  
 Для защиты служб WSUS, работающих в точке обновления ПО, можно использовать протокол SSL. WSUS использует SSL для проверки подлинности клиентских компьютеров и подчиненных серверов WSUS на данном сервере WSUS. WSUS также использует SSL для шифрования метаданных обновлений ПО. Если требуется обеспечить безопасность WSUS с помощью протокола SSL, необходимо подготовить сервер WSUS перед установкой точки обновления ПО.  

 При установке и настройке точки обновления ПО необходимо выбрать параметр **Включить SSL-подключения для сервера WSUS,** . В противном случае Configuration Manager настроит для служб WSUS запрет на использование протокола SSL. Если протокол SSL включен для служб WSUS, работающих в точке обновления ПО, то службы WSUS в точках обновления ПО на всех дочерних сайтах также следует настроить для использования SSL.  

###  <a name="BKMK_ConfigureFirewalls"></a> Настройка брандмауэров  
 Обновления ПО на сайте центра администрирования Configuration Manager подключаются к службам WSUS в точке обновления ПО, а службы WSUS, в свою очередь, подключаются к источнику синхронизации для синхронизации метаданных обновлений ПО. Точки обновления ПО на дочерних сайтах обмениваются данными с точкой обновления ПО, настроенной для родительского сайта. Если на первичном сайте имеется несколько точек обновления ПО, то дополнительные точки должны обмениваться данными с первой точкой, установленной на сайте, которая также является точкой обновления ПО по умолчанию.  

 Возможно, потребуется настройка брандмауэра на прием портов HTTP или HTTPS, используемых службами WSUS, в следующих сценариях: корпоративный брандмауэр размещен между точкой обновления программного обеспечения Configuration Manager и Интернетом; имеются точка обновления ПО и восходящий источник синхронизации; имеются дополнительные точки обновления ПО. Подключение к Центру обновления Майкрософт всегда использует порт 80 для протокола HTTP и порт 443 для протокола HTTPS. Можно использовать настраиваемый порт для подключения служб WSUS, запущенных в точке обновления ПО на дочернем сайте, к службам WSUS, запущенным в точке обновления ПО на родительском сайте. Если политика безопасности запрещает такое подключение, необходимо использовать способ синхронизации с помощью экспорта и импорта. Дополнительные сведения см. в разделе [Источник синхронизации](#BKMK_SyncSource) этой статьи. Дополнительные сведения о портах, используемых службами WSUS, см. в разделе [Определение параметров портов, используемых WSUS в System Center Configuration Manager](../get-started/install-a-software-update-point.md#wsus-settings).  

#### <a name="restrict-access-to-specific-domains"></a>Ограничение доступа к определенным доменам  
 Если в вашей организации не разрешается открывать порты и протоколы для всех адресов в брандмауэре между активной точкой обновления ПО и Интернетом, можно разрешить доступ лишь к следующим доменам, чтобы службы WSUS и службы автоматического обновления ПО могли подключаться к Центру обновления Майкрософт.  

-   http://windowsupdate.microsoft.com

-   http://*.windowsupdate.microsoft.com  

-   https://*.windowsupdate.microsoft.com  

-   http://*.update.microsoft.com  

-   https://*.update.microsoft.com  

-   http://*.windowsupdate.com  

-   http://download.windowsupdate.com  

-   http://download.microsoft.com  

-   http://*.download.windowsupdate.com  

-   http://test.stats.update.microsoft.com  

-   http://ntservicepack.microsoft.com  

 Вам может потребоваться добавить следующие адреса в брандмауэр, расположенный между двумя системами сайтов, в следующих случаях: при наличии дочерних сайтов с точкой обновления ПО или при наличии удаленной активной точки обновления ПО интернет-клиентов на сайте:  

 **Точка обновления программного обеспечения на дочернем сайте**  

-   http://<*полное доменное имя точки обновления программного обеспечения на подчиненном сайте*>  

-   https://<*полное доменное имя точки обновления программного обеспечения на подчиненном сайте*>  

-   http://<*полное доменное имя точки обновления программного обеспечения на родительском сайте*>  

-   https://<*полное доменное имя точки обновления программного обеспечения на родительском сайте*>  

##  <a name="BKMK_SyncSettings"></a> Планирование параметров синхронизации  
 Синхронизация обновлений программного обеспечения в Configuration Manager — это процесс получения метаданных обновлений ПО в зависимости от настроенных условий. На самом верхнем уровне вашей иерархии находится сайт центра администрирования или автономный основной сайт, синхронизирующий обновления ПО, получаемые от службы обновления Майкрософт. Вы можете настроить точку обновления ПО на сайте верхнего уровня для синхронизации с имеющимся сервером WSUS, который не принадлежит к иерархии Configuration Manager. Дочерние первичные сайты синхронизируют метаданные обновлений ПО с точкой обновления ПО на сайте центра администрирования. Перед установкой и настройкой точки обновления ПО необходимо спланировать параметры синхронизации, используя информацию, приведенную в этом разделе.  

###  <a name="BKMK_SyncSource"></a> Источник синхронизации  
 Параметры источника синхронизации, установленные для точки обновления ПО, указывают источник получения точкой обновления метаданных об обновлениях ПО, а также определяют необходимость создания событий отчетов WSUS в ходе выполнения процедуры синхронизации.  

-   **Источник синхронизации** : эта точка обновления программного обеспечения на сайте верхнего уровня настраивает источник синхронизации для Центра обновления Майкрософт по умолчанию. Вы можете синхронизировать сайт верхнего уровня с имеющимся сервером WSUS. Точка обновления ПО на дочернем основном сайте настраивает точку обновления ПО на сайте центра администрирования в качестве источника синхронизации по умолчанию.  

    > [!NOTE]  
    >  Первая точка обновления ПО, которая установлена на первичном сайте и используется по умолчанию, синхронизируется с сайтом центра администрирования. Дополнительные точки обновления ПО на основном сайте синхронизируются с точкой обновления ПО, заданной по умолчанию на основном сайте.  

     Если точка обновления ПО отключена от Центра обновления Майкрософт или от вышестоящего сервера обновлений ПО, можно настроить источник синхронизации таким образом, чтобы не выполнять синхронизацию с настроенным источником синхронизации, а вместо этого использовать функции экспорта и импорта программы WSUSUtil для синхронизации обновлений ПО. Дополнительные сведения см. в разделе [Синхронизация обновлений программного обеспечения из отсоединенной точки обновления программного обеспечения](../get-started/synchronize-software-updates-disconnected.md).  

-   **События составления отчетов WSUS.** Агент обновления Windows на клиентских компьютерах может создавать сообщения событий, используемые для отчетов WSUS. Эти события не используются обновлением ПО в Configuration Manager, поэтому по умолчанию применяется значение **Не создавать отчеты WSUS о событиях**. Если эти события не создаются, то клиентский компьютер должен подключаться к серверу WSUS только при проверке обновлений ПО и при оценке соответствия требованиям. Если эти события нужны для отчетов, выходящих за рамки обновлений программного обеспечения в Configuration Manager, то необходимо изменить этот параметр и включить создание событий отчетов WSUS.  

###  <a name="BKMK_SyncSchedule"></a> Расписание синхронизации  
 Расписание синхронизации можно настроить только для точки обновления ПО на сайте верхнего уровня в иерархии Configuration Manager. Когда расписание синхронизации настроено, точка обновления ПО синхронизируется с источником синхронизации в указанную дату и время. Настраиваемое расписание дает возможность проводить синхронизацию обновлений ПО в дни и часы низкой нагрузки на сервер WSUS, на сервер сайта и на сеть, например в 2 часа ночи один раз в неделю. Также можно запускать синхронизацию на сайте центра администрирования с помощью действия **Синхронизировать обновления программного обеспечения** в узле **Все обновления** или **Группы обновлений программного обеспечения** в консоли Configuration Manager.  

> [!TIP]  
>  Запланируйте выполнение синхронизации обновлений ПО с периодичностью, подходящей для вашей среды. Распространен поход, при котором синхронизация обновлений ПО осуществляется вскоре после регулярного выпуска обновлений ПО для системы безопасности корпорации Майкрософт, который проводится во второй вторник каждого месяца, обычно называемый "Вторником установки исправлений". Также распространен подход, при котором синхронизация обновлений ПО выполняется ежедневно, если обновления ПО используются для получения обновлений Endpoint Protection и обновлений антивирусных модулей.  

 После того, как точка обновления ПО успешно завершит синхронизацию, запрос на синхронизацию отправляется дочерним сайтам. При наличии дополнительных точек обновления ПО на первичном сайте запрос синхронизации направляется каждой из них. Этот процесс повторяется на каждом сайте в иерархии.  

###  <a name="BKMK_UpdateClassifications"></a> Классификаций обновлений  
 Каждое обновление программного обеспечения определяется с помощью классификации обновления, позволяющей упорядочить различные типы обновлений. В процессе синхронизации происходит синхронизация метаданных обновлений ПО для указанных классов. Configuration Manager позволяет синхронизировать обновления ПО для перечисленных ниже классов.  

-   **Критические обновления.** Указывает широкодоступное обновление для решения конкретной проблемы и устранения критической ошибки, не относящейся к системе безопасности.  

-   **Обновления определений.** Указывает обновление для файлов определений вирусов или других файлов определений.  

-   **Пакеты дополнительных компонентов.** Новые компоненты продукта, распространяемые вне выпуска продукта, и компоненты, обычно включаемые в состав следующего полного выпуска продукта.  

-   **Обновления для системы безопасности.** Указывает широкодоступное обновление для решения проблемы, связанной с системой безопасности конкретного продукта.  

-   **Пакеты обновлений.** Указывает накопительный набор исправлений, применяемых к приложению. К таким исправлениям могут относиться обновления для системы безопасности, критические и обычные обновления ПО и пр.  

-   **Средства.** Служебная программа или компонент для выполнения одной или нескольких задач.  

-   **Сводные состояния обновлений.** Набор исправлений, объединенных в один пакет для более удобного развертывания. К таким исправлениям могут относиться обновления для системы безопасности, критические и обычные обновления и пр. Накопительный пакет обновления обычно предназначен для определенной области, например, безопасности, или для определенного компонента продукта.  

-   **Обновления.** Обновление для уже установленного приложения или файла.  

 Параметры классов обновлений настраиваются только на сайте верхнего уровня. Параметры классов обновлений не задаются в точке обновления ПО на дочерних сайтах, так как метаданные точек обновления ПО реплицируются с сайта верхнего уровня на основные дочерние сайты. При выборе классов следует помнить, что чем больше выбрано классов, тем дольше будет выполняться синхронизация метаданных обновлений ПО.  

> [!WARNING]  
>  Рекомендуется очистить все классы перед первой синхронизацией обновлений ПО. После первой синхронизации выберите классы на странице свойств компонента точки обновления программного обеспечения, а затем повторно запустите синхронизацию.  

###  <a name="BKMK_UpdateProducts"></a> Продукты  
 Метаданные каждого обновления ПО определяют один или несколько продуктов, к которым применимо это обновление. Продукт представляет собой определенную версию операционной системы или приложения. Пример продукта — Microsoft Windows Server 2008. Семейство продуктов представляет собой базовую операционную систему или приложение, от которых происходят отдельные продукты. Например, Microsoft Windows — это семейство продуктов, членом которого является Microsoft Windows Server 2008. Можно указать семейство продуктов или отдельные продукты в составе семейства.  

 Если обновления ПО применимы к нескольким продуктам и хотя бы один из этих продуктов выбран для синхронизации, то все эти продукты будут показаны в консоли Configuration Manager, даже если некоторые из них не были выбраны. Например, если вы подписались только на операционную систему Windows Server 2012, а обновление применимо к Windows Server 2012 и Windows Server 2012 Datacenter Edition, то оба этих продукта будут показаны в базе данных сайта.  

 Параметры продукта настраиваются только на сайте верхнего уровня. Параметры продукта не задаются в точке обновления ПО на дочерних сайтах, так как метаданные точек обновления ПО реплицируются с сайта верхнего уровня на основные дочерние сайты. При выборе продуктов следует помнить, что чем больше выбрано продуктов, тем дольше будет выполняться синхронизация метаданных обновлений ПО.  

> [!IMPORTANT]  
>  Configuration Manager сохраняет список продуктов и семейств продуктов, которые можно выбрать при первой установке точки обновления ПО. Продукты и семейства продуктов, выпущенные после выпуска Configuration Manager, могут быть недоступны для выбора до завершения синхронизации обновлений ПО. При синхронизации обновляется список доступных для выбора продуктов и семейств продуктов. Рекомендуется очистить все продукты перед первой синхронизацией обновлений ПО. После первой синхронизации выберите продукты на странице свойств компонента точки обновления программного обеспечения, а затем повторно запустите синхронизацию.  

###  <a name="BKMK_SupersedenceRules"></a>Правила замены  
 Как правило, обновление программного обеспечения, заменяющее другое обновление, выполняет одну или несколько следующих задач:  

-   Улучшает, расширяет или дополняет возможности исправления, реализованного в одном или нескольких выпущенных ранее обновлениях.  

-   Повышает эффективность пакета замещающего обновления, который устанавливается на клиентские компьютеры, если установка обновления одобрена. Например, заменяемое обновление может содержать файлы, которые больше не нужны для исправления или для операционных систем, поддерживаемых новым обновлением, поэтому такие файлы не будут включены в пакет заменяющего обновления.  

-   Обновляет более поздние версии продукта. Другими словами, выполняется обновление тех версий, которые больше не совместимы со старыми версиями или конфигурациями продукта. Обновления также могут заменять другие обновления, если были внесены изменения для расширения набора поддерживаемых языков. Например, в более поздней версии Microsoft Office или обновлении для этого продукта может быть упразднена поддержка устаревшей операционной системы, но может быть добавлена поддержка новых языков в первом выпуске обновления.  

 В свойствах точки обновления ПО можно указать, что срок действия заменяемых обновлений ПО немедленно истекает. Благодаря этому такие обновления ПО уже не включаются в новые развертывания, а для существующих развертываний отображается флаг, указывающий на наличие в них одного или нескольких обновлений ПО с истекшим сроком действия. Или же можно указать период времени, после которого истечет срок действия заменяемых обновлений ПО, что позволит по-прежнему их развертывать. Оцените следующие сценарии, в которых может потребоваться развернуть заменяемое обновление.  

-   Если заменяющее обновление поддерживает только более новые версии операционной системы, а некоторые клиентские компьютеры работают под управлением прежних версий операционной системы.  

-   Если заменяющее обновление является более узконаправленным, чем то, которое им заменяется. На некоторых клиентских компьютерах оно станет непригодным.  

-   Если заменяющее обновление не было утверждено для развертывания в вашей рабочей среде.  

    > [!NOTE]  
    > Когда Configuration Manager присваивает замененному обновлению программного обеспечения значение **Истек срок действия**, она не присваивает обновлению значение **Отклонено** в службах WSUS. Если же вы запустили задачу очистки WSUS, обновлению, для которого установлено состояние **Истек срок действия**, в программе Configuration Manager присваивается состояние **Отклонено** на сервере WSUS. Агент Центра обновления Windows на компьютерах больше не будет проверять наличие этих обновлений. Это означает, что клиенты будут продолжать искать обновление с истекшим сроком, пока выполняется задача очистки. Сведения о задании очистки WSUS см. в статье [Обслуживание обновлений программного обеспечения](/sccm/sum/deploy-use/software-updates-maintenance).

###  <a name="BKMK_UpdateLanguages"></a> Языки  
 С помощью языковых параметров точки обновления ПО можно настроить языки, на которых происходит синхронизация сводных данных (метаданных обновлений ПО) для обновлений ПО, а также языки файлов обновлений ПО, которые будут загружаться.  

#### <a name="software-update-file"></a>Файл обновления программного обеспечения  
 Языки, настроенные с помощью параметра **Файл обновления программного обеспечения** в свойствах точки обновления, образуют набор языков по умолчанию, использующийся при загрузки обновлений на сайте. Можно изменить языки, которые выбираются по умолчанию при каждой загрузке или развертывании обновлений. Если во время загрузки доступны файлы обновления для выбранных языков из числа настроенных, эти файлы загружаются в исходное местоположение пакета развертывания. Затем они копируются в библиотеку содержимого на стороне сервера, откуда они передаются уже в точки распространения, указанные в настройках пакета.  

 Языковые параметры файлов обновлений ПО следует настраивать так, чтобы выбрать языки, наиболее часто используемые в вашей среде. Например, если на клиентских компьютерах, назначенных сайту, в основном используются операционные системы и приложения на английском и русском языках, а прочие языки практически не используются на сайте, то выберите английский и русский языки в столбце **Файл обновления программного обеспечения** при загрузке или развертывании обновлений и отмените выбор прочих языков. В результате можно использовать настройки по умолчанию на странице **Выбор языка** мастеров развертывания и загрузки. Кроме того, при таком подходе лишние файлы обновлений не загружаются. Этот параметр настраивается в каждой точке обновления программного обеспечения в иерархии Configuration Manager.  

#### <a name="summary-details"></a>Сводные данные  
 При выполнении синхронизации для обновлений программного обеспечения происходит обновление сводных данных (метаданных обновлений программного обеспечения) на указанных языках. Метаданные содержат информацию об обновлении: имя, описание, поддерживаемые продукты, класс обновления, ИД статьи, URL-адрес загрузки, правила применения и т. п.  

 Параметры сводных данных настраиваются только на сайте верхнего уровня. Сводные данные не задаются на точке обновления программного обеспечения на дочерних сайтах, так как метаданные обновлений реплицируются на эти сайты с сайта центра администрирования посредством файловой репликации. При выборе языков для сводных данных следует выбирать лишь те языки, которые необходимы в данной среде. Чем больше языков будет выбрано, тем дольше будет выполняться синхронизация метаданных обновлений программного обеспечения. Configuration Manager выводит метаданные обновлений программного обеспечения на языке операционной системы компьютера, на котором работает консоль Configuration Manager. Если локализованные свойства обновлений программного обеспечения недоступны на языке операционной системы, сведения об обновлениях отображаются на английском языке.  

> [!IMPORTANT]  
>  Важно выбрать все языки сводных данных, которые понадобятся в иерархии Configuration Manager. При синхронизации точки обновления на сайте верхнего уровня с источником синхронизации на основе выбранных языков сводных данных определяется, какие метаданные обновлений нужно получить. Если изменить языки сводных данных после того, как синхронизация была выполнена хотя бы один раз, метаданные обновлений будут приниматься на новых языках только для новых или измененных обновлений. В обновления программного обеспечения, которые уже были синхронизированы, не добавляется отображение новых метаданных на других языках, если в источнике синхронизации не были внесены изменения в обновление.  

##  <a name="BKMK_MaintenanceWindow"></a> Планирование периода обслуживания обновлений программного обеспечения  
 Можно добавить период обслуживания, предназначенный для установки обновлений программного обеспечения. Позволяет настраивать общий и различные периоды обслуживания для обновлений программного обеспечения. При настройке как общего периода обслуживания, так и периода обслуживания обновлений программного обеспечения, клиенты устанавливают эти обновления только в ходе последнего. Дополнительные сведения о периодах обслуживания см. в разделе [Использование периодов обслуживания](../../core/clients/manage/collections/use-maintenance-windows.md).  

##  <a name="BKMK_RestartOptions"></a> Возможности перезагрузки для клиентов Windows 10 после установки обновления программного обеспечения
При развертывании обновления программного обеспечения, требующего перезагрузки, с помощью Configuration Manager и установке его на компьютере задается ожидание перезагрузки, и на экран выводится диалоговое окно перезагрузки.

Начиная с Configuration Manager версии 1606, пункты **Обновить и перезагрузить**и **Обновить и завершить работу** доступны для компьютеров Windows 10 в параметрах электропитания Windows, если запланировано ожидание перезагрузки для обновления программного обеспечения Configuration Manager. После применения одного из этих параметров диалоговое окно перезагрузки не выводится после перезагрузки компьютера.

В предыдущих версиях Configuration Manager, если ожидалась перезагрузка компьютеров Windows 8 и более поздних версий, а также при завершении работы или перезагрузке компьютера с помощью параметров электропитания Windows (а не из диалогового окна перезагрузки) диалоговое окно перезагрузки оставалось на экране после перезагрузки компьютера, и компьютер требовалось перезагрузить в заданный крайний срок.

## <a name="next-steps"></a>Дальнейшие действия
Спланировав обновление программного обеспечения, перейдите к разделу [Подготовка к управлению обновлениями программного обеспечения](../get-started/prepare-for-software-updates-management.md).
