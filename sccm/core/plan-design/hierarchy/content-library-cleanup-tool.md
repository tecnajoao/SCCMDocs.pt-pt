---
title: "Средство очистки библиотеки содержимого | Документация Майкрософт"
description: "Используйте средство очистки библиотеки содержимого для удаления содержимого, более не связанного с развертыванием System Center Configuration Manager."
ms.custom: na
ms.date: 4/7/2017
ms.reviewer: na
ms.suite: na
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 226cbbb2-9afa-4e2e-a472-be989c0f0e11
caps.latest.revision: "4"
author: Brenduns
ms.author: brenduns
manager: angrobe
ms.openlocfilehash: 76e6772bdd5cbd32d525e728f6ebc988b045da78
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="the-content-library-cleanup-tool-for-system-center-configuration-manager"></a>Средство очистки библиотеки содержимого для System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

 Начиная с версии 1702 вы можете использовать средство командной строки (**ContentLibraryCleanup.exe**), чтобы удалять из точки распространения содержимое, которое больше не связано с пакетами или приложениями (утерянное содержимое). Это средство называется средством очистки библиотеки содержимого. Оно заменяет старые версии аналогичных средств, выпущенных для предыдущих версий Configuration Manager.  

Это средство влияет только на содержимое в точке распространения, которую вы указываете при запуске средства. Средство не удаляет содержимое из библиотеки содержимого, расположенной на сервере сайта.

Средство **ContentLibraryCleanup.exe** можно найти в папке *%CM_Installation_Path%\cd.latest\SMSSETUP\TOOLS\ContentLibraryCleanup\* на сервере центрального административного сайта или основного сайта.

## <a name="requirements"></a>Требования  
 Средство нельзя запускать одновременно для нескольких точек распространения.  
 - Его можно запускать непосредственно на компьютере, на котором размещается точка распространения, или удаленно с другого сервера.
 - Учетная запись пользователя, используемая для запуска средства, должна иметь административные разрешения на основе ролей, эквивалентные правам полного администратора в иерархии Configuration Manager. Средство не будет работать, если требуемые разрешения предоставлены учетной записи пользователя как члену группы безопасности Windows с правами полного администратора.

## <a name="modes-of-operation"></a>Режимы работы
Средство можно запустить в одном из двух режимов. Мы рекомендуем сначала выполнять средство в режиме *что, если* и изучать полученный файл журнала, и лишь затем запускать средство в *режиме удаления*.
  1.    **Режим "что, если"**.   
      Если вы не укажете параметр **/delete**, средство выполняется в режиме "что, если" и только обнаруживает содержимое, которое следует удалить из точки распространения.
   - При работе в этом режиме средство не удаляет данные.
   - Сведения о содержимом, которое подлежит удалению, записывается в файл журнала средства. Вы не будете получать запросы на подтверждение каждого потенциального удаления.  
      </br>   

  2. **Режим удаления**.   
    Если вы запустите средство с параметром **/delete**, оно будет работать в режиме удаления.

     - В этом режиме утерянное содержимое, обнаруженное в указанной точке распространения, будет удалено из библиотеки содержимого точки распространения.
     -  Перед удалением каждого файла вам будет предложено подтвердить это удаление.  Вы можете выбрать **Y** для удаления, **N** для отмены или **Да для всех**, чтобы запросы больше не выводились и все потерянное содержимое удалялось автоматически.  
     </br>

При запуске средства в любом из режимов оно автоматически создает журнал с именем, которое содержит режим работы средства, имя точки распространения, дата и время операции. По завершении работы средства файл журнала открывается автоматически.

По умолчанию файл журнала записывается в папку temp того пользователя, от имени которого запущено средство, на том компьютере, где оно запущено. С помощью параметра **/log** вы можете перенаправить файл журнала в другое место, в том числе на общий сетевой ресурс.


## <a name="run-the-tool"></a>Запуск программы
Вот как запустить средство:
1. Откройте командную строку администратора и перейдите в папку, в которой содержится файл **ContentLibraryCleanup.exe**.  
2. Затем введите команду, содержащую обязательные параметры командной строки, а также необходимые дополнительные параметры.

**Известная проблема**. Если произошел сбой или продолжается выполнение любого пакета или развертывания, при запуске средства может появляться следующая ошибка:
-  *System.InvalidOperationException: This content library cannot be cleaned up right now because package <packageID> is not fully installed.* (Невозможно очистить эту библиотеку содержимого, так как пакет <packageID> установлен не полностью.)

**Инструкции по решению:** Нет. Средство не может надежно определять потерянные файлы, когда содержимое развертывается или развертывание завершилось сбоем. Поэтому средство не позволит очистить содержимое, пока эта проблема не будет решена.

### <a name="command-line-switches"></a>Параметры командной строки  
Приведенные ниже параметры командной строки можно использовать в любом порядке.   

|Переключение|Подробные сведения|
|---------|-------|
|**/delete**  |**Необязательный** </br> Используйте этот параметр, если необходимо удалить содержимое из точки распространения. Перед удалением содержимого выводится запрос. </br></br> Если этот параметр не указан, средство будет записывать в журнал сведения о том, какое содержимое подлежит удалению, но не будет удалять данные из точки распространения. </br></br> Пример: ***ContentLibraryCleanup.exe /dp server1.contoso.com /delete*** |
| **/q**       |**Необязательный** </br> Средство с этим параметром выполняется в "тихом" режиме, то есть подавляет все запросы (например, запросы на удаление содержимого) и не открывает файл журнала автоматически. </br></br> Пример: ***ContentLibraryCleanup.exe /q /dp server1.contoso.com*** |
| **/dp &lt;полное доменное имя точки распространения>**  | **Обязательное** </br> Укажите полное доменное имя точки распространения, которую нужно очистить. </br></br> Пример: ***ContentLibraryCleanup.exe /dp server1.contoso.com***|
| **/ps &lt;полное доменное имя первичного сайта>**       | **Необязательный** при очистке содержимого в точке распространения на первичном сайте.</br>**Обязательный** при очистке содержимого в точке распространения на вторичном сайте. </br></br>Средство подключается к родительскому первичному сайту для выполнения запросов к SMS_Provider. Эти запросы позволяют средству определить, какое содержимое должно присутствовать в точке распространения, для выявления потерянного содержимого, которое можно удалить. Это подключение к родительскому первичному сайту должно выполняться для точек распространения на вторичном сайте, так как нужные сведения не доступны непосредственно со вторичного сайта.</br></br> Укажите полное доменное имя основного сайта, к которому относится точка распространения, или родительского первичного сайта, если точка распространения находится на дополнительном сайте. </br></br> Пример: ***ContentLibraryCleanup.exe /dp server1.contoso.com /ps siteserver1.contoso.com*** |
| **/sc &lt;код первичного сайта>**  | **Необязательный** при очистке содержимого в точке распространения на первичном сайте.</br>**Обязательный** при очистке содержимого в точке распространения на вторичном сайте. </br></br> Укажите код первичного сайта, к которому относится точка распространения, или код родительского первичного сайта, если точка распространения находится на вторичном сайте.</br></br> Пример: ***ContentLibraryCleanup.exe /dp server1.contoso.com /sc ABC*** |
| **/log <log file directory>**       |**Необязательный** </br> Укажите расположение, в которое средство будет записывать файл журнала. Это может быть локальный диск или общий сетевой ресурс.</br></br> Если этот параметр не используется, файл журнала размещается в папке temp текущего пользователя на том компьютере, где выполняется средство.</br></br> Пример локального диска: ***ContentLibraryCleanup.exe /dp server1.contoso.com /log C:\Users\Administrator\Desktop*** </br></br>Пример сетевой папки: ***ContentLibraryCleanup.exe /dp server1.contoso.com /log \\&lt;ресурс>\&lt;папка>***|
