---
title: "Кластер SQL Server | Документы Майкрософт"
description: "Кластер SQL Server используется для размещения базы данных сайта System Center Configuration Manager. Статья включает сведения о поддерживаемых вариантах использования."
ms.custom: na
ms.date: 2/28/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: get-started-article
ms.assetid: d09a82c6-bbd1-49ca-8ffe-e3ce87b85d33
caps.latest.revision: "10"
caps.handback.revision: "0"
author: Brenduns
ms.author: brenduns
manager: angrobe
ms.openlocfilehash: 53f119bbb1f8827a9c23c8b747840350bbb92790
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="use-a-sql-server-cluster-for-the-system-center-configuration-manager-site-database"></a>Кластер SQL Server используется для базы данных сайта System Center Configuration Manager.

*Применимо к: System Center Configuration Manager (Current Branch)*


 Кластер SQL Server можно использовать для размещения базы данных сайта System Center Configuration Manager. База данных сайта является единственной ролью системы сайта, поддерживаемой в кластере SQL Server.  

> [!IMPORTANT]  
>  Для успешной настройки кластеров SQL Server необходимо иметь четкое представление о данной процедуре и руководствоваться документацией и процедурами, приведенными в библиотеке документации по SQL Server.  

 Кластер способен обеспечивать отработку отказа и повышать надежность базы данных сайта. Но он не дает дополнительных преимуществ с точки зрения обработки или балансировки нагрузки. В действительности производительность может даже снизиться, так как сервер сайта должен найти активный узел кластера SQL Server до подключения к базе данных.  

 Перед установкой Configuration Manager необходимо подготовить кластер SQL Server для поддержки Configuration Manager. (Необходимые условия приведены ниже в данном разделе.)  

 Во время выполнения установки Configuration Manager модуль записи службы теневого копирования Windows устанавливается на каждом узле физического компьютера кластера Microsoft Windows Server. Этот режим поддерживает задачу обслуживания **Резервное копирование сервера сайта**.  

 После установки сайта Configuration Manager каждый час проверяет наличие изменений в узле кластера. Configuration Manager автоматически управляет всеми найденными изменениями, которые затрагивают установки компонентов Configuration Manager (например, отработка отказа узла или добавление нового узла в кластер SQL Server).  

## <a name="supported-options-for-using-a-sql-server-failover-cluster"></a>Поддерживаемые варианты для использования отказоустойчивого кластера SQL Server

Следующие варианты поддерживаются для отказоустойчивых кластеров SQL Server, используемых в качестве базы данных сайта.

-   Кластер с одним экземпляром  

-   Конфигурация с несколькими экземплярами  

-   Несколько активных узлов  

-   Именованный экземпляр и экземпляр по умолчанию  

Обратите внимание на следующие необходимые условия.  

-   База данных сайта должна находиться удаленно от сервера сайта. (Кластер не может включать в себя сервер системы сайта.)  

-   Необходимо добавить учетную запись компьютера сервера сайта в группу "Локальные администраторы" на каждом сервере в кластере.  

-   Для поддержки проверки подлинности Kerberos следует включить сетевой протокол связи **TCP/IP** для сетевого подключения каждого узла кластера SQL Server. **Именованные каналы** не требуются, но могут использоваться для устранения проблем, связанных с проверкой подлинности Kerberos. Параметры сетевого протокола настраиваются в **SQL Server Configuration Manager** в разделе **Конфигурация сети SQL Server**.  

-   Если вы используете PKI, ознакомьтесь со статьей "Требования к PKI-сертификатам для Configuration Manager", где представлены требования к сертификатам при использовании кластера SQL Server для базы данных сайта.  

Необходимо учитывать следующие ограничения.  

-   **Установка и настройка**  

    -   Вторичные сайты не могут использовать кластер SQL Server.  

    -   Параметр для задания нестандартной папки для базы данных сайта недоступен, если вы указали кластер SQL Server.  

-   **Поставщик SMS**  

    -   Установка экземпляра поставщика SMS в кластере SQL Server или на компьютере, где запущен кластеризованный узел SQL Server, не поддерживается.  

-   **Параметры репликации данных**  

    -   При использовании **распределенных представлений** кластер SQL Server нельзя применять для размещения базы данных сайта.  

-   **Резервное копирование и восстановление**  

    -   Configuration Manager не поддерживает резервное копирование Data Protection Manager (DPM) для кластера SQL Server, использующего именованный экземпляр. Но он поддерживает резервное копирование DPM для кластера SQL Server, который использует экземпляр SQL Server по умолчанию.  

## <a name="prepare-a-clustered-sql-server-instance-for-the-site-database"></a>Подготовка кластеризованного экземпляра SQL Server для базы данных сайта  

Ниже приведены основные задачи, выполняемые для подготовки базы данных сайта.

-   Создайте виртуальный кластер SQL Server для размещения базы данных сайта в существующей среде кластера Windows Server. Конкретные действия по установке и настройке кластера SQL Server см. в документации по своей версии SQL Server. Например, если вы используете SQL Server 2008 R2, см. статью [Установка отказоустойчивого кластера SQL Server 2008 R2](http://go.microsoft.com/fwlink/p/?LinkId=240231).  

-   На каждом компьютере в кластере SQL Server вы можете разместить файл в корневой папке каждого диска, на котором не требуется устанавливать компоненты сайта Configuration Manager. Файл должен называться **NO_SMS_ON_DRIVE.SMS**. По умолчанию Configuration Manager устанавливает некоторые компоненты на каждом физическом узле для поддержки таких операций, как резервное копирование.  

-   Добавьте учетную запись компьютера сервера сайта в группу **Локальные администраторы** на каждом компьютере узла кластера Windows Server.  

-   В виртуальном экземпляре SQL Server назначьте роль SQL Server **sysadmin** учетной записи пользователя, от имени которой будет запускаться программа установки Configuration Manager.  

### <a name="to-install-a-new-site-using-a-clustered-sql-server"></a>Установка нового сайта с помощью кластеризованного экземпляра SQL Server  
 Чтобы установить сайт, использующий кластерную базу данных сайта, запустите программу установки Configuration Manager и следуйте стандартной процедуре установки сайта, внеся в нее следующие коррективы.  

-   На странице **Сведения о базе данных** укажите имя виртуального экземпляра кластера SQL Server, где будет размещаться база данных сайта. Виртуальный экземпляр заменяет имя компьютера, на котором выполняется SQL Server.  

    > [!IMPORTANT]  
    >  При вводе имени виртуального экземпляра кластера SQL Server не указывайте имя виртуального экземпляра Windows Server, созданное кластером Windows Server. Если используется имя виртуального сервера Windows Server, база данных сайта устанавливается на локальный жесткий диск активного узла кластера Windows Server. Это препятствует успешной отработке отказа в случае сбоя данного узла.  
