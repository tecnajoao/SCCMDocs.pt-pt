---
title: "Мониторинг репликации | Документы Майкрософт"
description: "Узнайте, как осуществлять мониторинг инфраструктуры и действий в Configuration Manager с помощью рабочей области \"Наблюдение\" в консоли."
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 3fab4d67-8d2a-45ce-8b06-471280102cf6
caps.latest.revision: "11"
caps.handback.revision: "0"
author: Brenduns
ms.author: brenduns
manager: angrobe
ms.openlocfilehash: 132803a1aa9aad5c5462686bd656688418e47d07
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="monitor-hierarchy-and-replication-infrastructure-in-system-center-configuration-manager"></a>Мониторинг иерархии и инфраструктуры репликации в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Для мониторинга инфраструктуры и действий в System Center Configuration Manager используется рабочая область **Наблюдение** в консоли Configuration Manager.  

> [!NOTE]  
>  Исключением является миграция, которая отслеживается непосредственно в узле **Миграция** в рабочей области **Администрирование** . Дополнительные сведения см. в разделе [Операции для миграции в System Center Configuration Manager](../../../core/migration/operations-for-migration.md).  

 Помимо консоли Configuration Manager, для мониторинга можно использовать отчеты Configuration Manager или просматривать файлы журналов Configuration Manager для компонентов Configuration Manager. Сведения об отчетах см. в разделе [Ведение отчетов в System Center Configuration Manager](../../../core/servers/manage/reporting.md). Сведения о файлах журналов см. в разделе [Файлы журналов в System Center Configuration Manager](../../../core/plan-design/hierarchy/log-files.md).  

 Осуществляя мониторинг сайтов, необходимо обращать внимание на знаки, которые указывают на проблемы, требующие принятия мер. Пример.  

-   Очередь файлов на серверах сайта и системах сайта.  

-   Сообщения о состоянии, которые означают ошибку или проблему.  

-   Сбой внутрисайтового взаимодействия.  

-   Сообщения об ошибках и предупреждения в системном журнале событий на серверах.  

-   Сообщения об ошибках и предупреждения в журнале ошибок Microsoft SQL Server.  

-   Сайты или клиенты, не отвечающие продолжительное время.  

-   Медленный отклик базы данных SQL Server.  

-   Признаки сбоя оборудования.  

Чтобы сократить риск сбоя сайта, при выводе задачами мониторинга признаков проблем следует изучить причину проблемы и как можно быстрее устранить ее.  



##  <a name="BKMK_MonintorMgmtTasks"></a> Мониторинг типовых задач управления для Configuration Manager  
 Configuration Manager предоставляет встроенные функции мониторинга в консоли Configuration Manager. Можно выполнять мониторинг множества задач, включая задачи, связанные с обновлением программного обеспечения, управлением питанием и развертыванием содержимого в иерархии.  

 Приведенные ниже сведения помогут осуществлять мониторинг общих задач Configuration Manager.  

 **Предупреждения**  
   См. подраздел [Мониторинг оповещений](../../../core/servers/manage/use-alerts-and-the-status-system.md#BKMK_MonitorAlerts) раздела [Использование оповещений и системы состояния для System Center Configuration Manager](../../../core/servers/manage/use-alerts-and-the-status-system.md).  

 **Параметры соответствия требованиям**  
   См. раздел [Мониторинг параметров соответствия требованиям в System Center Configuration Manager](../../../compliance/deploy-use/monitor-compliance-settings.md).  

 **Развертывание содержимого**  
   Общие сведения о содержимом мониторинга см. в разделе [Управление содержимым и инфраструктурой содержимого для System Center Configuration Manager](../../../core/servers/deploy/configure/manage-content-and-content-infrastructure.md).  

Сведения о мониторинге определенных типов развертывания содержимого.
-   Сведения о мониторинге приложений см. в разделе [Мониторинг приложений с помощью System Center Configuration Manager](/sccm/apps/deploy-use/monitor-applications-from-the-console).  

-   Сведения о мониторинге пакетов и программ см. в подразделе "Управление пакетами и программами" раздела [Пакеты и программы в System Center Configuration Manager](../../../apps/deploy-use/packages-and-programs.md).  

**Endpoint Protection**  
   См. статью [Мониторинг Endpoint Protection в System Center Configuration Manager](../../../protect/deploy-use/monitor-endpoint-protection.md).  

**Мониторинг управления питанием**  
 См. статью [Отслеживание и планирование управления питанием в System Center Configuration Manager](../../../core/clients/manage/power/monitor-and-plan-for-power-management.md).  

**Мониторинг отслеживания использования программного обеспечения**  
См. статью [Отслеживание применения приложений с помощью функции контроля использования программных продуктов в System Center Configuration Manager](../../../apps/deploy-use/monitor-app-usage-with-software-metering.md).  

**Мониторинг обновлений программного обеспечения**  
 См. статью [Мониторинг обновлений программного обеспечения в System Center Configuration Manager](../../../sum/deploy-use/monitor-software-updates.md).  


##  <a name="BKMK_MonitorInfrastructure"></a> Мониторинг инфраструктуры иерархии для Configuration Manager  
Configuration Manager предоставляет несколько методов отслеживания состояния и операций иерархии. Можно проверять состояние системы сайтов во всей иерархии, наблюдать за межсайтовой репликацией из иерархии сайта или географического представления, отслеживать связи репликации между сайтами для репликации базы данных и использовать средство "Анализатор канала репликации" для устранения проблем репликации.  

###  <a name="BKMK_SH_Node"></a> Сведения об узле "Иерархия сайтов"  
В узле **Иерархия сайтов** рабочей области **Наблюдение** можно просмотреть общие сведения об иерархии Configuration Manager и межсайтовых связях. Доступны два представления:  

-   **Схема иерархии**. В этом представлении иерархия отображается в виде упрощенной карты топологии, содержащей только важные данные.  

-   **Географическое представление**. В этом представлении сайты отображаются на географической карте, где показаны настроенные расположения сайтов.  

С помощью узла **Иерархия сайта** можно отслеживать состояние каждого сайта и межсайтовых связей репликации, а также их связь с внешними факторами, например с географическим положением.  

Так как состояние сайта и межсайтовой связи реплицируется как данные сайта, а не как глобальные данные, при подключении консоли Configuration Manager к дочернему первичному сайту увидеть состояние сайта или связи других первичных сайтов или их дочерних вторичных сайтов нельзя. Например, при подключении консоли Configuration Manager к основному сайту в иерархии нескольких первичных сайтов можно просмотреть состояние дочерних вторичных сайтов, первичного сайта и сайта центра администрирования, однако состояние других узлов иерархии под сайтом центра администрирования не отображается.  

 Для управления изменениями отображения иерархии сайта воспользуйтесь командой **Настроить параметры** . Настройки узла **Иерархия сайтов**, выполненные во время подключения консоли Configuration Manager к одному сайту, реплицируются на все остальные сайты.  

#### <a name="hierarchy-diagram"></a>Схема иерархии  
 Схема иерархии отображает сайты на карте топологии. В этом представлении можно выбрать сайт и просмотреть сводное сообщение о состоянии, детально рассмотреть сообщения о состоянии и открыть диалоговое окно **Свойства** сайтов.  

 Чтобы просмотреть состояние высокого уровня сайта или связи репликации между сайтами, наведите на эти объекты указатель мыши. Так как состояние связи репликации не реплицируется глобально, для получения сведений о связи репликации между всеми сайтами консоль Configuration Manager в иерархии с несколькими первичными сайтами необходимо подключить к сайту центра администрирования.  

 Для изменения схемы иерархии используются следующие параметры.  

-   **Группы**. Можно настроить несколько первичных и вторичных сайтов, которые запускают изменение отображения схемы иерархии, объединяющее сайты в один объект. После объединения сайтов в один объект можно увидеть общее число сайтов и подробную сводку сообщений о состоянии сайтов. Конфигурации групп не влияют на географическое представление.  

-   **Избранные сайты**. Отдельные сайты можно задать в качестве избранных. В схеме иерархии избранный сайт помечается значком в виде звездочки. При использовании групп избранные сайты не объединяются с другими сайтами, а всегда отображаются отдельно.  

#### <a name="geographical-view"></a>Географическое представление  
 В географическом представлении расположение каждого сайта отображается на географической карте. Отображаются только те сайты для которых настроено расположение. При выборе сайта в представлении выводятся связи репликации с родительскими или дочерними сайтами. В отличие от представления "Схема иерархии" здесь нельзя отобразить сообщение о состоянии сайта или сведения о связи репликации.  

> [!NOTE]  
>  Для использования географического представления на компьютере, к которому подключается консоль Configuration Manager, должен быть установлен Internet Explorer и предоставлен доступ к Картам Bing по протоколу HTTP.  

Для изменения географического представления используется следующий параметр.  

-   **Расположение сайта**. Можно указать географическое расположение для каждого сайта. Можно указать расположение в виде улицы и номера дома, названия города или в виде географических координат: широты и долготы. Например, чтобы использовать широту и долготу города Редмонд, штат Вашингтон, США, следует указать **N 47 40 26.3572 W 122 7 17.4432** в качестве места расположения. Нет необходимости указывать символы градусов, минут и секунд для значений широты и долготы. Configuration Manager использует Карты Bing для отображения расположения в географическом представлении. В этом случае иерархию можно просматривать с учетом географического расположения и получать данные о региональных проблемах, которые могут затронуть конкретные сайты или межсайтовую репликацию.  

     Если указано расположение сайта, с помощью поля **Расположение** выполните поиск конкретного сайта в иерархии. Выбрав сайт, введите расположение в виде названия города или адреса в поле **Расположение** . Для разрешения расположения Configuration Manager использует Карты Bing.  

###  <a name="BKMK_MonitorRepLinksAndStatuss"></a> Мониторинг состояния репликации и каналов репликации базы данных  
 В дополнение к общим сведениям, доступным в узле **Иерархия сайтов** в рабочей области **Мониторинг** , вы можете отслеживать данные репликации базы данных при использовании узла **Репликация базы данных** в рабочей области **Мониторинг** . В узле **Репликация базы данных** можно отслеживать состояние каналов репликации между сайтами, а также данные инициализации и репликации для репликации групп на сайте, к которому подключена консоль Configuration Manager.  

> [!TIP]  
>  Узел **Репликация базы данных** также отображается в узле **Конфигурация иерархии** в рабочей области **Администрирование** , там невозможно просмотреть состояние репликации для репликации связей баз данных.  

####  <a name="BKMK_MonitorReplicationLinks"></a> Состояние канала репликации  
Репликация базы данных между сайтами подразумевает репликацию несколько наборов информации, называемых группами репликации. Репликация каждой группы выполняется с различным приоритетом. По умолчанию, данные, содержащиеся в группе репликации, и частоту репликации нельзя изменить.  

 Если связь репликации активна и не находится в состоянии отказа или сниженной активности, репликация всех групп выполняется своевременно. Если одной или нескольким группам репликации не удается реплицировать данные в течение ожидаемого периода времени, для связи устанавливается состояние сниженной активности. Связи со сниженной активностью по-прежнему могут использоваться, но следует наблюдать за их работой, чтобы убедиться в их возврате в активное состояние. Также следует выяснить причину неполадок, чтобы избежать дальнейшего снижения активности и других сбоев репликации.  

 Для каждого канала репликации вы можете указать количество повторных попыток репликации группы, после которого канал перейдет в состояние отказа или сниженной активности. Даже при успешной репликации всех групп, кроме одной, связь перейдет в состояние отказа или сниженной активности, если репликация хотя бы одной группы не будет выполнена за указанное количество попыток. Дополнительные сведения о пороговых значениях репликации см. в подразделе [Пороговые значения репликации базы данных](../../../core/servers/manage/data-transfers-between-sites.md#BKMK_DBRepThresholds) раздела [Передача данных между сайтами в System Center Configuration Manager](../../../core/servers/manage/data-transfers-between-sites.md).  

 Используйте сведения, приведенные в следующей таблице, для понимания состояния связей репликации и для выявления случаев, в которых может потребоваться дополнительный анализ.  

|Описание связи|Дополнительные сведения|  
|----------------------|----------------------|  
|**Связь активна**|Проблемы не обнаружены, взаимодействие продолжается.|  
|**Активность связи снижена**|Репликация работает, но наблюдается задержка по крайней мере одного объекта или группы. Следует наблюдать за связями, находящимися в таком состоянии, и проверять данные с обеих сторон связи, чтобы выявить признаки отказа.<br /><br /> Связь может перейти в состояние сниженной активности, если сайт, получающий реплицированные, не может быстро внести эти данные в базу данных. Это возможно при репликации больших объемов данных. Например, при развертывании обновлений программного обеспечения на большом количестве компьютеров обработка всего объема реплицируемых данных на родительском сайте связи может занять немало времени. Задержка обработки на родительском сайте может привести к установке для связи состояния снижения активности до тех пор, пока родительский сайт не обработает все данные.|  
|**Отказ связи**|Репликация не осуществляется. Возможно, связь репликации будет восстановлена без каких-либо дальнейших действий. Для изучения причины отказа и восстановления репликации в этой связи может быть полезен анализатор канала репликации.<br /><br /> Это состояние может также указывать на неполадки в физической сети между родительским и дочерним сайтами.|  

 Если родительский сайт находится в процессе обновления до нового пакета обновления, то при просмотре состояния связи с дочернего сайта будет отображаться активное состояние. После обновления, пока дочерний сайт не получит такой же пакет обновления, что и родительский сайт, будет отображаться активное состояние связи при просмотре с родительского сайта и состояние настройки при просмотре с дочернего сайта.  

####  <a name="BKMK_MonitorReplicationStatus"></a> Состояние репликации  
 Можно использовать узел **Репликация базы данных** в рабочей области **Мониторинг** , чтобы просмотреть состояние связи репликации и сведения о базе данных сайта на каждой стороне этой связи. Кроме того, вы можете просматривать сведения о группах репликации. Для просмотра сведений выберите связь репликации, а затем выберите соответствующую вкладку, чтобы просмотреть нужное состояние репликации. Ниже приведена подробная информация о различных вкладках состояния репликации.  

 **Сводка**  
 Просмотр общих сведений о репликации данных сайта и глобальных данных между обоими сайтами, соединенными связью.  

 Также можно щелкнуть **Просмотр отчетов данных журнала трафика** , чтобы просмотреть отчет с подробными сведениями о нагрузке на сеть, используемой репликацией по этой связи.  

 **Родительский сайт**  
 Для родительского узла связи репликации можно просмотреть сведения о базе данных:  

-   Порты брандмауэра для SQL Server  

-   Свободное пространство на диске  

-   Расположение файлов базы данных  

-   Сертификаты  

**Дочерний сайт**  
 Для дочернего сайта связи репликации, просмотреть сведения о базе данных, в том числе:  

-   Порты брандмауэра для SQL Server  

-   Свободное пространство на диске  

-   Расположение файлов базы данных  

-   Сертификаты  

**Подробности инициализации**    
 Просмотр состояния инициализации для групп репликации, реплицирующихся через эту связь. Эти сведения помогут определить, когда инициализация репликация выполняется, а в каких случаях произошел сбой.  

 Кроме того, можно использовать эту информацию, чтобы определить, когда сайт может находиться в режиме совместимости. Режим взаимодействия возникает, когда версии Configuration Manager на дочернем и на родительском сайтах различаются.  

**Сведения о репликации**    
 Просмотр состояния репликации для каждой группы репликации данной связи. Полученные сведения можно использовать для выявления проблем или задержек репликации определенных данных. Также можно определить соответствующие пороги репликации базы данных для этой связи. Сведения о пороговых значениях репликации базы данных см. в подразделе [Пороговые значения репликации базы данных](../../../core/servers/manage/data-transfers-between-sites.md#BKMK_DBRepThresholds) раздела [Передача данных между сайтами в System Center Configuration Manager](../../../core/servers/manage/data-transfers-between-sites.md).  

> [!TIP]  
>  Группы репликации данных для сайта отправляются только от дочернего к родительскому узлу. Группы репликации для глобальных данных реплицируются в обоих направлениях.  

###  <a name="BKMK_RLA"></a> Сведения об анализаторе канала репликации  
 В Configuration Manager входит средство **Replication Link Analyzer**, позволяющее анализировать и устранять неполадки репликации. Можно использовать Replication Link Analyzer для устранения сбоев связей репликации и в случаях, когда репликация прекратила работать, но еще не перешла в состояние сбоя. Это средство также используется для устранения проблем с репликацией между следующими компьютерами в иерархии Configuration Manager (направление сбоя репликации не имеет значения):  

-   между сервером сайта и сервером базы данных сайта;  

-   между сайтами сервера базы данных сайта и другими сайтами компьютера базы данных сайта (межсайтовая репликация).  

Запустить Replication Link Analyzer можно из консоли Configuration Manager или из командной строки.  

-   Для запуска из консоли Configuration Manager выполните следующие действия. В рабочей области **Наблюдение** щелкните узел **Репликация базы данных**, выберите канал репликации для анализа, а затем на вкладке **Главная** в группе **Репликация базы данных** выберите **Replication Link Analyzer**.  

-   Для запуска из командной строки введите следующую команду: **%path%\Microsoft Configuration Manager\AdminConsole\bin\Microsoft.ConfigurationManager.ReplicationLinkAnalyzer.Wizard.exe &lt;полное доменное имя сервера исходного сайта\> &lt;полное доменное имя сервера конечного сайта\>**  

Запущенное средство Replication Link Analyzer выявляет неполадки с помощью ряда правил и проверок диагностики. При запуске этого средства можно просмотреть обнаруженные неполадки. Если известны инструкции по устранению неполадки, они будут показаны. Если неполадку можно устранить автоматически, выводится соответствующее сообщение. Завершив работу, средство Replication Link Analyzer результаты в следующий отчет в формате XML и в файл журнала на рабочем столе пользователя, запустившего это средство:  

-   ReplicationAnalysis.xml  

-   ReplicationLinkAnalysis.log  

Когда средство Replication Link Analyzer запускается, оно останавливает следующие службы на время устранения неполадок и вновь запускает эти службы после устранения неполадок:  

-   SMS_SITE_COMPONENT_MANAGER  

-   SMS_EXECUTIVE  

Если средство Replication Link Analyzer не может исправить неполадку, проверьте сервер сайта и перезапустите эти службы, если они были остановлены.  

Успешные и неудачные действия по исследованию и исправлению регистрируются в журнале для предоставления дополнительных сведений, отсутствующих в интерфейсе средства.  

**Необходимые условия для использования анализатора канала репликации**  

-   Учетная запись, используемая для запуска Replication Link Analyzer, должна иметь права локального администратора на каждом компьютере, имеющем отношение к связи репликации. Для этой учетной записи не требуется конкретная роль безопасности администрирования на основе ролей. Поэтому пользователь с доступом к узлу **Репликация базы данных** может запустить анализатор из консоли Configuration Manager, а системный администратор с достаточным набором прав доступа к каждому компьютеру — из командной строки.  

-   Учетная запись, используемая для запуска Replication Link Analyzer, должна иметь права системного администратора в каждой базе данных SQL Server, имеющей отношение к связи репликации.  

**Известные проблемы с Replication Link Analyzer**  

-   С выпуском System Center Configuration Manager версии 1511 Replication Link Analyzer выдает ошибки сертификата SQL Server Service Broker для первичных сайтов, обновленных из System Center 2012 Configuration Manager. Это вызвано изменениями имен сертификатов, внесенными в версии 1511, для которой обновление Replication Link Analyzer еще не было выполнено. Эти ошибки можно игнорировать без каких либо последствий.  

###  <a name="BKMK_ProcsforMonitoringReplication"></a> Процедуры отслеживания репликации базы данных  

##### <a name="to-monitor-high-level-site-to-site-database-replication-status"></a>Мониторинг высокоуровневого состояния репликации базы данных    
1.  В консоли Configuration Manager щелкните элемент **Мониторинг**.  

2.  В рабочей области **Мониторинг** щелкните узел **Иерархия сайта** , чтобы открыть представление **Схема иерархии** .  

3.  Чтобы просмотреть состояние репликации глобальных данных и данных сайта для этих сайтов, ненадолго задержите указатель мыши на линии между двумя сайтами.  

##### <a name="to-monitor-the-replication-status-for-a-replication-link"></a>Для отслеживания состояния репликации для связи репликации    
1.  В консоли Configuration Manager щелкните элемент **Мониторинг**.  

2.  В рабочей области **Мониторинг** щелкните **Репликация базы данных**, затем выберите связь репликации, которую нужно отслеживать. Затем в рабочей области перейдите на нужную вкладку для просмотра различных сведений о состоянии репликации по этой связи.  
