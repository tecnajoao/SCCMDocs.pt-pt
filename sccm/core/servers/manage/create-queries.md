---
title: "Создание запросов | Документы Майкрософт"
description: "Узнайте, как создавать и импортировать запросы в System Center Configuration Manager. Приводятся примеры запросов и советы."
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 868049d3-3209-47ec-b34a-9cc26941893a
caps.latest.revision: "5"
caps.handback.revision: "0"
author: robstackmsft
ms.author: robstack
manager: angrobe
ms.openlocfilehash: 9f38d86ff6227bb6ea88c358a3d61242372d449e
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="how-to-create-queries-in-system-center-configuration-manager"></a>Создание запросов в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Из этой статьи вы узнаете, как создавать или импортировать запросы в System Center Configuration Manager.  

##  <a name="BKMK_Create"></a> Создание запросов  
 Используйте эту процедуру для создания запросов в Configuration Manager.  

#### <a name="to-create-a-query"></a>Процедура создания запроса  

1.  В консоли Configuration Manager щелкните элемент **Мониторинг**.  

2.  В рабочей области **Мониторинг** выберите элемент **Запросы**. На вкладке **Главная** в группе **Создать** щелкните **Создать запрос**.  

3.  На вкладке **Общие** окна **Мастер создания запросов**укажите уникальное имя и необязательный комментарий для запроса.  

4.  Чтобы импортировать существующий отчет и использовать его в качестве основы для нового запроса, выберите **Импортировать инструкцию запроса**. В диалоговом окне **Обзор запроса** выберите существующий запрос, который требуется импортировать, и нажмите **ОК**.  

5.  В списке **Тип объекта** выберите тип объекта, для которого требуется выполнить запрос. В следующей таблице описаны некоторые примеры типов объектов, по которым вы можете выполнять поиск.  

    |Тип объекта|Описание|  
    |-----------------|-----------------|  
    |**Системный ресурс**|Используйте для поиска типичных системных атрибутов, таких как NetBIOS-имя устройства, версия клиента, IP-адрес клиента и сведения доменных служб Active Directory.|  
    |**Ресурс пользователя**|Используйте для поиска стандартной информации о пользователе, например имени пользователя, имени группы пользователя и имени группы безопасности.|  
    |**Развертывание**|Используйте для поиска стандартных атрибутов развертывания, таких как имя развертывания, а также расписание и коллекция, в которую выполнено развертывание.|  

6.  Выберите **Изменить инструкцию запроса**, чтобы открыть диалоговое окно **Свойства инструкции** *&lt;имя запроса\>*.  

7.  На вкладке **Общие** диалогового окна **Свойства инструкции** *&lt;имя запроса\>* укажите атрибуты, возвращаемые этим запросом, и способ их отображения. Щелкните значок **Создать**, чтобы добавить новый атрибут. Кроме того, вы можете щелкнуть пункт **Показать язык запроса**, чтобы ввести или изменить запрос непосредственно на языке запросов WMI. Примеры запросов WMI см. в разделе [Example WQL queries](#BKMK_Example) этой статьи.  

    > [!TIP]  
    > Для создания собственных WQL-запросов вы можете использовать следующую справочную документацию MSDN:  
    >   
    > -   [WQL (SQL для WMI)](http://go.microsoft.com/fwlink/p/?LinkId=256653)  
    > -   [Предложения WHERE](http://go.microsoft.com/fwlink/p/?LinkId=256654)  
    > -   [Операторы WQL](http://go.microsoft.com/fwlink/p/?LinkId=256655)  

8.  На вкладке **Критерии** диалогового окна **Свойства инструкции** *&lt;имя запроса\>* укажите критерии для уточнения результатов запроса. Например, вы можете вернуть только ресурсы с кодом сайта **XYZ** в результатах запроса. Можно настроить несколько условий для запроса.  

    > [!IMPORTANT]  
    > Если вы создаете запрос, который не содержит условий, он возвратит все устройства в коллекции **Все системы** .  

9. На вкладке **Объединения** диалогового окна **Свойства инструкции** *&lt;имя запроса\>* вы можете объединить данные двух разных атрибутов в результатах запроса. Несмотря на то, что Configuration Manager автоматически создает объединения при выборе различных атрибутов для результата запроса, вкладка **Объединения** предоставляет расширенные параметры. Классы атрибутов, поддерживаемые System Center 2012 Configuration Manager, показаны в следующей таблице.  

    |Тип объединения|Описание|  
    |---------------|-----------------|  
    |Внутренний|Отображение только подходящих результатов. Этот вариант всегда используется в соединениях, создаваемых автоматически.|  
    |Левый|Отображение всех результатов для базового атрибута и только подходящих результатов для атрибута объединения.|  
    |Правый|Отображение всех результатов для атрибута объединения и только подходящих результатов для базового атрибута.|  
    |Полная архивация|Отображение всех результатов для базового атрибута и атрибута объединения.|  

     Дополнительные сведения о том, как использовать операции соединения, см. в документации к серверу SQL Server.  

10. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Свойства инструкции** *&lt;имя запроса\>*.  

11. На вкладке **Общие** окна **Мастер создания запросов** укажите, будут ли ограничены результаты этого запроса членами коллекции или указанной коллекции либо будет ли предлагаться указать коллекцию при каждом выполнении запроса.  

12. Следуйте указаниям мастера для создания запроса. Новый запрос отображается в узле **Запросы** рабочей области **Мониторинг** .  

##  <a name="BKMK_Import"></a> Импорт запросов  
 Используйте эту процедуру для импорта запроса в Configuration Manager. Сведения о том, как экспортировать запросы, см. в разделе [Управление запросами в System Center Configuration Manager](../../../core/servers/manage/manage-queries.md).  

#### <a name="to-import-a-query"></a>Процедура импорта запроса  

1.  В консоли Configuration Manager щелкните элемент **Мониторинг**.  

2.  В рабочей области **Мониторинг** выберите элемент **Запросы**. На вкладке **Главная** в группе **Создать** щелкните **Импорт объектов**.  

3.  На странице **Имя MOF-файла** **мастера импорта объектов** нажмите кнопку **Обзор** и выберите MOF-файл, содержащий запрос, который требуется импортировать.  

4.  Просмотрите сведения об импортируемом запросе, после чего завершите работу мастера. Новый запрос отобразится в узле **Запросы** рабочей области **Мониторинг**.  

##  <a name="BKMK_Example"></a> Example WQL queries

Этот раздел содержит примеры запросов WMI, которые вы можете использовать в иерархии или изменять для применения в других целях. Чтобы использовать эти запросы, в диалоговом окне **Свойства формы запроса** щелкните **Показать язык запроса**. Затем скопируйте и вставьте запрос в поле **Инструкция запроса**.  

> [!TIP]  
> Используйте подстановочный знак `%` для обозначения любой строки символов. Например, `%Visio%` возвращает Microsoft Office Visio 2010.  

### <a name="computers-that-run-windows-7"></a>Компьютеры под управлением Windows 7

Используйте следующий запрос для возврата NetBIOS-имени и версии операционной системы всех компьютеров под управлением Windows 7.  

> [!TIP]  
> Для возврата компьютеров под управлением Windows Server 2008 R2, измените `%Workstation 6.1%` на `%Server 6.1%`.  

```  
select SMS_R_System.NetbiosName,  
SMS_R_System.OperatingSystemNameandVersion from    
SMS_R_System where   
SMS_R_System.OperatingSystemNameandVersion like "%Workstation 6.1%"  
```  

### <a name="computers-with-a-specific-software-package-installed"></a>Компьютеры с установленным указанным пакетом программного обеспечения  

Используйте следующий запрос для возврата NetBIOS-имени и имени пакета программного обеспечения всех компьютеров, на которых установлен указанный пакет программного обеспечения. В этом примере отображаются все компьютеры с установленной версией Microsoft Visio. Замените `%Visio%` пакетом программного обеспечения, для которого требуется запросить данные.  

> [!TIP]  
> Этот запрос выполняет поиск пакета программного обеспечения с помощью имен, отображаемых в списке программ на панели управления Windows.  

```  
select SMS_R_System.NetbiosName,   
SMS_G_System_ADD_REMOVE_PROGRAMS.DisplayName from    
SMS_R_System inner join SMS_G_System_ADD_REMOVE_PROGRAMS on   
SMS_G_System_ADD_REMOVE_PROGRAMS.ResourceId =   
SMS_R_System.ResourceId where   
SMS_G_System_ADD_REMOVE_PROGRAMS.DisplayName like "%Visio%"  
```  

### <a name="computers-that-are-in-a-specific-active-directory-domain-services-organizational-unit"></a>Компьютеры в указанном подразделении доменных служб Active Directory

Используйте запрос ниже для возврата NetBIOS-имени и имени подразделения всех компьютеров в указанном подразделении. Замените текст `OU Name` именем подразделения, для которого требуется запросить данные.  

```  
select SMS_R_System.NetbiosName,   
SMS_R_System.SystemOUName from    
SMS_R_System where   
SMS_R_System.SystemOUName = "OU Name"  
```  

### <a name="computers-with-a-specific-netbios-name"></a>Компьютеры с определенным NetBIOS-именем

Используйте следующий запрос для возврата NetBIOS-имени всех компьютеров, начинающихся с определенной строки символов. В этом примере запрос возвращает все компьютеры с NetBIOS-именем, которое начинается с `ABC`.  

```  
select SMS_R_System.NetbiosName from    
SMS_R_System where SMS_R_System.NetbiosName like "ABC%"  
```  

###  <a name="BKMK_DeviceType"></a> Устройства определенного типа

Типы устройств сохраняются в базе данных Configuration Manager по классу ресурсов **sms_r_system** и имени атрибута **AgentEdition**. Используйте следующий запрос, чтобы получить только те устройства, которые соответствуют выпуску агента указанного типа устройства:  

```  
Select SMS_R_System.ClientEdition from SMS_R_System where SMS_R_System.ClientEdition = <Device ID>  
```  

Используйте одно из указанных ниже значений для *&lt;Device ID\>*.  

|Тип устройства|Значение AgentEdition|  
|-----------------|---------------------------|  
|Настольный компьютер или ноутбук под управлением Windows|0|  
|Устройство на базе Windows ARM (под управлением Windows RT)|1|  
|Windows Mobile 6.5|2|  
|Nokia Symbian|3|  
|Windows Phone|4|  
|Компьютеры Mac|5|  
|Windows CE|6|  
|Windows Embedded|7|  
|iOS|8|  
|iPad|9|  
|iPod Touch|10|  
|Android|11|  
|Система на кристалле Intel|12|  
|Серверы Unix и Linux|13|  

 Например, если запрос должен возвращать только компьютеры Mac, используйте следующий запрос:  

```  
Select SMS_R_System.ClientEdition from SMS_R_System where SMS_R_System.ClientEdition = 5  
```  

## <a name="see-also"></a>См. также  
 [Использование и обслуживание запросов в System Center Configuration Manager](../../../core/servers/manage/operations-and-maintenance-for-queries.md)
