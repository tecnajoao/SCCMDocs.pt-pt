---
title: "Обслуживание клиентов Mac | Документы Майкрософт"
description: "Задачи обслуживания для клиентов Mac System Center Configuration Manager."
ms.custom: na
ms.date: 04/23/2017
ms.prod: configuration-manager
ms.reviewer: aaroncz
ms.suite: na
ms.technology: configmgr-client
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: cf6337a2-700c-47f3-b6f8-5814f9b81e59
caps.latest.revision: "12"
author: robstackmsft
ms.author: robstack
manager: angrobe
ms.openlocfilehash: 3bf6651f58dc0c2aa4773f77115c3fbcd4a33221
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="maintain-mac-clients"></a>Обслуживание клиентов Mac
*Применимо к: System Center Configuration Manager (Current Branch)*

Ниже приведены процедуры удаления клиентов Mac и обновления их сертификатов.

##  <a name="uninstalling-the-mac-client"></a>Удаление клиента Mac  

1.  На компьютере Mac откройте окно терминала и перейдите к папке, содержащей файл **macclient.dmg**.  

2.  Перейдите в папку Tools и введите следующую команду:  

     **./CMUninstall -c**  

    > [!NOTE]  
    >  Параметр **-c** означает, что при удалении клиента также нужно удалить журналы сбоев клиента и файлы журналов. Рекомендуем указать этот параметр, чтобы избежать ошибок в случае повторной установки клиента впоследствии.  

3.  При необходимости удалите вручную сертификат проверки подлинности клиента, который использовался Configuration Manager, или отзовите его. CMUnistall не удаляет и не отзывает данный сертификат.  

##  <a name="renewing-the-mac-client-certificate"></a>Продление сертификата клиента для Mac  
 Используйте один из следующих методов продления сертификата клиента для Mac.  

-   [Мастер продления сертификатов](#renew-certificate-wizard)  

-   [Продление сертификата вручную](#renew-certificate-manually)  

###  <a name="renew-certificate-wizard"></a>Мастер продления сертификатов  

1.  Укажите следующие *строковые* значения для параметров в файле ccmclient.plist, который определяет, когда будет открыт мастер продления сертификатов.  

 -   **RenewalPeriod1**. Указывает (в секундах) первый период продления, когда пользователи могут продлить сертификат. Значение по умолчанию: 3 888 000 с (45 дней). Если заданное значение меньше 300 секунд, будет использоваться значение по умолчанию. 

 -   **RenewalPeriod2**. Указывает (в секундах) второй период продления, когда пользователи могут продлить сертификат. Значение по умолчанию : 259 200 с (3 дня). Если значение не меньше 300 секунд и не больше **RenewalPeriod1**, будет использовано указанное значение. Если **RenewalPeriod1** больше 3 дней, для **RenewalPeriod2**будет использоваться значение 3 дня.  Если **RenewalPeriod1** меньше 3 дней, **RenewalPeriod2** присваивается значение **RenewalPeriod1**.  

 -   **RenewalReminderInterval1**. Указывает (в секундах) частоту, с которой мастер продления сертификатов будет отображаться пользователям во время первого периода продления. Значение по умолчанию : 86 400 с (1 день). Если значение **RenewalReminderInterval1** больше 300 с и меньше **RenewalPeriod1**, используется заданное значение. В противном случае используется значение по умолчанию в 1 день.  

 -   **RenewalReminderInterval2**. Указывает (в секундах) частоту, с которой мастер продления сертификатов будет отображаться пользователям во время второго периода продления. Значение по умолчанию : 28 800 с (8 часов). Если значение **RenewalReminderInterval2** больше 300 секунд, меньше или равно **RenewalReminderInterval1** и меньше или равно **RenewalPeriod2**, используется заданное значение. В противном случае используется значение в 8 часов.  

     **Пример.** Если оставить значения по умолчанию, за 45 дней до истечения срока действия сертификата мастер будет открываться каждые 24 часа.  В течение трех дней до истечения срока действия сертификата мастер будет открываться каждые 8 часов.  

     **Пример.** Используйте следующую командную строку или сценарий, чтобы установить первый период продления равным 20 дням.  

     `sudo defaults write com.microsoft.ccmclient RenewalPeriod1 1728000`  

2.  При открытии мастера продления сертификатов поля **Имя пользователя** и **Имя сервера** обычно уже заполнены, и для продления сертификата пользователю необходимо только указать пароль.  

    > [!NOTE]  
    >  Если мастер не откроется или если вы его случайно закроете, нажмите кнопку **Обновить** на странице настроек **Configuration Manager** , чтобы открыть мастер.  

###  <a name="renew-certificate-manually"></a>Продление сертификата вручную  
 Типичный срок действия сертификата клиента Mac — 1 год. Configuration Manager не продлевает автоматически сертификат пользователя, запрашиваемый при регистрации, поэтому необходимо использовать описанную ниже процедуру, чтобы продлить сертификат вручную.  

> [!IMPORTANT]  
>  Если срок действия сертификата истек, необходимо удалить, повторно установить и затем отозвать клиента Mac.  

 Эта процедура удаляет SMSID, необходимый для запроса нового сертификата для одного и того же компьютера Mac. При удалении и замене SMSID клиента все сохраненные журналы клиента, такие как инвентарные данные, удаляются после удаления клиента из консоли Configuration Manager.  

1.  Создайте и заполните коллекцию устройств для компьютеров Mac, на которых требуется продлить сертификаты пользователей.  

    > [!WARNING]  
    >  Configuration Manager не отслеживает срок действия сертификата, регистрируемого для компьютеров Mac. Необходимо независимо отслеживать это из Configuration Manager, чтобы выявить компьютеры Mac для добавления к этой коллекции.  

2.  В рабочей области **Активы и соответствие** выберите **Запуск мастера создания элементов конфигурации**.  

3.  На странице **Общие** укажите перечисленные ниже сведения.  

    -   **Имя:удалить SMSID для Mac**  

    -   **Тип:Mac OS X**  

4.  На странице **Поддерживаемые платформы** убедитесь, что выбраны все версии Mac OS X.  

5.  На странице **Параметры** выберите команду **Создать**, а затем в диалоговом окне **Создание параметра** укажите приведенные ниже сведения.  

    -   **Имя:удалить SMSID для Mac**  

    -   **Тип параметра:сценарий**  

    -   **Тип данных:строковый**  

6.  В диалоговом окне **Создание параметра** в области **Сценарий обнаружения** выберите команду **Добавить сценарий**, чтобы указать сценарий для обнаружения компьютеров Mac с настроенным SMSID.  

7.  В диалоговом окне **Изменение сценария обнаружения** введите следующий сценарий:  

    ```  
    defaults read com.microsoft.ccmclient SMSID  
    ```  

8.  Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Изменение сценария обнаружения**.  

9. В диалоговом окне **Создание параметра** в области **Сценарий исправления (необязательно)** выберите команду **Добавить сценарий**, чтобы указать сценарий, который удаляет SMSID при его обнаружении на компьютерах Mac.  

10. В диалоговом окне **Создание сценария исправления** введите следующий сценарий:  

    ```  
    defaults delete com.microsoft.ccmclient SMSID  
    ```  

11. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Создание сценария исправления**.  

12. На странице **Правила соответствия** мастера щелкните **Создать**, а затем в диалоговом окне **Создание правила** укажите следующие сведения.  

    -   **Имя:удалить SMSID для Mac**  

    -   **Выбранный параметр**: нажмите кнопку **Обзор** и выберите сценарий обнаружения, указанный ранее.  

    -   В поле **следующих значений** введите **Домен/пара по умолчанию (com.microsoft.ccmclient, SMSID) не существует**.  

    -   Включите параметр **Запустить следующий сценарий исправления, если этот параметр не соответствует требованиям**.  

13. Завершите работу мастера создания элементов конфигурации.  

14. Создайте базовую конфигурацию, содержащую только что созданный элемент конфигурации, и разверните ее в коллекции устройств, созданной на шаге 1.  

     Дополнительные сведения о создании и развертывании базовых конфигураций см. в статьях [Создание конфигурационных баз в System Center Configuration Manager](../../../compliance/deploy-use/create-configuration-baselines.md) и [Развертывание конфигурационных баз в System Center Configuration Manager](../../../compliance/deploy-use/deploy-configuration-baselines.md).  

15. На компьютерах Mac с удаленным SMSID выполните следующую команду для установки нового сертификата:  

    ```  
    sudo ./CMEnroll -s <enrollment_proxy_server_name> -ignorecertchainvalidation -u <'user name'>  
    ```  

     При появлении запроса введите пароль для учетной записи суперпользователя, чтобы выполнить команду, а затем введите пароль для учетной записи пользователя Active Directory.  

16. Чтобы ограничить зарегистрированный сертификат рамками Configuration Manager, на компьютере Mac откройте окно терминала и внесите указанные ниже изменения.  

    a.  Введите команду **sudo /Applications/Utilities/Keychain\ Access.app/Contents/MacOS/Keychain\ Access**  

    б.  В диалоговом окне **Доступ к цепочке ключей** в области **Цепочки ключей** выберите пункт **Система**, а затем в разделе **Категория** выберите **Ключи**.  

    в.  Разверните ключи для просмотра сертификатов клиента. Найдите сертификат с только что установленным закрытым ключом и дважды щелкните ключ.  

    г.  На вкладке **Управление доступом** выберите пункт **Подтвердить перед предоставлением доступа**.  

    д.  Перейдите в папку **/Library/Application Support/Microsoft/CCM**, выберите файл **CCMClient** и нажмите кнопку **Добавить**.  

    е.  Нажмите кнопку **Сохранить изменения** и закройте диалоговое окно **Доступ к цепочке ключей**.  

17. Перезапустите компьютер Mac.  

