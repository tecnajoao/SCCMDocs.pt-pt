---
title: "Создание и выполнение скриптов с помощью Configuration Manager | Документация Майкрософт"
description: "Создание скриптов и их выполнение на клиентских устройствах с помощью Configuration Manager."
ms.custom: na
ms.date: 08/09/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-app
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: cc230ff4-7056-4339-a0a6-6a44cdbb2857
caps.latest.revision: "14"
caps.handback.revision: "0"
author: robstackmsft
ms.author: robstack
manager: angrobe
ms.openlocfilehash: ed84f7900eee5c04728d0e4d1b46027c36327bec
ms.sourcegitcommit: b41d3e5c7f0c87f9af29e02de3e6cc9301eeafc4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2017
---
# <a name="create-and-run-powershell-scripts-from-the-configuration-manager-console"></a>Создание и запуск скриптов PowerShell из консоли Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Configuration Manager, помимо пакетов и программ для развертывания скриптов, предоставляет функциональные возможности для выполнения следующих действий:

- Импорт скриптов PowerShell в Configuration Manager.
- изменение скриптов из консоли Configuration Manager (только для неподписанных скриптов);
- установка статуса скриптов "Утверждено" или "Отклонено" для повышения безопасности;
- выполнение скриптов для коллекций клиентских компьютеров Windows и локальных управляемых компьютеров Windows Вам не нужно развертывать скрипты, они просто выполняются на клиентских устройствах практически мгновенно.
- анализ результатов, возвращаемых скриптом, в консоли Configuration Manager.

>[!TIP]
>В этой версии Configuration Manager скрипты считаются функцией предварительной версии. Сведения о том, как включить скрипты, см. в статье [Функции предварительной версии в System Center Configuration Manager](/sccm/core/servers/manage/pre-release-features).

## <a name="prerequisites"></a>Предварительные требования

Для запуска скриптов PowerShell на клиенте должна быть запущена оболочка PowerShell версии 3.0 или более поздней. Если сам скрипт содержит функциональные возможности, добавленные в более поздних версиях PowerShell, на клиенте должна быть установлена соответствующая версия.

На клиентах Configuration Manager должен работать клиент версии 1706 или более поздней, чтобы выполнять сценарии.

Чтобы использовать скрипты, необходимо быть членом соответствующей роли безопасности Configuration Manager.

- Чтобы импортировать или создавать скрипты, нужна учетная запись с разрешениями **создавать** **скрипты SMS** в роли безопасности **Менеджер параметров соответствия**.
- Чтобы утверждать или отклонять скрипты, нужна учетная запись с разрешениями **утверждать** **скрипты SMS** в роли безопасности **Менеджер параметров соответствия**.
- Чтобы выполнять скрипты, нужна учетная запись с разрешениями **запускать скрипты** для **коллекций** в роли безопасности **Менеджер параметров соответствия**.

Дополнительные сведения о ролях безопасности Configuration Manager см. в статье с [общими сведениями о ролевом администрировании](/sccm/core/understand/fundamentals-of-role-based-administration).

По умолчанию пользователь не может утверждать созданные им скрипты. Благодаря мощи и гибкости скриптов, а также возможности их развертывания на множестве устройств, вы можете делегировать создание и утверждение скриптов разным людям. Эти роли предоставляют дополнительный уровень защиты от бесконтрольного выполнения скриптов. Для упрощения тестирования дополнительный уровень утверждения можно отключить.

## <a name="allow-users-to-approve-their-own-scripts"></a>Предоставление пользователям разрешения самостоятельно утверждать свои скрипты

1. В консоли Configuration Manager щелкните **Администрирование**.
2. В рабочей области **Администрирование** разверните узел **Конфигурация сайта**и выберите **Сайты**.
3. В списке сайтов выберите нужный сайт и на вкладке **Главная** в группе **Сайты** щелкните **Параметры иерархии**.
4. На вкладке **Общие** в диалоговом окне **Свойства параметров иерархии** снимите флажок **Не разрешать авторам скриптов утверждать свои собственные скрипты**.

## <a name="import-and-edit-a-script"></a>Импорт и редактирование скрипта

1. В консоли Configuration Manager щелкните **Библиотека программного обеспечения**.
2. В рабочей области **Библиотека программного обеспечения** щелкните **Скрипты**.
3. На вкладке **Главная** в группе **Создать** щелкните **Создать скрипт**.
4. На странице **Скрипт** в **мастере создания скрипта** настройте следующие параметры.
    - **Имя скрипта**. Введите здесь имя для скрипта. Вы можете создать несколько скриптов с одинаковыми именами, но повторы имен затруднят поиск нужного скрипта в консоли Configuration Manager.
    - **Язык скрипта**. Сейчас поддерживаются только скрипты PowerShell.
    - **Импорт**. Импорт скрипта PowerShell в консоли. Скрипт отображается в поле **Скрипт**.
    - **Очистить**. Удаление текущего скрипта из поля "Скрипт".
    - **Скрипт**. Отображение текущего импортируемого скрипта. В этом поле при необходимости вы можете изменять скрипт.
5. Завершите работу мастера. Новый скрипт отображается в списке **Скрипт** с состоянием **Ожидается утверждение**. Прежде чем выполнять такой скрипт на клиентских устройствах, его необходимо утвердить.

### <a name="script-examples"></a>Примеры скриптов

Ниже приведены некоторые примеры скриптов, которые могут вас заинтересовать.

#### <a name="create-a-folder"></a>Создание папки

*New-Item "c:\scripts" -type folder name* 
 
 
#### <a name="create-a-file"></a>Создание файла

*New-Item c:\scripts\new_file.txt -type file name*


## <a name="approve-or-deny-a-script"></a>Утверждение или отклонение скрипта

Выполняемый скрипт должен быть сначала утвержден. Чтобы утвердить скрипт, выполните следующее.

1. В консоли Configuration Manager щелкните **Библиотека программного обеспечения**.
2. В рабочей области **Библиотека программного обеспечения** щелкните **Скрипты**.
3. В списке **Скрипт** выберите нужный скрипт для утверждения или отклонения, затем щелкните **Утвердить или отклонить** на вкладке **Главная** в группе **Скрипт**.
4. В диалоговом окне **Утверждение или отклонение скрипта** выберите действие **Утвердить** или **Отклонить**. Также здесь вы можете добавить комментарий к своему решению. Отклоненный скрипт не может выполняться на клиентских устройствах.
5. Завершите работу мастера. Вы видите, что в списке **Скрипт** изменилось значение в столбце **Состояние утверждения** в зависимости выбранного вами действия.

## <a name="run-a-script"></a>Выполнить сценарий
Утвержденный скрипт можно выполнить в коллекции по вашему выбору.

1. В консоли Configuration Manager щелкните элемент **Активы и соответствие**.
2. В рабочей области "Активы и соответствие" щелкните **Коллекции устройств**.
3. В списке **Коллекции устройств** выберите нужную коллекцию, в которой будет выполняться скрипт.
4. На вкладке **Главная** в группе **Все системы** нажмите кнопку **Запустить скрипт**.
5. На странице **Скрипт** мастера **запуска скрипта** выберите в списке нужный скрипт. Здесь отображаются только утвержденные скрипты.
6. Нажмите кнопку **Далее** и завершите работу мастера.

>[!IMPORTANT]
>Для выполнения скрипта предоставляется период длительностью один час. Если за это время скрипт не будет выполнен (например, если компьютер выключен), его придется запустить снова.

## <a name="next-steps"></a>Дальнейшие действия

Когда вы запустите скрипт на клиентских устройствах, вы можете отслеживать результаты операции, используя эту процедуру.

1. В консоли Configuration Manager щелкните элемент **Мониторинг**.
2. В рабочей области **Мониторинг** щелкните **Состояние скрипта**.
3. В списке **Состояние скрипта** можно просмотреть результаты для каждого скрипта, запущенного на клиентских устройствах. Обычно код выхода **0** означает, что скрипт выполнен успешно.
