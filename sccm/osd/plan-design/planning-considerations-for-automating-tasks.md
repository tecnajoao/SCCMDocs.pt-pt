---
title: "Вопросы планирования для автоматизации задач | Документы Майкрософт"
description: "Спланируйте автоматизацию задач в System Center Configuration Manager."
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: fc497a8a-3c54-4529-8403-6f6171a21c64
caps.latest.revision: "13"
caps.handback.revision: "0"
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.openlocfilehash: 830f715b688cc9929a179da94eba9c81de8db11a
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="planning-considerations-for-automating-tasks-in-system-center-configuration-manager"></a>Вопросы планирования для автоматизации задач в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Вы можете создавать последовательности задач для автоматизации задач в System Center Configuration Manager. Это могут быть, например, задачи записи операционной системы на эталонном компьютере и задачи развертывания операционной системы на одном или нескольких конечных компьютерах. Действия последовательности задач определяются в отдельных шагах последовательности. При выполнении последовательности задач действия каждого шага выполняются на уровне командной строки в контексте локальной системы без необходимости вмешательства пользователя. Используйте следующие разделы для планирования автоматизации задач в Configuration Manager:

##  <a name="BKMK_TSStepsActions"></a> Шаги и действия последовательности задач  
 Шаги представляют собой основные компоненты последовательности задач. Они могут содержать команды, настраивающие и записывающие операционную систему компьютера-образца, а также команды, устанавливающие операционную систему, драйверы, клиент Configuration Manager и ПО на конечном компьютере. Команды шага последовательности задач определяются действиями шага. Существует два типа действий. Действие, определяемое с помощью командной строки, называется настраиваемым действием. Действие, предопределенное Configuration Manager, называется встроенным. Последовательность задач может выполнять любое сочетание настраиваемых и встроенных действий.  

 Шаги последовательности задач также включает условия, управляющие поведением действия, например, предусматривающие остановку или продолжение выполнения последовательности задач в случае ошибки. Условия назначаются шагу посредством включения в него переменной последовательности задач. Например, с помощью переменной **SMSTSLastActionRetCode** можно проверить условие предыдущего шага. Переменные можно добавить в один шаг или группу шагов.  

 Шаги последовательности задач обрабатываются последовательно, включая действие шага и любые условия, назначенные шагу. Когда Configuration Manager начинает обрабатывать шаг последовательности задач, следующий шаг не начинается до тех пор, пока не завершится предыдущее действие. Последовательность задач считается завершенной, если все шаги были завершены или если ошибка в шаге привела к прерыванию выполнения последовательности в Configuration Manager до завершения всех ее шагов. Например, если шаг последовательности задач не может найти требуемое изображение или пакет в точке распространения, последовательность задач содержит поврежденную ссылку и Configuration Manager прекращает выполнение последовательности задач, если в шаге, вызвавшем ошибку, не указано условие продолжения работы при возникновении ошибки.  

> [!IMPORTANT]  
>  По умолчанию последовательность задач завершается ошибкой после сбоя одного шага или действия. Чтобы продолжить выполнение последовательности задач после сбоя шага, измените последовательность задач, откройте вкладку **Параметры** и выберите команду **Продолжать при ошибке**.  

 Дополнительные сведения о шагах, которые можно добавить в последовательность задач, см. в статье [Шаги последовательности задач](../understand/task-sequence-steps.md).  

##  <a name="BKMK_TSGroups"></a> Группы последовательности задач  
 **Группы** — это несколько шагов в последовательности задач. Группа последовательности задач состоит из имени, дополнительного описания и любых дополнительных условий, оцениваемых в целом перед переходом к следующему шагу последовательности. Группы могут быть вложены друг в друга. Группа может представлять собой сочетание шагов и подгрупп. Группы полезны для объединения нескольких шагов, имеющих общее условие.  

> [!IMPORTANT]  
>  По умолчанию группа последовательности задач завершает работу с ошибкой, если любой из шагов или любая подгруппа в группе вызывает ошибку. Чтобы продолжить выполнение последовательности задач после сбоя шага или подгруппы, измените последовательность задач, откройте вкладку **Параметры** и выберите команду **Продолжать при ошибке**.  

 В приведенной ниже таблице показано действие параметра **Продолжать при ошибке** при группировании шагов.  

 В данном примере существуют две группы последовательностей задач, в каждой из которых содержится три шага последовательности задач.  

|Шаг или группа последовательности задач|Параметр "Продолжать при ошибке"|  
|---------------------------------|-------------------------------|  
|**Группа 1 последовательности задач**|**Продолжать при ошибке** , выбран параметр.|  
|Шаг 1 последовательности задач|**Продолжать при ошибке** , выбран параметр.|  
|Шаг 2 последовательности задач|Не задано.|  
|Шаг 3 последовательности задач|Не задано.|  
|**Группа 2 последовательности задач**|Не задано.|  
|Шаг 4 последовательности задач|Не задано.|  
|Шаг 5 последовательности задач|Не задано.|  
|Шаг 6 последовательности задач|Не задано.|  

-   Если шаг 1 последовательности задач завершает работу с ошибкой, выполнение последовательности задач будет продолжено с шага 2.  

-   Если шаг 2 последовательности задач завершается ошибкой, выполнение последовательности задач продолжается не шагом 3, а шагами 4 и 5, которые находятся в другой группе последовательности задач.  

-   Если шаг 4 завершается ошибкой, дальнейшие шаги не выполняются и последовательность задач завершается ошибкой, так как параметр **Продолжать при ошибке** не настроен для группы 2 последовательности задач.  

 Необходимо назначить имя группам последовательности задач, хотя имя группы не обязательно должно быть уникальным. Можно также ввести необязательное описание для группы последовательности задач.  

##  <a name="BKMK_TSVariables"></a> Переменные последовательности задач  
 Переменные последовательности задач представляют собой наборы пар имен и значений, дополняющие собой параметры конфигурации и развертывания для компьютера, операционной системы, а также задачи, связанные с настройкой состояний пользователей на компьютере с клиентом Configuration Manager. Переменные последовательности задач представляют собой способ создания и настройки шагов в последовательности задач.  

 При выполнении последовательности задач многие параметры последовательности задач сохраняются в переменных среды. Значения встроенных переменных последовательности задач можно просматривать и изменять. Кроме того, можно создавать новые переменные последовательности задач, чтобы скорректировать выполнение последовательности задач на конечном компьютере.  

 Переменные последовательности задач можно использовать в среде последовательности задач для выполнения следующих действий.  

-   Настройка параметров для действия последовательности задач  

-   Аргументы командной строки для шага последовательности задач  

-   Оценка условия, определяющего, выполняется ли шаг или группа последовательности задач  

-   Ввод значений для пользовательских сценариев, используемых в последовательности задач  

 Например, может присутствовать последовательность задач, содержащая шаг **Присоединить к домену или рабочей группе**. Последовательность задач может быть развернута в различных коллекциях, где членство коллекции определяется членством в домене. В этом случае можно указать переменную последовательности задач коллекции для каждого доменного имени коллекции и затем использовать эту переменную последовательности задач для предоставления соответствующего доменного имени в последовательности задач.  

###  <a name="BKMK_TSCreateVariables"></a> Создание переменных последовательности задач  
 Можно создавать новые переменные последовательности задач и управлять шагами последовательности. Например, можно создать переменную последовательности задач для переопределения параметра встроенной задачи последовательности. Также можно создать настраиваемую переменную последовательности задач для использования с условиями, командами в командной строке или настраиваемыми шагами в последовательности задач. При создании переменной последовательности задач сама переменная и связанное с ней значение резервируются в среде последовательности задач и остаются в таком состоянии даже в случае перезапуска конечного компьютера последовательностью задач. Переменная и ее значение могут использоваться в последовательности задач в различных средах операционной системы. Например, переменная может использоваться как в полнофункциональной версии операционной системы Windows, так и в среде предустановки Windows.  

 В следующей таблице описываются методы создания переменной последовательности задач и приводятся дополнительные сведения об использовании.  

|Метод создания|Использование|  
|-------------------|-----------|  
|Задание полей в шагах последовательности задач с помощью редактора последовательности задач.|Задает значения по умолчанию для шага последовательности задач. Переменная и значение доступны только при выполнении шага в последовательности задач. Они не являются частью общей среды последовательности и недоступны для других шагов последовательности задач.<br /><br /> Список встроенных переменных и связанных с ними действий см. в статье [Переменные действия последовательности задач](../understand/task-sequence-action-variables.md).|  
|Добавление шага задания переменной последовательности задач|Указывает переменную последовательности задач и значение в среде последовательности задач, если шаг последовательности задач выполняется как часть последовательности задач. Все последующие шаги последовательности задач имеют доступ к переменной среды и ее значению.|  
|Определение переменной коллекции|Указывает переменные последовательности задач и их значения для коллекции компьютеров. Все последовательности задач, связанные с коллекцией, имеют доступ к переменным последовательности задач и их значениям.|  
|Определение переменной компьютера|Указывает переменные последовательности задач и их значения для конкретного компьютера. Все последовательности задач, связанные с компьютером, имеют доступ к переменным последовательности задач и их значениям.|  
|Добавление переменной последовательности задач на странице **Настройка** мастера создания носителя с последовательностью задач|Указывает переменные последовательности задач и их значения для последовательности, выполняемой с носителя, имеющего доступ к переменной последовательности задач и ее значению.|  

 Для переопределения значения по умолчанию встроенной переменной последовательности задач необходимо определить переменную последовательности задач с таким же именем, как у встроенной переменной последовательности задач. Список встроенных переменных последовательности задач со связанными действиями и сведениями об использовании см. в разделе [Встроенные переменные последовательности задач](../understand/task-sequence-built-in-variables.md).  

 Вы можете удалить переменную последовательности задач из среды последовательности, используя те же методы, что и при создании переменной. В этом случае, чтобы удалить переменную из среды последовательности задач, следует задать в качестве значения переменной последовательности задач пустую строку.  

 Используя сочетание методов, можно задавать различные значения переменной среды последовательности задач в рамках одной последовательности. В более сложных случаях можно присвоить значения по умолчанию для шагов последовательности с использованием редактора последовательности задач и затем задать настраиваемое значение переменной, используя различные методы создания. В следующем списке описываются правила, определяющие, какое значение используется при создании переменной последовательности задач с помощью нескольких методов.  

1.  Шаг **Задать переменную последовательности задач** переопределяет все остальные методы создания.  

2.  Переменные для компьютера имеют приоритет над переменными коллекции. Если для переменной компьютера и переменной коллекции указано одно и то же имя, при выполнении конечным компьютером развернутой последовательности задач используется значение переменной компьютера.  

3.  Последовательности задач можно выполнять с носителя. Используйте переменные носителей вместо переменных коллекции или переменных компьютера. Если последовательность задач выполняется с носителя, переменные компьютера и коллекции не применяются и не используются. Вместо этого переменные последовательности задач, определенные на странице **Настройка** мастера создания носителя с последовательностью задач, используются для задания значений, связанных с последовательностью задач, выполняемой с носителя.  

4.  Если значение переменной последовательности задач не задано в рамках среды последовательности, встроенные действия используют при выполнении шага значения по умолчанию, как указано в редакторе последовательности задач.  

 Помимо переопределения значений параметров встроенного шага последовательности задач, можно также создать новую переменную среды для использования в шаге, сценарии, командной строке или условии. При указании имени новой переменной последовательности задач следует соблюдать определенные правила.  

-   Имя переменной последовательности задач может содержать буквы, цифры, символ подчеркивания (_) и дефис (-).  

-   Длина имени переменной последовательности задач может иметь длину от 1 до 256 знаков.  

-   Определенные пользователем переменные должны начинаться с буквы (A-Z или a-z).  

-   Имена определенных пользователем переменных не могут начинаться с символа подчеркивания. Символ подчеркивания ставится перед именем только для переменных последовательности задач  

    > [!NOTE]  
    >  Переменные последовательности задач, доступные только для чтения, могут считываться шагами последовательности задач, но не могут быть изменены. Например, можно использовать переменную, доступную только для чтения, как часть командной строки для переменной действия последовательности задач **Выполнить из командной строки**, однако нельзя задать значение переменной, доступной только для чтения, используя переменную действия **Задать переменную последовательности задач**.  

-   Имена переменных последовательности задач не чувствительны к регистру. Например, "OSDVAR" и "osdvar" — это одна и та же переменная последовательности задач.  

-   Имена переменных последовательности задач не могут начинаться или заканчиваться пробелом, а также содержать пробелы внутри имени. Пробелы, оставленные перед именем переменной последовательности задач или после него, игнорируются.  

 В следующей таблице приведены примеры допустимых и недопустимых переменных последовательности задач, определенных пользователем.  

|Примеры допустимых имен пользовательских переменных|Примеры недопустимых имен пользовательских переменных|  
|-------------------------------------------------------|----------------------------------------------------------|  
|MyVariable|1Variable<br /><br /> Переменные последовательности задач, определенные пользователем, не могут начинаться с цифры.|  
|My_Variable|MyV@riable<br /><br /> Переменные последовательности задач, определенные пользователем, не могут содержать символ "@".|  
|My_Variable_2|_MyVariable<br /><br /> Переменные последовательности задач, определенные пользователем, не могут начинаться со знака подчеркивания.|  

 Общие ограничения для переменных последовательности задач.  

-   Значения переменных последовательности задач не могут превышать 4 000 символов.  

-   Нельзя создать или переопределить переменную последовательности задач, доступную только для чтения. Переменным, доступным только для чтения, присваиваются имена, начинающиеся с символа подчеркивания (_). Значения переменных последовательности задач, доступных только для чтения, могут считываться, однако они не могут быть изменены.  

-   В зависимости от использования в значениях переменных последовательности задач может учитываться регистр. В большинстве случаев значения переменных последовательности задач не зависят от регистра. Однако некоторые значения, такие как переменная, содержащая пароль, могут учитывать регистр.  

-   Ограничения на количество создаваемых переменных последовательности задач не существует. Однако количество переменных ограничено размером среды последовательности задач. Общий размер среды последовательности задач ограничен объемом 32 МБ.  

###  <a name="BKMK_TSEnvironmentVariables"></a> Доступ к переменным среды  
 После указания переменной последовательности задач и его значения с помощью одного из методов, описанных в предыдущем разделе, можно использовать значение переменной в последовательностях задач. Можно считывать значения по умолчанию встроенных переменных последовательности, задавать новое значение встроенной переменной, а также использовать настраиваемую переменную последовательности задач в командной строке или скрипте.  

 В следующей таблице приведены операции последовательности задач, которые можно выполнять посредством доступа к переменным среды последовательности задач.  

|Операция последовательности задач|Использование|  
|-----------------------------|-----------|  
|Настройка параметров действий|Можно указать, что параметр шага последовательности задач будет предоставляться переменной при выполнении последовательности.<br /><br /> Чтобы задать предоставление параметра шага последовательности с помощью переменной среды последовательности задач, воспользуйтесь редактором последовательности задач, чтобы внести изменения в шаг и указать имя переменной в качестве значения поля. Имя переменной должно заключаться в символы процента (%), которые указывают, что значение является переменной среды.|  
|Предоставление аргументов командной строки|Можно частично или полностью указать настраиваемую командную строку, используя значение переменной среды.<br /><br /> Чтобы указать параметр командной строки, используя переменную среды, добавьте имя переменной в поле **Командная строка** шага последовательности задач **Выполнить из командной строки**. Имя переменной должно быть заключено в символы процентов (%).<br /><br /> Например, в следующей командной строке используется встроенная переменная среды для записи имени компьютера в файл C:\File.txt.<br /><br /> <br /><br /> **Cmd /C %_SMSTSMachineName% > C:\File.txt**|  
|Оценка условия шага|Встроенные или настраиваемые переменные среды последовательности задач можно использовать в составе условия шага или группы последовательности задач. Перед запуском шага или группы последовательности задач будет выполняться оценка значения переменной среды.<br /><br /> Чтобы добавить условие, оценивающее значение переменной, выполните следующие действия.<br /><br /> 1.  Выберите шаг или группу, в которую предполагается добавить условие.<br />2.  На вкладке **Параметры** для этого шага или группы выберите в раскрывающемся меню **Добавить условие** пункт **Переменная последовательности задач**.<br />3.  В диалоговом окне **Переменная последовательности задач** укажите имя переменной, проверяемое условие и значение переменной.|  
|Предоставление данных для пользовательского сценария|Для чтения и записи переменных последовательности задач во время выполнения последовательности используется COM-объект Microsoft.SMS.TSEnvironment.<br /><br /> Ниже приведен пример, иллюстрирующий использование файла скрипта Visual Basic, который запрашивает переменную последовательности задач **_SMSTSLogPath** для получения сведений о текущем расположении журнала. Сценарий также задает пользовательскую переменную.<br /><br /> <br /><br /> **dim osd: set env = CreateObject("Microsoft.SMS.TSEnvironment")**<br /><br /> <br /><br /> **dim logPath**<br /><br /> <br /><br /> **' Можно запросить среду для получения существующей переменной.**<br /><br /> **logPath = env("_SMSTSLogPath")**<br /><br /> <br /><br /> **' Можно также задать переменную в среде OSD.**<br /><br /> **env("MyCustomVariable") = "varname"**<br /><br /> <br /><br /> Дополнительные сведения об использовании переменных последовательности задач в сценариях см. в документации пакета средств разработки.|  

###  <a name="BKMK_ComputerCollectionVariables"></a> Переменные компьютеров и коллекций  
 Можно настроить одновременное выполнение последовательностей задач на нескольких компьютерах или в нескольких коллекциях. Можно указать уникальные данные для отдельного компьютера или коллекции, например, задать уникальный ключ продукта операционной системы или присоединение всех членов коллекции к указанному домену.  

 Переменные последовательности задач можно назначить одному компьютеру или коллекции. Когда начинается выполнение последовательности задач на целевом компьютере или в коллекции, указанные значения применяются к целевому компьютеру или коллекции.  

 Переменные последовательности задач можно указать для отдельного компьютера или коллекции. Когда начинается выполнение последовательности задач на целевом компьютере или в коллекции, указанные переменные добавляются в среду и значения становятся доступны всем шагам в последовательности задач.  

> [!WARNING]  
>  Если одно и то же имя переменной используется и для переменной компьютера и для переменной коллекции, значение переменной компьютера имеет приоритет над переменной коллекции. Переменные последовательности задач, назначаемые коллекциям, имеют приоритет над встроенными переменными последовательности задач.  

 Дополнительные сведения о создании переменных последовательности задач для компьютеров и коллекций см. в разделе [Создание переменных последовательности задач для компьютеров и коллекций](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_CreateTSVariables).  

###  <a name="BKMK_TSMediaVariables"></a> Переменные носителя с последовательностью задач  
 Можно указать переменные последовательности для последовательностей задач, выполняемых с носителя. При использовании носителя для развертывания операционной системы необходимо добавить переменные последовательности задач и указать их значения при создании носителя (переменные и их значения будут храниться на носителе).  

> [!NOTE]  
>  Последовательности задач хранятся на автономном носителе. Однако все другие типы носителей, такие как предварительно подготовленный носитель, получают последовательности задач с точки управления.  

 Переменные последовательности задач можно указать на странице **Настройка** мастера создания носителя с последовательностью задач. Сведения о создании носителей см. в разделе [Создание носителя последовательности задач](../deploy-use/create-task-sequence-media.md).  

> [!TIP]  
>  Последовательность задач записывает ИД пакета и командную строку, выполняемую перед запуском, включая значения всех переменных последовательности задач, в файл журнала CreateTSMedia.log на компьютере, на котором запущена консоль Configuration Manager. В этом файле журнала можно проверить значения переменных последовательности задач.  

##  <a name="BKMK_TSCreate"></a> Создание последовательности задач  
 Последовательности задач можно создавать с помощью мастера создания последовательности задач. Мастер позволяет создавать встроенные последовательности задач, выполняющие определенные задачи, а также настраиваемые последовательности задач с более широкими функциями.  

 Например, можно создать последовательности задач, которые создают и снимают образ операционной системы эталонного компьютера, устанавливают существующий образ операционной системы на конечном компьютере или создают настраиваемую последовательность задач, которая выполняет указанные задачи. Настраиваемые последовательности задач можно использовать для выполнения специальных развертываний операционной системы.  

 Дополнительные сведения о создании последовательностей задач см. в разделе [Создание последовательностей задач](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_CreateTaskSequence).  

##  <a name="BKMK_TSEdit"></a> Изменение последовательности задач  
 Вносить изменения в последовательность задач можно с помощью **редактора последовательности задач**. С помощью редактора в последовательность можно вносить следующие изменения:  

-   добавлять или удалять шаги из последовательности задач;  

-   изменять порядок шагов последовательности задач;  

-   добавлять или удалять группы шагов;  

-   указывать, будет ли продолжаться выполнение последовательности задач в случае возникновения ошибки;  

-   добавлять условия в шаги и группы последовательности задач.  

> [!IMPORTANT]  
>  Если в результате внесения изменений в последовательности задач остаются несвязанные ссылки на пакет или программу, необходимо исправить ссылку, удалить программу без ссылки из последовательности задач или временно отключить вызвавший ошибку шаг последовательности задач, пока не будет исправлена или удалена нерабочая ссылка.  

 Дополнительные сведения об изменении последовательностей задач см. в разделе [Изменение последовательности задач](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ModifyTaskSequence).  

##  <a name="BKMK_TSDeploy"></a> Развертывание последовательности задач  
 Последовательности задач можно развертывать на конечных компьютерах в любых коллекциях Configuration Manager. К ним относится коллекция **Все неизвестные компьютеры** , которая используется для развертывания операционных систем на неизвестных компьютерах. Однако развертывание последовательности задач для коллекции пользователей не поддерживается.  

> [!IMPORTANT]  
>  Не следует развертывать последовательности задач, устанавливающие операционные системы, в несоответствующих коллекциях, таких как **Все системы** . Убедитесь, что коллекция, в которой развертывается последовательность задач, содержит только те компьютеры, на которые требуется установить операционную систему. Чтобы предотвратить нежелательное развертывание операционной системы, можно управлять параметрами развертывания. Дополнительные сведения см. в разделе [Параметры для управления развертываниями с высоким риском](../../protect/understand/settings-to-manage-high-risk-deployments.md).  

 Каждый конечный компьютер, получающий последовательность задач, выполняет ее согласно параметрам, заданным в развертывании. Сама последовательность задач не содержит связанных файлов и программ. Все файлы, на которые ссылается последовательность задач, должны уже присутствовать на конечном компьютере или размещаться на точке управления, к которой клиенты имеют доступ. Кроме того, последовательность задач устанавливает пакеты, на которые ссылаются программы, даже если программа или пакет уже установлены на конечном компьютере.  

> [!NOTE]  
>  В отличие от пакетов и программ приложение устанавливается последовательностью задач, только если для него соблюдаются правила требований и оно еще не установлено на компьютере (в зависимости от метода обнаружения, указанного для приложения).  

 Клиент Configuration Manager выполняет развертывание последовательности задач при скачивании политики клиента. Чтобы инициировать это действие, не дожидаясь следующего цикла опроса, см. раздел [Инициация получения политик для клиента Configuration Manager](../../core/clients/manage/manage-clients.md#BKMK_PolicyRetrieval).  

 При развертывании последовательностей задач на устройствах Windows Embedded с включенными фильтрами записи можно указать, требуется ли отключить фильтры записи на устройстве в ходе развертывания и перезапустить устройство после развертывания. Если фильтр записи не отключен, последовательность задач развертывается на временном перекрытии и не будет доступна при перезагрузке устройства.  

> [!NOTE]  
>  При развертывании последовательности задач на устройстве Windows Embedded убедитесь, что устройство входит в коллекцию, для которой настроен период обслуживания. Благодаря этому пользователь может управлять отключением и включением фильтра записи, а также временем перезапуска устройства.  
>   
>  Если клиенты загружают последовательности задач вне периода обслуживания, последовательность задач загружается дважды. В этом сценарии клиенты загрузят последовательность задач, отключат фильтры записи, перезагрузят компьютер, а затем загрузят последовательности задач заново, поскольку она была загружена на временное перекрытие, которое очищается при перезагрузке устройства.  

 Дополнительные сведения о развертывании последовательностей задач см. в разделе [Развертывание последовательности задач](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_DeployTS).  

##  <a name="BKMK_TSExportImport"></a> Экспорт и импорт последовательностей задач  
 Configuration Manager позволяет экспортировать и импортировать последовательности задач. При экспорте последовательности задач можно включить объекты, на которые она ссылается. К ним относятся: образ операционной системы, загрузочный образ, пакет агента клиента, пакет драйверов и приложения, имеющие зависимости.  

> [!NOTE]  
>  Процедура импорта и экспорта последовательностей задач очень похожа на процедуру импорта и экспорта приложений в Configuration Manager.  

 Дополнительные сведения о экспорте и импорте последовательностей задач см. в разделе [Экспорт и импорт последовательностей задач](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ExportImport).  

##  <a name="BKMK_TSRun"></a> Выполнение последовательности задач  
 По умолчанию последовательности задач всегда выполняются от имени учетной записи Local System. Шаг командной строки последовательности задач позволяет выполнять последовательность от имени другой учетной записи. При выполнении последовательности задач клиент Configuration Manager прежде всего проверяет наличие пакетов, на которые указывают ссылки, и только затем запускает шаги последовательности задач. Если пакет, на который указывает ссылка, не проверен или не доступен на точке распространения, последовательность задач возвратит ошибку для соответствующего шага последовательности задач.  

 Если настройки распространяемой последовательности задач подразумевают скачивание и выполнение, все зависимые пакеты и приложения загружаются в кэш клиента Configuration Manager. Необходимые пакеты и приложения будут получены с точек распространения. Если размер кэша клиента Configuration Manager слишком мал или не удается обнаружить пакет или приложение, произойдет сбой последовательности задач и будет создано сообщение об изменении состояния. Также можно задать загрузку клиентом содержимого только при необходимости ( **Загружать содержимое локально, если это требуется для выполняющейся последовательности задач**) или установить переключатель **Запустить программу из точки распространения** , чтобы задать установку файлов клиентом непосредственно с точки распространения без предварительной загрузки в кэш. Переключатель **Запустить программу из точки распространения** доступен, только если для пакета, на который указывает ссылка, установлен флажок **Копировать содержимое этого пакета в общую сетевую папку, расположенную в точках распространения** (вкладка **Доступ к данным** окна свойств **Пакет**).  

 Если клиенту, выполняющему последовательность задач, не удается найти зависимый пакет или приложение, клиент немедленно отправляет сообщение об ошибке, если развертывание настроено как **доступное**. Однако если развертывание настроено как **обязательное**, клиент Configuration Manager через определенный интервал ожидания повторяет попытку скачать содержимое до наступления крайнего срока, в случае если содержимое еще не скопировано в точку распространения, к которой клиент может получить доступ.  

 В случае успешного или неудачного выполнения последовательности задач Configuration Manager записывает соответствующее событие в журнал клиента Configuration Manager. После запуска последовательности задач на компьютере ее нельзя отменить или остановить.  

> [!IMPORTANT]  
>  Если шаг последовательности задач требует перезагрузки на клиентском компьютере, клиент должен иметь возможность загружаться с отформатированного раздела диска. Иначе последовательность задач терпит сбой независимо от обработки ошибок, указанной в последовательности задач.  

 Если зависимый объект последовательности задач, например пакет распространения программного обеспечения, обновляется до новой версии, любая последовательность задач, которая ссылается на пакет, автоматически обновляется и указывает на последнюю версию, независимо от того сколько обновлений уже развернуто.  

> [!NOTE]  
>  Прежде чем запускать последовательность задач, клиент Configuration Manager проверяет наличие возможных зависимостей во всех последовательностях задач, а также доступность таких зависимых объектов в точке распространения. Если клиент обнаруживает удаленный объект, от которого зависит последовательность задач, он создает ошибку и не выполняет эту последовательность.  

###  <a name="BKMK_RunProgram"></a> Запуск программы перед выполнением последовательности задач  
 Можно выбрать программу, которая будет выполняться перед запуском последовательности задач. Чтобы указать такую программу, откройте диалоговое окно **Свойства** для последовательности задач и перейдите на вкладку **Дополнительно**, чтобы настроить перечисленные ниже параметры.  

> [!IMPORTANT]  
>  Чтобы запустить программу перед тем, как выполняется последовательность задач, весь контент для последовательности задач и программы должен быть доступен на общем ресурсе пакета. Общая папка пакета настраивается на вкладке **Доступ к данным** в свойствах пакета.  

-   **Запустить сначала другую программу**: укажите, требуется ли запускать другую программу перед выполнением последовательности задач.  

    > [!IMPORTANT]  
    >  Этот параметр применяется только к последовательности задач, которая выполняется в полнофункциональной операционной системе. Configuration Manager пропускает этот параметр, если последовательность задач запускается по сети (PXE) или с загрузочного носителя.  

-   **Пакет**: укажите пакет, содержащий программу.  

-   **Программа**: укажите выполняемую программу.  

-   **Всегда сначала запускать эту программу**: Configuration Manager будет запускать эту программу при каждом выполнении последовательности задач на одном и том же клиентском компьютере. По умолчанию после успешного выполнения программы она не запускается повторно, даже если последовательность задач снова выполняется на этом клиенте.  

 Если выбранную программу не удается выполнить на клиенте, последовательность задач не запускается.  

##  <a name="BKMK_TSMaintenanceWindow"></a> Использование периода обслуживания для указания времени запуска последовательности задач  
 Можно указать, когда запускать последовательности задач, путем определения периода обслуживания для коллекции, которая содержит конечные компьютеры. Периоды обслуживания настраиваются с датой начала, временем начала и окончания, а также расписанием повторений. Кроме того, при настройке расписания для периода обслуживания можно указать, что он применяется только для последовательностей задач. Дополнительные сведения см. в разделе [Использование периодов обслуживания](../../core/clients/manage/collections/use-maintenance-windows.md).  

> [!IMPORTANT]  
>  При настройке периода обслуживания для запуска последовательности задач после запуска последовательности она продолжает работать даже в том случае, если период завершается. Последовательность задач будет завершена либо успешно, либо со сбоем.  

##  <a name="BKMK_TSNetworkAccessAccount"></a> Последовательности задач и учетная запись доступа к сети  
 Хотя последовательности задач выполняются только в контексте учетной записи Local System, учетная запись доступа к сети может использоваться в следующих ситуациях.  

-   Учетную запись доступа к сети необходимо правильно настроить. В противном случае произойдет сбой последовательности задач, если она попытается получить доступ к пакетам Configuration Manager в точках распространения для выполнения необходимых задач. Дополнительные сведения об этой учетной записи см. в разделе [Учетная запись доступа к сети](../../core/plan-design/hierarchy/manage-accounts-to-access-content.md#a-namebkmknaaa-network-access-account).  

    > [!NOTE]  
    >  Учетная запись доступа к сети никогда не используется в качестве контекста безопасности для выполнения программ, установки приложений и обновлений или для выполнения последовательностей задач. Тем не менее, учетная запись доступа к сети используется для доступа к связанным ресурсам сети.  

-   При использовании загрузочного образа для запуска развертывания операционной системы диспетчер Configuration Manager использует среду предустановки Windows, не являющуюся полноценной операционной системой. В среде предустановки Windows используется автоматически создаваемое случайное имя, которое не является членом какого-либо домена. Если учетная запись доступа к сети не настроена надлежащим образом, у компьютера могут отсутствовать необходимые разрешения для доступа к пакетам Configuration Manager, которые требуются для завершения последовательности задач.  

##  <a name="BKMK_TSCreateMedia"></a> Создание носителя для последовательностей задач  
 Последовательности задач, а также связанные файлы и зависимые объекты можно записывать на различные носители, в том числе на съемные носители, такие как DVD- и CD-диски или флэш-накопители USB (носители для снятия образа, автономные и загрузочные носители), или в WIM-файлы (предварительно подготовленные носители).  

 Поддерживается создание носителей следующих типов:  

-   **Носители для снятия образа**. На носитель для снятия образа записывается образ операционной системы, который был настроен и создан вне инфраструктуры Configuration Manager. Носитель для снятия образа может содержать специализированные программы, выполняемые до последовательности задач. Специализированная программа может взаимодействовать с рабочим столом, запрашивать пользователя ввести значения или создавать переменные, используемые последовательностью задач.  

     Дополнительные сведения см. в разделе [Создание носителя для снятия образа](../deploy-use/create-capture-media.md).  

-   **Автономные носители**. Автономный носитель содержит последовательность задач и все связанные объекты, необходимые для выполнения последовательности. Последовательности задач на автономном носителе можно выполнять, когда у Configuration Manager отсутствует или ограничено подключение к сети. Автономный носитель можно запустить следующими способами:  

    -   Если конечный компьютер не загружен, используется образ среды предустановки Windows с автономного носителя, связанный с последовательностью задач, и начинается выполнение последовательности задач.  

    -   Автономный носитель можно запустить вручную — для этого пользователь должен находиться в сети и запустить установку.  

    > [!IMPORTANT]  
    >  Для шагов последовательности задач на автономном носителе должна иметься возможность автономного выполнения (без получения каких-либо данных по сети); в противном случае произойдет сбой в шаге последовательности задач, который будет пытаться получить данные. Например, шаг последовательности задач, требующий получения пакета точкой распространения, завершится сбоем. Тем не менее, если необходимые пакеты содержатся на автономном носителе, шаг последовательности задач будет выполнен успешно.  

     Дополнительные сведения см. в разделе [Создание автономного носителя](../deploy-use/create-stand-alone-media.md).  

-   **Загрузочный носитель**. Загрузочные носители содержат файлы, необходимые для запуска конечного компьютера (чтобы можно было подключить его к инфраструктуре Configuration Manager и определить, какие последовательности задач следует выполнить; последнее определяется на основе членства компьютера в коллекциях). Последовательность задач и зависимые объекты не содержатся на носителе, а получаются по сети от клиента Configuration Manager. Этот метод полезен для использования на новых компьютерах или при выполнении развертывания на компьютеры без операционной системы, а также в тех случаях, когда на конечном компьютере отсутствует клиент Configuration Manager или операционная система.  

     Дополнительные сведения см. в разделе [Создание загрузочного носителя](../deploy-use/create-bootable-media.md).  

-   **Предварительно подготовленный носитель**. Предварительно подготовленный носитель развертывает образ операционной системы на конечный компьютер, который не был подготовлен. Предварительно подготовленный носитель представляет собой WIM-файл, который может быть установлен на компьютер без операционной системы производителем или в центре подготовки организации без подключения к среде Configuration Manager.  

     Дополнительные сведения см. в разделе [Создание предварительно подготовленного носителя](../deploy-use/create-prestaged-media.md).  

 При создании носителя укажите для него пароль, чтобы ограничить доступ к файлам на нем. Если пароль будет назначен, пользователю на конечном компьютере необходимо будет его ввести, чтобы запустить последовательность задач.  

 При запуске последовательности задач с носителя архитектура микросхем компьютера, содержащаяся на носителе, не будет распознана. Будет предпринята попытка запуска последовательности задач, даже если заданная архитектура не совпадает с той, что установлена на конечном компьютере. Если архитектура микросхем, содержащаяся на носителе, не совпадает с архитектурой конечного компьютера, происходит сбой установки.  

 Дополнительные сведения об использовании носителя для развертывания операционных систем см. в разделе [Создание носителя последовательности задач](../deploy-use/create-task-sequence-media.md).  
