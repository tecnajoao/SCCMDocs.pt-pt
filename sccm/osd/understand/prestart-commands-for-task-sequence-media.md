---
title: "Команды перед запуском для носителя с последовательностью задач | Документы Майкрософт"
description: "Создайте скрипт для использования в качестве команды перед запуском, распространения содержимого, связанного с командой перед запуском, и настройки команды перед запуском на носителе."
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: ccc9f652-2953-4c38-8a90-c799484105ca
caps.latest.revision: "6"
caps.handback.revision: "0"
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.openlocfilehash: 1c396534425179c6828d48acc578295167c566be
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="prestart-commands-for-task-sequence-media-in-system-center-configuration-manager"></a>Команды перед запуском для носителя с последовательностью задач в Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Вы можете создать в System Center Configuration Manager команду перед запуском для использования с загрузочным носителем, автономным носителем и предварительно подготовленным носителем. Команда перед запуском — это скрипт или исполняемый файл, который запускается перед выбором последовательности задач и может взаимодействовать с пользователем в среде предустановки Windows. Команда перед запуском может запрашивать у пользователя сведения и сохранять их в среде последовательности задач, или запрашивать сведения из переменной последовательности задач. При загрузке целевого компьютера перед загрузкой политики из точки управления запускается командная строка. С помощью следующих процедур можно создать скрипт для использования в качестве команды перед запуском, распространения содержимого, связанного с командой перед запуском и настройки команды перед запуском на носителе.  

## <a name="create-a-script-file-to-use-for-the-prestart-command"></a>Создание файла скрипта для использования в качестве команды перед запуском  
 Для чтения и записи переменных последовательности задач во время выполнения последовательности используется COM-объект Microsoft.SMS.TSEnvironment. Ниже приведен пример, иллюстрирующий использование файла сценария Visual Basic, который запрашивает переменную последовательности задач _SMSTSLogPath для получения сведений о текущем расположении журнала . Сценарий также задает пользовательскую переменную.  

```  
dim osd: set env = CreateObject("Microsoft.SMS.TSEnvironment")  
dim logPath  
' You can query the environment to get an existing variable.  
logPath = env("_SMSTSLogPath")  
' You can also set a variable in the OSD environment.  
env("MyCustomVariable") = "varname"  
```  

## <a name="create-a-package-for-the-script-file-and-distribute-the-content"></a>Создание пакета для файла скрипта и распространения содержимого  
 После создания скрипта или исполняемого файла для команды перед запуском необходимо создать источник пакета для размещения скрипта или исполняемого файла, создания пакета для файлов (программа не требуется) и последующего распространения содержимого в точку распространения.  

 Дополнительные сведения о создании пакета см. в разделе [Пакеты и программы](../../apps/deploy-use/packages-and-programs.md).  

 Дополнительные сведения о распространении содержимого см. в разделе [Распространение содержимого](../../core/servers/deploy/configure/deploy-and-manage-content.md#bkmk_distribute).  

## <a name="configure-the-prestart-command-in-media"></a>Настройка команды перед запуском на носителе  
 Команду перед запуском можно настроить в мастере создания носителя с последовательностью задач для автономного носителя, загрузочного носителя или предварительно настроенного носителя. Дополнительные сведения о типах носителей см. в разделе [Создание носителя последовательности задач](../deploy-use/create-task-sequence-media.md). Для создания команды перед запуском на носителе используется следующая процедура.  

#### <a name="to-create-a-prestart-command-in-media"></a>Создание команды перед запуском на носителе  

1.  В консоли Configuration Manager щелкните **Библиотека программного обеспечения**.  

2.  В рабочей области **Библиотека программного обеспечения** разверните узел **Операционные системы**и выберите элемент **Последовательности задач**.  

3.  На вкладке **Главная** в группе **Создать** щелкните элемент **Создать носитель с файлом последовательности задач** , чтобы запустить мастер создания носителя с последовательностью задач.  

4.  На странице **Выбор типа носителя** выберите **Автономный носитель**, **Загружаемый носитель**или **Предварительно подготовленный носитель**, а затем нажмите кнопку **Далее**.  

5.  Перейдите на страницу мастера **Настройка** . Дополнительные сведения о настройке других страниц мастера см. в разделе [Создание носителя последовательности задач](../deploy-use/create-task-sequence-media.md).  

6.  На странице **Настройка** укажите следующие данные, затем нажмите кнопку **Далее**.  

    -   Выберите **Включить команду, выполняемую перед запуском**.  

    -   В текстовом поле **Командная строка** введите скрипт или исполняемый файл, созданный для команды перед запуском.  

        > [!IMPORTANT]  
        >  Чтобы указать команду перед запуском, используйте синтаксис **cmd /C <команда_перед_запуском\>**. Например, чтобы указать TSScript.vbs в качестве имени скрипта команды перед запуском, введите в командной строке **cmd /C TSScript.vbs** . Команда **cmd /C** открывает новое окно интерпретатора команд Windows и использует переменную среды Path для поиска скрипта или исполняемого файла команды перед запуском. Также можно указать полный путь к команде перед запуском, но на компьютерах с разными конфигурациями дисков буква диска может отличаться.  

    -   Выберите **Добавить файлы для выполнения команды перед запуском**.  

    -   Нажмите **Set** (Установить), чтобы выбрать пакет, связанный с файлами команды перед запуском.  

    -   Нажмите **Обзор** , чтобы выбрать точку распространения, в которой размещается содержимое для команды перед запуском.  

7.  Завершите работу мастера.  
