---
title: "Встроенные переменные последовательности задач | Документация Майкрософт"
description: "Встроенные переменные последовательности задач содержат сведения о среде, в которой выполняется последовательность задач, и доступны в процессе выполнения всей последовательности задач."
ms.custom: na
ms.date: 03/26/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 02bc6bd4-ca53-4e22-8b80-d8ee5fe72567
caps.latest.revision: "15"
caps.handback.revision: "0"
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.openlocfilehash: 32b24b3637dfafe401ea1d9f51b3769aa749f544
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="task-sequence-built-in-variables-in-system-center-configuration-manager"></a>Встроенные переменные последовательности задач в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*


 Встроенные переменные последовательности задач предоставляются средой System Center Configuration Manager Встроенные переменные содержат данные о среде, в которой выполняется последовательность задач, и их значения доступны на протяжении работы всей последовательности задач. Обычно встроенные переменные инициализируются перед запуском шагов последовательности задач. Например, встроенная переменная **_SMSTSLogPath** является переменной среды, указывающей путь, который может использоваться компонентами Configuration Manager для записи файлов журналов во время выполнения последовательности задач. Эта переменная среды доступна любому шагу последовательности. Однако некоторые переменные, такие как &#95;SMSTSCurrentActionName, определяются перед каждым шагом. Значения встроенных переменных обычно доступные только для чтения. Значения читаются только для встроенных переменных с именем, которое начинается со знака подчеркивания.  

## <a name="task-sequence-built-in-variable-list"></a>Список встроенных переменных последовательности задач  
 В приведенном ниже списке описаны встроенные переменные, которые доступны в Configuration Manager.  

|Имя встроенной переменной|Описание|  
|-----------------------------|-----------------|  
|_OSDDetectedWinDir|Начиная с версии Configuration Manager 1602 при запуске среды предустановки Windows последовательность задач проверяет жесткие диски компьютера на наличие установки предыдущей операционной системы. Расположение папки Windows хранится в этой переменной. Можно настроить последовательность задач таким образом, чтобы это значение получалось из среды и использовалось для указания того же расположения папки Windows при установке новой операционной системы.|  
|_OSDDetectedWinDrive|Начиная с версии Configuration Manager 1602 при запуске среды предустановки Windows последовательность задач проверяет жесткие диски компьютера на наличие установки предыдущей операционной системы.  Расположение на жестком диске, куда устанавливается операционная система, хранится в этой переменной. Можно настроить последовательность задач таким образом, чтобы это значение получалось из среды и использовалось для указания того же расположения на жестком диске для новой операционной системы.|  
|_SMSTSAdvertID|Содержит уникальный идентификатор развертывания текущей выполняемой последовательности задач. Используется тот же формат, что и для идентификатора развертывания распространения программного обеспечения Configuration Manager. Если последовательность задач выполняется с автономного носителя, эта переменная не задается.<br /><br /> Пример.<br /><br /> **ABC20001**|  
|_TSAppInstallStatus|последовательность задач задает переменную _TSAppInstallStatus со значением состояния установки приложения на шаге последовательности задач "Установка приложения". Последовательность задач задает переменной одно из следующих значений:<br /><br /> 1.  **Неопределено**: задается, если шаг последовательности задач "Установить приложение" не был выполнен.<br />2.  **Ошибка**. задается в случае сбоя как минимум одного приложения из-за ошибки на шаге последовательности задач "Установить приложение".<br />3.  **Предупреждение**: задается при отсутствии ошибок на шаге последовательности задач "Установить приложение", но когда не выполнена установка одного или нескольких приложений или необходимой зависимости из-за несоответствия требованиям.<br />4.  **Успешно**: задается при отсутствии ошибок или предупреждений во время выполнения шага последовательности задач "Установить приложение".|  
|_SMSTSBootImageID|Если пакет загрузочного образа связан с текущей выполняемой последовательностью задач, содержит идентификатор пакета загрузочного образа Configuration Manager. При отсутствии связанного пакета загрузочного образа Configuration Manager эта переменная не задается.<br /><br /> Пример:<br /><br /> **ABC00001**|  
|_SMSTSBootUEFI|Последовательность задач задает переменную SMSTSBootUEFI при обнаружении компьютера, находящегося в режиме UEFI.|  
|_SMSTSClientGUID|Содержит значение GUID клиента Configuration Manager. Если последовательность задач выполняется с автономного носителя, эта переменная не задается.<br /><br /> Пример.<br /><br /> **0a1a9a4b-fc56-44f6-b7cd-c3f8ee37c04c**|  
|_SMSTSCurrentActionName|Задает имя текущего выполняемого шага последовательности задач. Эта переменная задается перед запуском диспетчером последовательностей задач каждого из шагов.<br /><br /> Пример.<br /><br /> **выполнить из командной строки**|  
|_SMSTSDownloadOnDemand|Значение **true** (истина) устанавливается, если текущая последовательность задач выполняется в режиме загрузки по требованию. Это означает, что диспетчер последовательности задач загружает содержимое в локальное расположение только тогда, когда требуется доступ к этому содержимому.|  
|_SMSTSInWinPE|Для этой переменной устанавливается значение **true** (истина), если текущий шаг последовательности задач выполняется в среде предустановки Windows, и значение **false** (ложь) в противном случае. Проверив значение этой переменной последовательности задач, можно определить текущую среду операционной системы.|  
|_SMSTSLastActionRetCode|Содержит код возврата, возвращенный последним выполненным действием. Эта переменная может использоваться в качестве условия для определения того, запущен ли следующий шаг.<br /><br /> Пример.<br /><br /> **0**|  
|_SMSTSLastActionSucceeded|Эта переменная принимает значение **true** (истина), если предыдущее действие выполнено успешно, или **false** (ложь), если последнее действие завершилось со сбоем. Если последнее действие было пропущено из-за того, что этот шаг был отключен или связанное с ним условие было принято со значением **false**(ложь), эта переменная не сбрасывается, т. е. она содержит значение для предыдущего действия.|  
|_SMSTSLaunchMode|Задает метод запуска последовательности задач. Последовательность задач может иметь следующие значения:<br /><br /> -   **SMS** — указывает, что последовательность задач запущена с использованием клиента Configuration Manager.<br />-   **UFD** — указывает, что последовательность задач запущена с помощью USB-носителя, и что этот носитель создан в Windows XP или Windows Server 2003.<br />-   **UFD+FORMAT** — указывает, что последовательность задач запущена с помощью USB-носителя, и что этот носитель создан в Windows Vista или более поздней версии.<br />-   **CD** — указывает, что последовательность задач запущена с помощью компакт-диска.<br />-   **DVD** — указывает, что последовательность задач запущена с помощью DVD-диска.<br />-   **PXE** — указывает, что последовательность задач запущена с PXE.<br />-   **HD** — указывает, что последовательность задач была запущена с жесткого диска (только для предварительно подготовленных носителей).|  
|_SMSTSLogPath|Содержит полный путь к папке журнала. Эту переменную можно использовать для определения расположения журнала действий. Если жесткий диск недоступен, это значение не устанавливается.|  
|_SMSTSMachineName|Содержит и указывает имя компьютера. Содержит имя компьютера, который будет использоваться последовательностью задач для регистрации всех сообщений об изменении состояния. Для изменения имени компьютера в новой операционной системе используйте переменную **OSDComputerName** .<br /><br /> Пример.<br /><br /> **ABC**|  
|_SMSTSMDataPath|Задает путь, определенный в переменной SMSTSLocalDataDrive. Если определить переменную SMSTSLocalDataDrive перед запуском последовательности задач, например задав переменную коллекции, то Configuration Manager определит переменную _SMSTSMDataPath в момент запуска последовательности задач.|  
|_SMSTSMediaType|Указывает тип носителя, используемого для инициализации установки. Примерами типов носителя могут быть загрузочный носитель, полный носитель, PXE и предварительно подготовленный носитель.|  
|_SMSTSMP|Содержит URL- или IP-адрес точки управления Configuration Manager.|  
|_SMSTSMPPort|Содержит номер порта точки управления Configuration Manager.<br /><br /> Пример:<br /><br /> **80**|  
|_SMSTSOrgName|Содержит название организации, отображающееся в диалоговом окне пользовательского интерфейса хода выполнения последовательности задач.<br /><br /> Пример.<br /><br /> **Организация АБВ**|  
|_SMSTSOSUpgradeActionReturnCode|Сохраняет значение кода выхода, возвращаемое из программы установки, чтобы указать на успех или неудачу.  Эта переменная задается во время последовательности шага "Обновления операционной системы" последовательности задач. Это удобно использовать с параметром командной строки /Compat программы установки Windows 10.<br /><br /> Пример.<br /><br /> По завершении выполнения /Compat вы можете предпринять соответствующие действия в следующих шагах в зависимости от того, указывает ли код выхода на успех или на ошибку. В случае успешного выполнения вы можете начать обновление. Либо вы можете задать маркер в среде (например, добавить файл или задать раздел реестра), который затем можно использовать для создания коллекции компьютеров, готовых к обновлению или требующих выполнения действий перед обновлением.|  
|_SMSTSPackageID|Содержит идентификатор текущей выполняемой последовательности задач. В этом идентификаторе используется тот же формат, что и в идентификаторе пакета программного обеспечения Configuration Manager.<br /><br /> Пример:<br /><br /> **HJT00001**|  
|_SMSTSPackageName|Содержит имя текущей выполняемой последовательности задач, заданное администратором Configuration Manager при создании последовательности задач.<br /><br /> Пример:<br /><br /> **Последовательность задач развертывания Windows 10**|  
|_SMSTSSetupRollback|Указывает, выполнила ли программа установки операционной системы операцию отката. Переменная может иметь значение **true** или **false**.|  
|_SMSTSRunFromDP|Значение **true** означает, что текущая последовательность задач выполняется в режиме выполнения из точки распространения; т. е. диспетчер последовательностей задач получает требуемые пакеты из точки распространения.|  
|_SMSTSSiteCode|Содержит код сайта Configuration Manager.<br /><br /> Пример:<br /><br /> **ABC**|  
|_SMSTSType|Задает тип текущей выполняемой последовательности задач. Возможны следующие значения:<br /><br /> **1** — означает обычную последовательность задач.<br /><br /> **2** — означает последовательность задач развертывания операционной системы.|  
|_SMSTSTimezone|В переменной _SMSTSTimezone сохраняются данные о часовом поясе в следующем формате (без пробелов):<br /><br /> Bias, StandardBias, DaylightBias, StandardDate.wYear, wMonth, wDayOfWeek, wDay, wHour, wMinute, wSecond, wMilliseconds, DaylightDate.wYear, wMonth, wDayOfWeek, wDay, wHour, wMinute, wSecond, wMilliseconds, StandardName, DaylightName<br /><br /> Пример.<br /><br /> Для Восточного времени (США и Канада) значение будет иметь вид **300,0,-60,0,11,0,1,2,0,0,0,0,3,0,2,2,0,0,0,Eastern Standard Time,Eastern Daylight Time**|  
|_SMSTSUseCRL|Указывает, использует ли последовательность задач список отзыва сертификатов, если для связи с точкой управления используется сертификат SSL.|  
|_SMSTSUserStarted|Указывает, запущена ли последовательность задач пользователем. Эта переменная задается только в том случае, если последовательность задач запускается из центра программного обеспечения. Например, если для переменной **_SMSTSLaunchMode** задано значение **SMS**. Эта переменная может принимать следующие значения:<br /><br /> -   **true** (истина) — указывает, что последовательность задач запущена пользователем вручную из центра программного обеспечения.<br />-   **false** (ложь) — указывает, что последовательность задач запущена автоматически планировщиком Configuration Manager.|  
|_SMSTSUseSSL|Указывает, использует ли последовательность задач протокол SSL для связи с точкой управления Configuration Manager. Если сайт работает в основном режиме, устанавливается значение **true**(истина).|  
|_SMSTSWTG|определяет, работает ли компьютер как устройство Windows To Go.|  
|OSDPreserveDriveLetter|Начиная с версии Configuration Manager 1606 эта переменная последовательности задач является нерекомендуемой. Во время развертывания операционной системы по умолчанию программа установки Windows определяет оптимальную букву диска (обычно диск C:). <br /><br />В предыдущих версиях переменная OSDPreverveDriveLetter определяет, использует ли последовательность задач букву диска, записанную в WIM-файле образа операционной системы, при применении этого образа на целевом компьютере. Вы можете задать для этой переменной значение **False** , чтобы использовать расположение, указанное для параметра **Назначение** на шаге последовательности задач **Применить операционную систему** . Дополнительные сведения см. в разделе [Применение образа операционной системы](task-sequence-steps.md#BKMK_ApplyOperatingSystemImage).|  
|OSDSetupAdditionalUpgradeOptions|Начиная с версии Configuration Manager 1602 с помощью этой переменной можно указывать дополнительные параметры для обновления программы установки Windows.
|SMSTSAssignmentsDownloadInterval|Используйте эту переменную, чтобы указать время ожидания в секундах перед новой попыткой клиента загрузить политику с момента последней попытки, не вернувшей политик. По умолчанию клиент ожидает **0** секунд перед повторной попыткой.<br /><br /> Эту переменную можно установить с помощью команды перед запуском с носителя или посредством PXE.|  
|SMSTSAssignmentsDownloadRetry|Используйте эту переменную, чтобы указать количество попыток загрузки политики, выполняемых клиентом, если политики не были найдены с первой попытки. По умолчанию клиент повторяет попытку **0** раз.<br /><br /> Эту переменную можно установить с помощью команды перед запуском с носителя или посредством PXE.|  
|SMSTSAssignUsersMode|Указывает, как последовательность задач связывает пользователей с конечным компьютером. Присвойте переменной одно из следующих значений.<br /><br /> Автоматически: последовательность задач создает связь между определенными пользователями и конечным компьютером во время развертывания операционной системы на конечный компьютер.<br />Ожидание: последовательность задач создает связь между определенными пользователями и конечным компьютером, но перед применением этой связи ожидает утверждения от пользователя с правами администратора.<br />Отключено: последовательность задач не связывает пользователей с конечным компьютером во время развертывания операционной системы.|  
|SMSTSDownloadAbortCode|Эта переменная содержит значение кода прерывания для загрузчика внешней программы (указанного в переменной SMSTSDownloadProgram). Если программа возвращает код ошибки, равный значению переменной SMSTSDownloadAbortCode, то скачивание содержимого завершается сбоем и попытки выполнить скачивание с помощью других методов не предпринимаются.
|SMSTSDownloadProgram|Используйте эту переменную, чтобы задать для данной последовательности задач альтернативный поставщик содержимого — программу для скачивания содержимого вместо используемой по умолчанию программы скачивания Configuration Manager. Во время загрузки содержимого последовательность задач проверяет, указана ли в этой переменной программа для загрузки. Если программа указана, последовательность задач выполняет программу для загрузки.|  
|SMSTSDownloadRetryCount|Используйте эту переменную для задания числа попыток скачивания содержимого из точки распространения средой Configuration Manager. По умолчанию клиент повторяет попытку **2** раза.|  
|SMSTSDownloadRetryDelay|Используйте эту переменную для задания времени ожидания в секундах перед повторной попыткой скачивания содержимого из точки распространения средой Configuration Manager. По умолчанию клиент ожидает **15** секунд перед повторной попыткой.|  
|SMSTSDriverReceiveTimeOut|Используйте эту переменную, чтобы указать количество секунд до истечения времени ожидания подключения к серверу.|
|SMSTSDriverRequestConnectTimeOut|Используйте эту переменную, чтобы указать число секунд ожидания для подключения к HTTP-серверу при запросе каталога драйверов на этапе последовательности задач автоматического применения драйверов. Если подключение занимает больше времени, чем определено параметром времени ожидания, запрос отменяется. Время ожидания по умолчанию составляет 60 секунд.|  
|SMSTSDriverRequestReceiveTimeOut|Используйте эту переменную, чтобы указать число секунд для ожидания ответа на запрос каталога драйверов на этапе последовательности задач автоматического применения драйверов. Если подключение занимает больше времени, чем определено параметром времени ожидания, запрос отменяется. Время ожидания по умолчанию составляет 480 секунд.|
|SMSTSDriverRequestResolveTimeOut|Используйте эту переменную, чтобы указать число секунд ожидания для разрешения имени HTTP-сервера при запросе каталога драйверов на этапе последовательности задач автоматического применения драйверов. Если подключение занимает больше времени, чем определено параметром времени ожидания, запрос отменяется. Время ожидания по умолчанию составляет 60 секунд.|
|SMSTSDriverRequestSendTimeOut|Используйте эту переменную, чтобы указать число секунд для отправки запроса каталога драйверов на этапе последовательности задач автоматического применения драйверов. Если выполнение запроса занимает больше времени, чем задано параметром времени ожидания, запрос отменяется. Время ожидания по умолчанию составляет 60 секунд.|
|SMSTSErrorDialogTimeout|При возникновении ошибки в последовательности задач отображается диалоговое окно, которое автоматически закрывается через количество секунд, указанных в этой переменной. По умолчанию диалоговое окно автоматически закрывается через **900** секунд (15 минут).|  
| TSDisableProgressUI | Используйте эту переменную, чтобы скрыть или отобразить ход выполнения последовательности задач на разных этапах последовательности задач. | 
|TSErrorOnWarning|Используйте эту переменную, чтобы указать, рассматривает ли подсистема выполнения последовательности задач обнаруженное предупреждение как ошибку во время выполнения шага последовательности задач установки приложения. Эта последовательность задач устанавливает переменную _TSAppInstallStatus в значение **Warning** , если хотя бы одно приложение или требуемая зависимость не устанавливается из-за несоответствия требованиям. Если переменная TSErrorOnWarning имеет значение **True** , а переменная _TSAppInstallStatus устанавливается в значение Warning, то предупреждение рассматривается как ошибка. Значение **False** задает поведение по умолчанию.| 
|SMSTSLanguageFolder|С помощью этой переменной можно изменять язык отображения информации в загрузочных образах, не зависящих от языка.|  
|SMSTSLocalDataDrive|Указывает место хранения временных файлов на целевом компьютере при выполнении последовательности задач.<br /><br /> Эта переменная должна быть задана перед запуском последовательности задач, например посредством задания переменной коллекции. Configuration Manager определяет переменную _SMSTSMDataPath после запуска последовательности задач.|  
|SMSTSMP|Используйте эту переменную, чтобы указать URL- или IP-адрес точки управления Configuration Manager.|  
|SMSTSMPListRequestTimeout|Используйте эту переменную, чтобы указать для последовательности задач время ожидания в миллисекундах перед повторной попыткой установки приложения или обновления ПО после сбоя при получении списка точек управления из служб определения местоположения. По умолчанию последовательность задач ожидает 60 000 миллисекунд (60 секунд), прежде чем повторяет этот шаг, и может выполнять до трех повторных попыток. Эта переменная применима только к шагам последовательности задач "Установка приложения" и "Установка обновлений программного обеспечения".|  
|SMSTSMPListRequestTimeoutEnabled|Используйте эту переменную для включения повторных запросов MPList, чтобы обновить клиент, если он находится не в интрасети. <br />По умолчанию переменной задано значение True. Когда клиенты в Интернете, этой переменной можно задать значение False, чтобы избежать ненужных задержек. Эта переменная применима только к шагам последовательности задач "Установка приложения" и "Установка обновлений программного обеспечения".|  
|SMSTSPeerDownload|Используйте эту переменную, чтобы позволить клиенту использовать одноранговый кэш Windows PE.<br /><br /> Пример.<br /><br /> SMSTSPeerDownload = **TRUE** активирует эту функцию.|  
|SMSTSPeerRequestPort|Используйте эту переменную для однорангового кэша Windows PE, чтобы указать пользовательское значение сетевого порта, который будет применяться для начального вещания, когда не используются порты по умолчанию (8004), настроенные в параметрах клиента.|  
|SMSTSPersistContent|С помощью этой переменной можно временно хранить содержимое в кэше последовательности задач.|  
|SMSTSPostAction|Задает команду, которая выполняется после завершения последовательности задач. Например, вы можете использовать эту переменную для указания скрипта, который включает фильтры записи на встраиваемых устройствах после того, как последовательность задач развернет операционную систему на устройстве.|  
|SMSTSPreferredAdvertID|Принудительно запускает на конечном компьютере определенное целевое развертывание. Эта переменная может быть задана с помощью команды перед запуском с носителя или посредством PXE. Если эта переменная задана, последовательность задач переопределяет все обязательные развертывания.|  
|SMSTSPreserveContent|Эта переменная указывает, что содержимое в последовательности задач должно храниться в кэше клиента Configuration Manager после развертывания. Это отличается от случая с применением переменной SMSTSPersistContent, которая сохраняет содержимое лишь на время выполнения последовательности задач и использует кэш последовательности задач, а не кэш клиента Configuration Manager.<br /><br /> Пример:<br /><br /> SMSTSPreserveContent = **TRUE** активирует эту функцию.|  
|SMSTSRebootDelay|Задает время ожидания в секундах перед перезагрузкой компьютера. Если значение этой переменной отличается от 0, перед перезагрузкой компьютера диспетчер последовательности задач отображается диалоговое окно с предупреждением.<br /><br /> Примеры:<br /><br /> **0**<br /><br /> **30**|  
|SMSTSRebootMessage|Задает сообщение, отображаемое в диалоговом окне выключения при запросе перезагрузки. Если эта переменная не задана, отображается сообщение по умолчанию.<br /><br /> Пример.<br /><br /> **Этот компьютер перезагружается диспетчером последовательностей задач**.|  
|SMSTSRebootRequested|Указывает, что после выполнения текущего шага последовательности задач требуется перезагрузка. Если требуется перезагрузка, просто установите для этой переменной значение **true**(истина), и диспетчер последовательностей задач перезагрузит компьютер после этого шага последовательности задач. Шаг должен присвоить значение этой переменной последовательности задач, если для завершения его выполнения требуется перезагрузка. После перезагрузки компьютера выполнение последовательности задач продолжится со следующего шага.|  
|SMSTSRetryRequested|Запрашивает повторную попытку после завершения текущего шага последовательности задач. Если установлена эта переменная последовательности задач, для параметра **SMSTSRebootRequested** также должно быть задано значение **true**(истина). После перезагрузки компьютера диспетчер последовательности задач вернется к тому же шагу последовательности задач.|  
|SMSTSSoftwareUpdateScanTimeout| Дает возможность управлять временем ожидания для проверки обновлений программного обеспечения во время шага последовательности задач [Установить обновления программного обеспечения](task-sequence-steps.md#BKMK_InstallSoftwareUpdates). Например, можно увеличить значение по умолчанию, если требуется установить много обновлений программного обеспечения. Значение по умолчанию — 30 минут. |
|SMSTSUDAUsers|указывает основного пользователя конечного компьютера. Укажите пользователей, используя следующий формат. Разделите нескольких пользователей с помощью запятой (,).<br /><br /> Пример.<br /><br /> **домен\пользователь1, домен\пользователь2, домен\пользователь3**<br /><br /> Дополнительные сведения о связывании пользователей с конечным компьютером см. в разделе [Связывание пользователей с конечным компьютером](../get-started/associate-users-with-a-destination-computer.md).|  
|SMSTSWaitForSecondReboot|Начиная с версии Configuration Manager 1602 эта дополнительная переменная последовательности задач может использоваться для управления поведением клиента, когда для установки обновления программного обеспечения требуются две перезагрузки. Эту переменную необходимо задать перед шагом [Установить обновления программного обеспечения](task-sequence-steps.md#BKMK_InstallSoftwareUpdates), чтобы предотвратить сбой последовательности задач из-за второй перезагрузки при установке обновления программного обеспечения.<br /><br /> Задайте значение SMSTSWaitForSecondReboot в секундах, чтобы указать продолжительность приостановки последовательности задач на этапе установки обновлений программного обеспечения при перезагрузке компьютера; это позволит обеспечить достаточный интервал в случае второй перезагрузки. <br />Например, если для SMSTSWaitForSecondReboot задать значение 600, то последовательность задач будет приостанавливаться на 10 минут после перезагрузки и до выполнения дополнительных шагов последовательности задач. Это полезно, когда в рамках одного шага последовательности задач устанавливаются сотни обновлений программного обеспечения.|  
