---
title: "Шаги последовательности задач в Configuration Manager | Документация Майкрософт"
description: "Сведения о шагах последовательности задач, которые можно добавить в последовательность задач Configuration Manager."
ms.custom: na
ms.date: 03/26/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 7c888a6f-8e37-4be5-8edb-832b218f266d
caps.latest.revision: "26"
caps.handback.revision: "0"
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.openlocfilehash: e0726febc4c36a26c5e067914734838bf2681e6c
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="task-sequence-steps-in-system-center-configuration-manager"></a>Шаги последовательности задач в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Следующие шаги последовательности задач, которые можно добавить в последовательность задач Configuration Manager. Дополнительные сведения о редактировании последовательности задач см. в статье [Изменение последовательности задач](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ModifyTaskSequence).  


##  <a name="BKMK_ApplyDataImage"></a> Шаг последовательности задач "Применить образ данных"  
 Шаг последовательности задач **Применить образ данных** используется для копирования образа данных в указанное конечное расположение.  

 Этот шаг выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в статье [Переменные действия последовательности задач](task-sequence-action-variables.md).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет образа**  
 Используя кнопку **Обзор** , укажите **пакет образа**, который будет использоваться этим шагом последовательности задач. В диалоговом окне **Выбор пакета** выберите пакет для установки. Сведения о свойствах для существующих пакетов образов отображаются внизу диалогового окна **Выбор пакета** . Выбрав **пакет образа** , в раскрывающемся списке выберите **образ**, который требуется установить.  

> [!NOTE]  
>  Это действие последовательности задач обрабатывает образ как файл данных и не выполняет никаких настроек, необходимых для загрузки образа в виде операционной системы.  

 **Назначение**  
 Существующий форматированный раздел и жесткий диск, определенная буква логического диска или имя переменной последовательности задач, содержащее букву логического диска.  

-   **Следующий доступный раздел** — используйте следующий по порядку раздел, который использовался в качестве целевого действием "Применить операционную систему" или "Применить образ данных" в этой последовательности задач.  

-   **Конкретный диск и раздел** — выберите номер **диска** (начиная с 0) и номер **раздела** (начиная с 1).  

-   **Конкретный логический диск** — укажите **букву диска**, назначенную разделу средой предустановки Windows. Учтите, что эта буква диска может отличаться от буквы диска, которая будет назначена новой развернутой операционной системой.  

-   **Имя логического диска хранится в виде переменной** — укажите переменную последовательности задач, которая содержит букву диска, назначенную разделу средой предустановки Windows. Эта переменная, как правило, задается в разделе "Дополнительно" диалогового окна **Свойства раздела** действия последовательности задач **Отформатировать диск и создать разделы**  

 **Удалить все содержимое раздела перед применением образа**  
 Все файлы в целевом разделе будут удалены перед установкой образа. Если удалять содержимое раздела не требуется, этот шаг можно использовать для применения дополнительного содержимого к разделу, который ранее был выбран в качестве целевого.  

##  <a name="BKMK_ApplyDriverPackage"></a> Применить пакет драйверов  
 Шаг последовательности задач **Применить пакет драйверов** используется для загрузки всех драйверов в пакете драйверов и их установки в операционной системе Windows.

 Шаг последовательности задач **Применить пакет драйверов** предоставляет операционной системе Windows доступ ко всем драйверам устройств в пакете драйверов. Этот шаг можно добавить в последовательность задач между шагами **Применить операционную систему**  и **Настройка Windows и Configuration Manager** , чтобы предоставить операционной системе Windows доступ ко всем драйверам устройств в пакете драйверов. Как правило, шаг **Примерить пакет драйверов** помещается в последовательность задач после шага **Автоматическое применение драйверов** . Шаг последовательности задач **Применить пакет драйверов** также можно использовать в сценариях развертывания с помощью автономного носителя.  

 Сходные драйверы устройств необходимо поместить в пакет драйверов и передать их на соответствующие точки распространения. После того как драйверы будут переданы, клиентские компьютеры Configuration Manager смогут их устанавливать. Например, можно поместить все драйверы устройств одного производителя в пакет драйверов, а затем передать пакет на точки распространения, где связанные компьютеры смогут получить к ним доступ.

 Этот шаг можно использовать для развертываний с автономного носителя, чтобы установить определенный набор драйверов, включая драйверы для устройств, которые не удается обнаружить при поиске самонастраивающихся устройств (например, сетевых принтеров).  

 Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Применить пакет драйверов"](task-sequence-action-variables.md#BKMK_ApplyDriverPackage).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет драйвера**  
 Укажите пакет драйверов, который содержит необходимые драйверы устройств, нажав кнопку **Обзор** и запустив диалоговое окно **Выбор пакета** . Укажите существующий пакет, который необходимо сделать доступным. Свойства для этого пакета отображаются внизу диалогового окна.  

 **В пакете выберите драйвер запоминающего устройства, который необходимо установить перед запуском программы установки в операционных системах, предшествующих Windows Vista**  
 Укажите драйверы запоминающих устройств, которые требуются для установки операционных систем, предшествующих Windows Vista.  

 **Драйвер**  
 Выберите файл драйвера запоминающего устройства для установки перед запуском программы установки в развертываниях операционных систем, предшествующих Windows Vista. Раскрывающийся список заполняется из указанного пакета.  

 **Модель**  
 Укажите важный для загрузки драйвер устройства, который необходим для развертываний операционных систем, предшествующих Windows Vista.  

 **Автоматически устанавливать неподписанные драйверы для всех версий Windows, если это возможно**  
 Установите этот флажок, чтобы разрешить операционной системе Windows устанавливать драйверы, не подписанные на эталонном компьютере.  

##  <a name="BKMK_ApplyNetworkSettings"></a> Применить параметры сети  
 Шаг последовательности задач **Применить параметры сети** используется для того, чтобы указать сведения о конфигурации сети или рабочей группы для конечного компьютера. Указанные значения хранятся в соответствующем файле ответов, который используется программой установки Windows при выполнении шага последовательности задач **Настройка Windows и Configuration Manager** .  

 Этот шаг последовательности задач выполняется в стандартной операционной системе или в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Применить параметры сети"](task-sequence-action-variables.md#BKMK_ApplyNetworkSettings).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Присоединить к рабочей группе**  
 Выберите этот параметр, чтобы присоединить конечный компьютер к указанной рабочей группе. Введите имя рабочей группы в строке **Рабочая группа** . Это значение может быть переопределено значением, записанным шагом последовательности задач **Сохранить параметры сети** .  

 **Присоединить к домену**  
 Выберите этот параметр, чтобы присоединить конечный компьютер к указанному домену. Укажите или выберите домен, например *fabricam.com*. Укажите или выберите LDAP-путь к подразделению (например, LDAP//OU=computers, DC=Fabricam.com, C=com).  

 **Учетная запись**  
 Нажмите кнопку **Задать** , чтобы указать учетную запись с необходимыми разрешениями для присоединения компьютера к домену. В диалоговом окне **Учетная запись пользователя Windows** вы можете ввести имя пользователя, используя следующий формат: **домен\пользователь** .  

 **Параметры адаптера**  
 Укажите конфигурации сети для каждого сетевого адаптера на компьютере. Нажмите кнопку **Создать** , чтобы открыть диалоговое окно **Параметры сети** , затем укажите параметры сети. Если параметры сети были записаны при выполнении предыдущего шага последовательности задач **Сохранить параметры сети** , предыдущие параметры применяются к сетевому адаптеру вместо параметров, указанных в этом шаге. Если параметры сети записаны не были, параметры, указанные в шаге **Применить параметры сети** , применяются к сетевым адаптерам в порядке перечисления устройств Windows.  

##  <a name="BKMK_ApplyOperatingSystemImage"></a> Применить образ операционной системы  
 Шаг последовательности задач **Применить образ операционной системы** используется для установки операционной системы на конечный компьютер. Этот шаг последовательности задач выполняет набор действий в зависимости от того, используется ли для установки операционной системы образ или пакет установки.  

 При использовании образа операционной системы шаг **Применить образ операционной системы** выполняет следующие действия.  

1.  Удаляет все содержимое на целевом томе за исключением файлов в папке, указанной в переменной последовательности задач &#95;SMSTSUserStatePath.  

2.  Извлекает содержимое указанного WIM-файла в заданный конечный раздел.  

3.  Подготавливает файл ответов:  

    1.  создает новый файл ответов программы установки Windows по умолчанию (sysprep.inf или unattend.xml) для развертываемой операционной системы;  

    2.  добавляет все значения из файла ответов, предоставленного пользователем.  

4.  Копирует загрузчики Windows в активный раздел.  

5.  Задает файл boot.ini или базу данных конфигурации загрузки (BCD), которые ссылаются на новую установленную операционную систему.  

 При использовании пакета установки операционной системы шаг **Применить образ операционной системы** выполняет следующие действия.  

1.  Удаляет все содержимое на целевом томе за исключением файлов в папке, указанной в переменной последовательности задач &#95;SMSTSUserStatePath.  

2.  Подготавливает файл ответов:  

    1.  создает новый файл ответов со стандартными значениями, созданными Configuration Manager;  

    2.  добавляет все значения из файла ответов, предоставленного пользователем.  

> [!NOTE]  
>  Фактическая установка Windows запускается шагом последовательности задач **Настройка Windows и Configuration Manager** . После выполнения действия последовательности задачи **Применить операционную систему** переменной последовательности задачи OSDTargetSystemDrive присваивается буква диска раздела, содержащего файлы операционной системы.  

 Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Применить образ операционной системы"](task-sequence-action-variables.md#BKMK_ApplyOperatingSystem).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   **Доступ к содержимому непосредственно из точки распространения**:  

     используйте этот параметр, чтобы указать, должна ли последовательность задач иметь доступ к образу операционной системы непосредственно из точки распространения. Например, можно использовать этот параметр при развертывании операционных систем на встроенных устройствах, которые имеют ограниченный объем хранилища. При выборе этого параметра вы должны также настроить параметры общей папки пакета на вкладке **Доступ к данным** свойств пакета.  

    > [!NOTE]  
    >  Этот параметр переопределяет параметр развертывания, который настраивается на странице **Точки распространения** в **мастере развертывания программного обеспечения** , только для образа операционной системы, указанного в этом шаге последовательности задач, а не во всем содержимом всей последовательности задач.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Применить образ операционной системы**  
 Установка ранее записанного образа операционной системы. Нажмите кнопку **Обзор** , чтобы открыть диалоговое окно **Выбор пакета** , а затем выберите существующий пакет для установки. Если с выбранным **пакетом образа**связано несколько образов, в раскрывающемся списке выберите нужный образ, который будет использоваться для этого развертывания. Щелкнув образ, можно просмотреть основные сведения о нем.  

 **Применить операционную систему из дистрибутива установки**  
 Установка операционной системы с помощью дистрибутива установки. Нажмите кнопку **Обзор** , чтобы открыть диалоговое окно **Выбрать пакет установки операционной системы** , а затем выберите существующий пакет для установки. Щелкнув источник образа, можно просмотреть основные сведения о нем. Связанные свойства источника образа отображаются в области результатов внизу диалогового окна. Если с выбранным пакетом связано несколько выпусков, в раскрывающемся списке выберите нужный **выпуск** .  

 **Использовать файл ответов автоматической установки или файл ответов Sysprep для заранее настроенной установки**  
 Установите этот флажок, чтобы указать файл ответов программы установки Windows (**unattend.xml**, **unattend.txt**или **sysprep.inf**) в зависимости от версии операционной системы и метода установки. Указываемый файл может включать любые стандартные параметры конфигурации, поддерживаемые файлами ответов Windows. Например, его можно использовать, чтобы указать домашнюю страницу Internet Explorer по умолчанию. Необходимо указать пакет, содержащий файл ответов и связанный путь к файлу в пакете.  

> [!NOTE]  
>  Предоставляемый файл ответов программы установки может содержать встроенные переменные последовательности задач в форме %*varname*%, varname — это имя переменной. Строка %*varname*% будет заменена фактическим значением переменной в действии последовательности задач **Настройка Windows и Configuration Manager** . Однако следует учесть, что такие встроенные переменные последовательности задач нельзя использовать в полях, содержащих только числовые значения, в файле ответов unattend.xml.  

 Если не указать файл ответов программы установки Windows, это действие последовательности задач создаст файл ответов автоматически.  

 **Назначение**  
 Существующий форматированный раздел и жесткий диск, определенная буква логического диска или имя переменной последовательности задач, содержащее букву логического диска.  

-   **Следующий доступный раздел** — используйте следующий по порядку раздел, который использовался в качестве целевого действием "Применить операционную систему" или "Применить образ данных" в этой последовательности задач.  

-   **Конкретный диск и раздел** — выберите номер **диска** (начиная с 0) и номер **раздела** (начиная с 1).  

-   **Конкретный логический диск** — укажите **букву диска**, назначенную разделу средой предустановки Windows. Учтите, что эта буква диска может отличаться от буквы диска, которая будет назначена новой развернутой операционной системой.  

-   **Имя логического диска хранится в виде переменной** — укажите переменную последовательности задач, которая содержит букву диска, назначенную разделу средой предустановки Windows. Эта переменная, как правило, задается в разделе "Дополнительно" диалогового окна **Свойства раздела** действия последовательности задач **Отформатировать диск и создать разделы**  

##  <a name="BKMK_ApplyWindowsSettings"></a> Применить настройки Windows  
 Шаг **Применить настройки Windows** используется для настройки параметров Windows для конечного компьютера. Указанные значения хранятся в соответствующем файле ответов, который используется программой установки Windows при выполнении шага последовательности задач **Настройка Windows и Configuration Manager** .  

 Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Применить настройки Windows"](task-sequence-action-variables.md#BKMK_ApplyWindowsSettings).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Краткое, определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Имя пользователя**  
 Укажите имя зарегистрированного пользователя, который связан с компьютером назначения. Это значение может быть переопределено значением, записанным действием шага последовательности задач **Сохранить параметры Windows** .  

 **Название организации**  
 Укажите зарегистрированное название организации, которая связана с компьютером назначения. Это значение может быть переопределено значением, записанным действием шага последовательности задач **Сохранить параметры Windows** .  

 **Ключ продукта**  
 Укажите ключ продукта, используемый для установки Windows на конечном компьютере.  

 **Лицензирование сервера**  
 Выбор режима лицензирования сервера. В качестве режима лицензирования можно выбрать **Для каждого сервера** или **Для пользователя** . Если выбрать режим лицензирования "Для каждого сервера", потребуется также указать максимальное число подключений, разрешенных в рамках лицензионного соглашения. Выберите вариант **Не указывать** , если конечный компьютер не является сервером или не требуется указывать режим лицензирования.  

 **Максимальное количество соединений**  
 Укажите максимальное количество подключений, доступных для этого компьютера, как указано в лицензионном соглашении.  

 **Задать пароль локального администратора случайным образом и отключить учетную запись локального администратора на всех поддерживаемых платформах (рекомендуется)**  
 Установите этот переключатель, чтобы создать случайный пароль локального администратора. При этом создается пароль локального администратора и учетная запись отключается в поддерживаемых платформах.  

 **Включить учетную запись локального администратора и задать пароль**  
 Установите этот переключатель, чтобы включить учетную запись администратора и создать пароль локального администратора. Введите пароль в строке **Пароль** и подтвердите его в строке **Подтверждение пароля** .  

 **Часовой пояс**  
 Укажите часовой пояс для настройки на конечном компьютере. Это значение может быть переопределено значением, записанным шагом последовательности задач **Сохранить параметры Windows** .  

##  <a name="BKMK_AutoApplyDrivers"></a> Автоматическое применение драйверов  
 Шаг последовательности задач **Автоматическое применение драйверов** используется для поиска соответствующих драйверов и их установки в составе развертывания операционной системы.  

 Шаг последовательности задач **Автоматическое применение драйверов** выполняет следующие действия.  

1.  Проверяет оборудование и находит идентификаторы самонастраивающихся устройств для всех устройств в системе.  

2.  Отправляет список устройств и идентификаторов самонастраивающихся устройств на точку управления. Для каждого устройства точка управления возвращает список совместимых драйверов из каталога драйверов. Точка управления учитывает все драйверы независимо от того, в каком пакете драйверов они находятся. Учитываются только те драйверы, которые помечены как драйверы определенной категории, и драйверы, не помеченные как отключенные.  

3.  Для каждого устройства клиент выбирает лучший драйвер, подходящий для развертываемой операционной системы, который находится на доступной точке распространения.  

4.  Выбранный драйвер или драйверы загружаются с точки распространения и передаются на промежуточное хранение в целевую операционную систему.  

    1.  Для установок на основе образов драйверы помещаются в хранилище драйверов операционной системы.  

    2.  Для установок с использованием программы установки Windows программа установки получает инструкцию о том, где искать драйверы.  

5.  При запуске действия последовательности задач **Настройка Windows и Configuration Manager** и первой загрузке Windows операционная система находит драйверы, сохраненные этим действием.  

> [!IMPORTANT]
>  Шаг последовательности задач **Автоматическое применение драйверов** нельзя использовать при развертывании с автономных носителей, так как программа установки Windows не сможет подключиться к сайту Configuration Manager.

Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Автоматическое применение драйверов"](task-sequence-action-variables.md#BKMK_AutoApplyDrivers).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Устанавливать только наиболее подходящие, совместимые драйверы**  
 Шаг последовательности задач будет устанавливать для каждого обнаруженного устройства только наиболее подходящие драйверы.  

 **Установить все совместимые драйверы**  
 Шаг последовательности задач будет устанавливать все совместимые драйверы для всех обнаруженных устройств. Программа установки сможет самостоятельно выбрать оптимальные драйверы. Этот вариант требует больше пропускной способности сети и места на диске, так как загружается большее количество драйверов, однако он позволяет выбрать наиболее подходящие драйверы.  

 **Использовать драйверы всех категорий**  
 Действие последовательности задач будет выполнять поиск всех доступных категорий драйверов для подходящих драйверов устройств.  

 **Использовать драйверы только из указанных категорий**  
 Действие последовательности задач будет выполнять поиск драйверов устройств в определенных категориях драйверов для подходящих драйверов устройств.  

 **Автоматически устанавливать неподписанные драйверы для всех версий Windows, если это возможно**  
 Действие последовательности задач сможет устанавливать неподписанные драйверы устройств Windows.  

> [!IMPORTANT]  
>  Этот параметр не применяется к операционным системам, в которых нельзя настроить политику подписывания драйверов.  

##  <a name="BKMK_CaptureNetworkSettings"></a> Сохранить параметры сети  
 Шаг последовательности задач **Сохранить параметры сети** используется для записи параметров сети (Майкрософт) с компьютера, на котором выполняется последовательность задач. Параметры сохраняются в переменных последовательности задач, которые переопределяют параметры по умолчанию, настроенные в шаге последовательности задач **Применить параметры сети** .  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Сохранить параметры сети"](task-sequence-action-variables.md#BKMK_CaptureNetworkSettings).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Перенести членство в домене или рабочей группе**  
 Запись сведений о членстве конечного компьютера в домене или рабочей группе.  

 **Перенести настройки сетевого адаптера**  
 Запись конфигурации сетевого адаптера конечного компьютера. Записанные сведения включают глобальные сетевые параметры, число адаптеров и параметры сети, связанные с каждым адаптером. Эти параметры включают параметры, связанные с DNS, WINS, IP и фильтрами портов.  

##  <a name="BKMK_CaptureOperatingSystemImage"></a> Записать образ операционной системы  
 Шаг последовательности задач **Записать образ операционной системы** используется для записи одного или нескольких образов с эталонного компьютера. Затем эти образы сохраняются в WIM-файл в указанной сетевой папке. После этого с помощью мастера добавления пакета образа операционной системы можно импортировать этот WIM-файл в Configuration Manager и использовать его для развертываний операционных систем на основе образов.  

 Каждый том (диск) эталонного компьютера записывается в виде отдельного образа в WIM-файле. Если эталонный компьютер включает несколько томов, получившийся WIM-файл будет содержать отдельный образ для каждого тома. Поддерживается запись только томов с файловыми системами NTFS или FAT32. Тома с другими форматами файловых систем и тома USB пропускаются.  

 Версия Windows установленной на эталонном компьютере операционной системы должна поддерживаться Configuration Manager. Кроме того, ОС необходимо подготовить с помощью средства SysPrep. В качестве тома установки операционной системы и загрузочного тома должен использоваться один и тот же том.  

 Кроме того, необходимо указать учетную запись Windows, имеющую права на запись в выбранную сетевую папку.  

 Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Записать образ операционной системы"](task-sequence-action-variables.md#BKMK_CaptureOperatingSystemImage).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Целевой объект**  
 Путь в формате файловой системы к расположению, которое используется Configuration Manager для хранения записанного образа операционной системы.  

 **Описание**  
 Необязательное, задаваемое пользователем описание записанного образа операционной системы, сохраненного в WIM-файле.  

 **Версия**  
 Необязательный, задаваемый пользователем номер версии, который назначается записанному образу операционной системы. Это значение может быть любым сочетанием букв и цифр; оно сохраняется в WIM-файле.  

 **Кем создано**  
 Необязательное имя пользователя, создавшего образ операционной системы (оно сохраняется в WIM-файле).  

 **Учетная запись для записи образа операционной системы**  
 Укажите учетную запись Windows, имеющую разрешения на запись в указанную сетевую папку. Нажмите кнопку **Задать** , чтобы указать имя этой учетной записи Windows.  

##  <a name="BKMK_CaptureUserState"></a> Записать пользовательское состояние  
 Шаг последовательности задач **Записать пользовательское состояние** используется для запуска средства миграции пользовательской среды (USMT), которое сохраняет данные пользовательской среды и параметры компьютера, на котором выполняется последовательность задач. Этот шаг последовательности задач используется вместе с шагом **Восстановить пользовательское состояние** . При использовании средства USMT 3.0.1 или более поздней версии всегда выполняется шифрование хранилища состояний USMT с помощью ключа шифрования, созданного и управляемого Configuration Manager.  

 Дополнительные сведения об управлении состоянием пользователей при развертывании операционных систем см. в разделе [Управление пользовательской средой](../get-started/manage-user-state.md).  

 Шаг последовательности задач **Записать пользовательское состояние** также можно использовать вместе с шагами **Запросить хранилище состояний** и **Освободить хранилище состояний**, если требуется сохранить параметры состояния в точке миграции состояния сайта Configuration Manager или восстановить их из этой точки.  

 Шаг **Записать пользовательское состояние** последовательности задач позволяет управлять ограниченным набором наиболее широко используемых параметров USMT. Дополнительные параметры командной строки можно указать с помощью переменной последовательности задач OSDMigrateAdditionalCaptureOptions.  

 Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Записать пользовательское состояние"](task-sequence-action-variables.md#BKMK_CaptureUserState).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет средств миграции пользовательской среды**  
 Укажите для этого шага последовательности задач пакет Configuration Manager, содержащий версию средства USMT, которая будет использоваться при записи пользовательской среды и параметров. Для этого пакета не требуется программа. При выполнении шага последовательности задач используется версия USMT в указанном пакете. Укажите пакет, который содержит 32- или 64-разрядную версию USMT в зависимости от архитектуры операционной системы, из которой записывается состояние.  

 **Захватить все профили пользователей, используя стандартные параметры**  
 Выберите этот параметр, чтобы перенести все данные профиля пользователя. Этот параметр установлен по умолчанию.  

 Если выбрать этот параметр, не установив флажок "Восстановить профили локальных пользователей компьютера" в шаге последовательности задач "Восстановить пользовательское состояние", произойдет сбой последовательности задач, поскольку Configuration Manager не может переносить новые учетные записи, не назначая им пароли. Кроме того, если с помощью мастера **создания последовательности задач** создать последовательность задач **Установить существующий образ**, получившаяся последовательность задач по умолчанию выполнит шаг "Захватить все профили пользователей, используя стандартные параметры", но не установит флажок "Восстановить профили локальных пользователей компьютера" (например, учетных записей, не принадлежащих к домену).  

 Установите флажок **Восстановить профили локальных пользователей компьютера** и укажите пароль для переносимой учетной записи. Если используется последовательность задач, созданная вручную, этот параметр находится в шаге "Восстановить пользовательское состояние". В последовательности задач, созданной с помощью мастера **создания последовательности задач** , этот параметр находится в шаге **Восстановить файлы и параметры пользователя** страницы мастера.  

 Если локальные учетные записи пользователей отсутствуют, этот параметр не применяется.  

 **Настройка захвата профилей пользователей**  
 Установите этот флажок, чтобы задать перенос файла профиля пользователя. Нажмите кнопку **Файлы** , чтобы выбрать файлы конфигурации, которые средство миграции пользовательской среды будет использовать для этого шага. Необходимо указать настраиваемый XML-файл, содержащий правила, которые определяют набор переносимых файлов пользовательской среды.  

 **Щелкните здесь, чтобы выбрать файлы конфигурации:**  
 Щелкните эту ссылку, что выбрать файлы конфигурации в USMT-пакете, которые будут использоваться для записи профилей пользователей. Нажмите кнопку **Файлы** , чтобы открыть диалоговое окно **Файлы конфигурации** . Чтобы указать файл конфигурации, введите имя файла в строку **Имя файла** и нажмите кнопку **Добавить** .  

 **Включить подробное ведение журнала**  
 Включите этот параметр, чтобы сформировать более подробные сведения о файле журнала. При записи состояния создается журнал Scanstate.log, который по умолчанию сохраняется в папку журналов последовательности задач в папке \windows\system32\ccm\logs.  

 **Пропустить файлы, использующие шифрованную файловую систему**  
 Этот параметр позволяет пропускать запись файлов, зашифрованных с помощью шифрованной файловой системы (EFS), включая файлы профиля. В зависимости от операционной системы и версии средства миграции пользовательской среды зашифрованные файлы могут стать нечитаемыми после их восстановления. Дополнительные сведения см. в документации средства миграции пользовательской среды.  

 **Скопировать, используя доступ к файловой системе**  
 Установите этот флажок, чтобы указать любой из следующих параметров.  

-   **Продолжать при невозможности захвата некоторых файлов**: включите этот параметр, чтобы продолжить процесс миграции, даже если не удается записать некоторые файлы. Если отключить этот параметр, выполнение завершится сбоем, если не удастся записать какой-либо файл. Этот параметр по умолчанию включен.  

-   **Захватить локально, используя ссылки (hardlink), а не копируя файлы**: включите этот параметр, чтобы использовать жесткие связи NTFS для записи файлов.  

     Дополнительные сведения о миграции данных с помощью жестких связей см. в статье [Хранилище миграции с жесткой связью](http://go.microsoft.com/fwlink/p/?LinkId=240222)  

-   **Выполнить захват в автономном режиме (только в ОС Windows PE)**: включите этот параметр, чтобы собрать данные о пользовательской среде из среды предустановки Windows, а не из полнофункциональной операционной системы.  

 **Захватить, используя службу VSS**  
 Этот параметр позволяет записывать файлы, даже если они заблокированы для редактирования другим приложением.  

##  <a name="BKMK_CaptureWindowsSettings"></a> Сохранить параметры Windows  
 Шаг последовательности задач **Сохранить параметры Windows** используется для записи параметров Windows с компьютера, на котором выполняется последовательность задач. Параметры сохраняются в переменных последовательности задач, которые переопределяют параметры по умолчанию, настроенные в шаге последовательности задач **Применить настройки Windows** .  

 Этот шаг последовательности задач выполняется в стандартной операционной системе или в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Сохранить параметры Windows"](task-sequence-action-variables.md#BKMK_CaptureWindowsSettings).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Перенести имя компьютера**  
 Этот параметр используется для записи имени NetBIOS компьютера.  

 **Перенести имя зарегистр. пользователя и название организации**  
 Этот параметр служит для записи зарегистрированных имен пользователей и названий организации с компьютера.  

 **Перенести часовой пояс**  
 Этот параметр используется для записи параметра часового пояса на компьютере.  

##  <a name="BKMK_CheckReadiness"></a> Проверить готовность  
 Чтобы убедиться, что целевой компьютер соответствует указанным необходимым условиям развертывания, используйте шаг последовательности задач **Проверка готовности** .  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге. Для данного шага не выбирайте этот параметр, иначе шаг будет регистрировать в журнале только проверки готовности и не остановит последовательность задач, если проверка завершается неудачно.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Обеспечить минимальный объем памяти (МБ)**  
 Выберите этот параметр, чтобы убедиться, что объем памяти в мегабайтах, установленный на целевом компьютере, соответствует указанному объему или превышает его. По умолчанию этот параметр выбран.  

 **Обеспечить минимальную скорость процессора (МГц)**  
 Выберите этот параметр, чтобы убедиться, что скорость процессора в мегагерцах (МГц), установленного на целевом компьютере, соответствует заданному значению или превышает его. По умолчанию этот параметр выбран.  

 **Обеспечить минимальное свободное место на диске (МБ)**  
 Выберите этот параметр, чтобы убедиться, что объем свободного дискового пространства в мегабайтах на целевом компьютере соответствует заданному объему или превышает его.  

 **Проверить, что текущая операционная система для обновления**  
 Выберите этот параметр, чтобы убедиться, что операционная система, установленная на целевом компьютере, соответствует заданному вами требованию. По умолчанию этот параметр выбран со значением **КЛИЕНТ**.  

##  <a name="BKMK_ConnectToNetworkFolder"></a> Подключить к сетевой папке  
 Действие последовательности задач **Подключить к сетевой папке** используется для создания подключения к общей сетевой папке.  

 Этот шаг последовательности задач выполняется в стандартной операционной системе или в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Подключить к сетевой папке"](task-sequence-action-variables.md#BKMK_ConnecttoNetworkFolder).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

##  <a name="BKMK_ConvertDisktoDynamic"></a> Преобразовать диск в динамический диск  
 Шаг последовательности задач **Преобразовать диск в динамический диск** используется для преобразования физического диска базового типа в динамический диск.  

 Этот шаг последовательности задач выполняется в стандартной операционной системе или в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Преобразовать диск в динамический диск"](task-sequence-action-variables.md#BKMK_ConvertDisk).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Номер диска**  
 Номер физического диска, который будет преобразован в динамический.  

##  <a name="BKMK_DisableBitLocker"></a> Отключить BitLocker  
 Шаг последовательности задач **Отключить BitLocker** используется для отключения шифрования BitLocker на текущем диске операционной системы или на диске, указанном пользователем. Это действие оставляет предохранитель ключа в виде открытого текста на жестком диске, но не выполняет расшифровку содержимого диска. В связи с этим действие выполняется практически мгновенно.  

> [!NOTE]  
>  Функция шифрования диска BitLocker обеспечивает низкоуровневое шифрование содержимого томов диска.  

 Если шифрование настроено для нескольких дисков, необходимо отключить шифрование BitLocker на дисках с данными, прежде чем отключать его на диске операционной системы.  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Текущий диск с операционной системой**  
 Отключение шифрования BitLocker на текущем диске операционной системы.  

 **Другой диск**  
 Отключение BitLocker на конкретном диске. Используйте раскрывающееся меню, чтобы указать диск, на котором требуется отключить шифрование BitLocker.  

##  <a name="BKMK_DownloadPackageContent"></a> Скачать содержимое пакета  
 Используйте шаг последовательности задач **Скачать содержимое пакета** , чтобы скачать любой из следующих типов пакетов:  

-   Образы операционной системы  

-   пакеты обновления операционной системы;  

-   пакеты драйверов,  

-   пакеты,  

 Этот шаг используется в последовательности задач для обновления операционной системы в следующих сценариях.  

-   Для использования единственной последовательности задач обновления, которая может работать с платформами x86 и x64. Для этого включите в группу **Подготовка к обновлению** два шага **Скачать содержимое пакета** с условиями обнаружения архитектуры клиента и скачивания только соответствующего пакета обновления операционной системы. Настройте каждый шаг **Скачать содержимое пакета** так, чтобы использовалась одна и та же переменная, и используйте переменную для пути к носителю в шаге **Обновить операционную систему** .  

-   Для динамического скачивания применимого пакета драйверов используйте два шага загрузки **Скачать содержимое пакета** с условиями определения соответствующего типа оборудования для каждого пакета драйверов. Настройте каждый шаг **Скачать содержимое пакета** так, чтобы использовалась одна и та же переменная, и используйте переменную для значения **Промежуточное содержимое** в разделе драйверов в шаге **Обновить операционную систему** .  

> [!NOTE]    
> При развертывании последовательности задач, которая содержит шаг загрузки содержимого пакета, не выбирайте значение **Загрузить все содержимое локально перед выполнением последовательности задач** для **параметров развертывания** на странице **Точки распространения** мастера развертывания программного обеспечения.  

Этот шаг последовательности задач выполняется в стандартной операционной системе или в среде предустановки Windows. Однако команда сохранения пакета в кэше клиента Configuration Manager не поддерживается в WinPE.

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 Значок**Выберите пакет**  
 Щелкните значок для выбора скачиваемого пакета. После выбора пакета вы можете щелкнуть значок еще раз, чтобы выбрать другой пакет.  

 **Поместить в следующее расположение**  
 Выберите для сохранения пакета в одном из следующих расположений:  

 -   **Рабочий каталог последовательности задач**  

 -   **Кэш клиента Configuration Manager**: этот параметр следует использовать для хранения содержимого в кэше клиентов. Это позволяет клиенту выступать в качестве источника однорангового кэша для других клиентов однорангового кэша. Дополнительные сведения см. в разделе [Подготовка однорангового кэша среды предустановки Windows для снижения трафика глобальной сети](../get-started/prepare-windows-pe-peer-cache-to-reduce-wan-traffic.md).  

 -   **Пользовательский путь**  

 **Сохранить путь как переменную**  
 Вы можете сохранить путь в виде переменной для использования в другом шаге последовательности задач. Configuration Manager добавляет к имени переменной числовой суффикс. Например, переменную %*mycontent*% можно указать как пользовательскую переменную. Она будет указывать на корневой каталог, в котором хранится все содержимое (содержимое может быть представлено несколькими пакетами). При использовании этой переменной к ней нужно добавлять числовой суффикс. Например, на первый пакет будет указывать переменная %*mycontent01*%. При использовании переменной на следующих этапах, например во время обновления операционной системы, используйте переменную %*mycontent02*% или %*mycontent03*%, где число указывает на то, в каком порядке пакет будет использоваться на соответствующем этапе.  

 **Если произойдет сбой при скачивании пакета, продолжить скачивать другие пакеты в списке**  
 Указывает, что в случае сбоя скачивания пакета начинается скачивание следующего пакета в списке.  

##  <a name="BKMK_EnableBitLocker"></a> Включить BitLocker  
 Шаг последовательности задач **Включить BitLocker** используется для включения шифрования BitLocker по крайней мере на двух разделах жесткого диска. Первый активный раздел содержит загрузочный код Windows. Другой раздел содержит операционную систему. Загрузочный раздел должен остаться незашифрованным.  

 Используйте шаг последовательности задач **Предварительная инициализация BitLocker** для включения BitLocker на диске в Windows PE. Дополнительные сведения см. в разделе [Предварительная инициализация BitLocker](#BKMK_PreProvisionBitLocker) этой статьи.  

> [!NOTE]  
>  Функция шифрования диска BitLocker обеспечивает низкоуровневое шифрование содержимого томов диска.  

 Шаг **Включить BitLocker** выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Включить BitLocker"](task-sequence-action-variables.md#BKMK_EnableBitLocker).  

 Если вы указываете **Только TPM**, **TPM и ключ запуска на USB** или **TPM и ПИН-код**, то прежде чем можно будет запустить шаг **Включить BitLocker** , доверенный платформенный модуль (TPM) должен быть в следующем состоянии:  

-   Включено  

-   Активировано  

-   Допускается владение  

 Шаг последовательности задач может выполнить все оставшиеся действия инициализации TPM, поскольку остальные действия не требуют физического присутствия или перезагрузки. Остальные действия инициализации TPM, которые могут явно выполняться шагом **Включить BitLocker** (при необходимости) включают следующие:  

-   создание пары ключей подтверждения;  

-   создание значения авторизации владельца и передача его на хранение в схему Active Directory, которая должна быть расширена для поддержки этого значения;  

-   смена владельца;  

-   создание корневых ключей хранилища или их сброс, если они имеются, но несовместимы.  

 Если требуется, чтобы после выполнения шага **Включить BitLocker** система дожидалась завершения процесса шифрования диска, прежде чем переходить к следующему шагу в последовательности задач, установите флажок **Ожидать** . Если не установить флажок **Ожидать** , процесс шифрования диска будет выполняться в фоновом режиме, и выполнение последовательности задач продолжится немедленно.  

 Функцию BitLocker можно использовать для шифрования нескольких дисков в системе компьютера (как дисков операционной системы, так и дисков данных). Чтобы выполнить шифрование диска данных, диск операционной системы уже должен быть зашифрован и процесс шифрования должен быть завершен, так как предохранители ключа для дисков данных хранятся на диске операционной системы. Соответственно, если шифрование диска операционной системы и диска данных выполняется в рамках одного процесса, необходимо установить флажок "Ожидать" для действия, которое включает шифрование BitLocker для диска операционной системы.  

 Если жесткий диск уже зашифрован, а шифрование BitLocker отключено, шаг "Включить BitLocker" повторно включает предохранитель или предохранители ключа и выполняется практически мгновенно. Повторное шифрование жесткого диска в этом случае не требуется.  

 Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Включить BitLocker"](task-sequence-action-variables.md#BKMK_EnableBitLocker).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Описательное имя для этого шага последовательности задач.  

 **Описание**  
 В это поле можно при необходимости ввести описание для этого шага последовательности задач.  

 **Выберите диск для шифрования**  
 Выбор диска для шифрования. Чтобы выполнить шифрование текущего диска операционной системы, выберите **Текущий диск с операционной системой** , а затем настройте один из следующих параметров для управление ключами.  

-   **Только TPM**: выберите этот параметр, чтобы использовать только доверенный платформенный модуль (TPM).  

-   **Ключ запуска на USB**: выберите этот параметр, чтобы использовать ключ запуска, хранящийся на USB-устройстве флеш-памяти. При выборе этого параметра BitLocker блокирует обычный процесс загрузки, пока устройство USB, содержащее ключ запуска BitLocker, не будет подключено к компьютеру.  

-   **TPM и ключ запуска на USB**: выберите этот параметр, чтобы использовать доверенный платформенный модуль и ключ запуска, хранящийся на USB-устройстве флеш-памяти. При выборе этого параметра BitLocker блокирует обычный процесс загрузки, пока устройство USB, содержащее ключ запуска BitLocker, не будет подключено к компьютеру.  

-   **Довер. платф. модуль и ПИН-код**: выберите этот параметр, чтобы использовать доверенный платформенный модуль и персональный идентификационный номер (ПИН-код). При выборе этого параметра BitLocker блокирует обычный процесс загрузки, пока пользователь не предоставит ПИН-код.  

 Для шифрования диска конкретного диска данных без операционной системы нажмите **Определенный диск**, а затем выберите диск в списке.  

 **Выберите место для создания ключа восстановления**  
 Чтобы указать, расположение создания пароля восстановления, выберите **В Active Directory** , чтобы передать пароль на хранение в Active Directory. Если выбран этот вариант, необходимо расширить схему Active Directory для сайта, чтобы иметь возможность сохранять связанные данные восстановления BitLocker. Можно отказаться от создания пароля, выбрав вариант **Не создавать ключ восстановления**. Однако рекомендуется не отказываться от создания пароля.  

 **Прежде чем продолжить выполнение последовательности задач, дождаться, пока BitLocker зашифрует все диски**  
 Установите этот флажок, чтобы функция шифрования диска BitLocker могла завершить работу, прежде чем будет запущен следующий шаг последовательности задач. Если выбран этот вариант, пользователь не сможет войти в систему, пока не завершится шифрование всего тома диска.  

 Процесс шифрования может занять несколько часов в зависимости от объема дискового пространства шифруемого диска. Если не устанавливать этот флажок, выполнение последовательности задач будет продолжаться без задержек.  

##  <a name="BKMK_FormatandPartitionDisk"></a> Отформатировать диск и создать разделы  
 Шаг последовательности задач **Отформатировать диск и создать разделы** используется для форматирования и создания разделов на указанном диске конечного компьютера.  

> [!IMPORTANT]  
>  Параметры, настроенные для этого шага последовательности задач, применяются только к указанному диску. Если вы хотите выполнить форматирование и разбиение на разделы другого диска на целевом компьютере, необходимо добавить в последовательность задач дополнительный шаг **Отформатировать диск и создать разделы** .  

 Этот шаг последовательности задач выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Отформатировать диск и создать разделы"](task-sequence-action-variables.md#BKMK_FormatPartitionDisk).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Номер диска**  
 Номер физического диска, форматирование которого будет выполнено. Номер определяется порядком перечисления дисков Windows.  

 **Тип диска**  
 Тип форматируемого диска. В раскрывающемся списке можно выбрать один из двух вариантов:  

-   "Стандартный (MBR)" — основная загрузочная запись.  

-   GPT — таблица разделов GPT.  

> [!NOTE]  
>  Если тип диска изменен с **Стандартный (MBR)** на **GPT**, и разметка разделов содержит дополнительный раздел, все дополнительные и логические разделы будут удалены из разметки. Действие изменения типа диска требует подтверждения пользователя.  

 **Том**  
 Определенные сведения о создаваемом разделе или томе, включая следующее:  

-   Имя  

-   Осталось места на диске  

 Чтобы создать новый раздел, нажмите кнопку **Создать** , которая открывает диалоговое окно **Свойства раздела** . Можно указать тип и размер раздела, кроме того, необходимо выбрать, будет ли раздел загрузочным. Чтобы изменить существующий раздел, щелкните изменяемый раздел и нажмите кнопку "Свойства". Дополнительные сведения о том, как настроить разделы жесткого диска, см. в одной из следующих статей.  

-   [Настройка разделов жесткого диска в системе, использующей UEFI и GPT](http://go.microsoft.com/fwlink/?LinkID=272104)  

-   [Настройка разделов жесткого диска в системе, использующей BIOS и MBR](http://go.microsoft.com/fwlink/?LinkId=272105)  

 Чтобы удалить раздел, выберите его и нажмите кнопку **Удалить**.  

##  <a name="BKMK_InstallApplication"></a> Установить приложение  
 Шаг последовательности задач **Установка приложения** используется для установки приложений при выполнении последовательности задач. Это действие позволяет установить набор приложений, указанных шагом последовательности задач или в динамическом списке переменных последовательности задач. При выполнении этого шага установка приложения начинается немедленно без ожидания завершения интервала опроса политики.  

 Установленные приложения должны удовлетворять следующим критериям.  

-   Приложение должно развертываться через установщик Windows или установщик скриптов. Типы развертывания "Пакет приложений Windows (APPX-файл)" не поддерживаются.  

-   Оно должно выполняться в контексте учетной записи Local System, а не учетной записи пользователя.  

-   Приложения не должны взаимодействовать с рабочим столом. Программа должна запускаться без вмешательства пользователя или в автоматическом режиме.  

-   Оно не должно запускать перезагрузку. Приложения должны запрашивать перезагрузку, используя стандартный код перезагрузки (код выхода 3010). Это гарантирует правильную обработку перезагрузки шагом последовательности задач. Если приложение не возвращает код выхода 3010, базовая подсистема выполнения последовательности задач выполняет перезагрузку. После перезагрузки выполнение последовательности задач продолжается автоматически.  

 При запуске шага **Установка приложения** приложение проверяет возможность применения правил требований и метода обнаружения для типов развертывания приложения. На основе результатов этой проверки приложение устанавливает соответствующий тип развертывания. Если тип развертывания содержит зависимости, зависимый тип развертывания оценивается и устанавливается в ходе выполнения шага установки приложения. Зависимости приложений не поддерживается для автономных носителей.  

> [!NOTE]  
>  Для установки приложения, которое заменяет другое приложение, файлы содержимого для заменяемого приложения должны быть доступны. Иначе этот шаг последовательности задач завершится неудачно. Например, на клиенте или в записанном образе установлен Microsoft Visio 2010. При выполнении шага последовательности задач "Установка приложения" для установки Microsoft Visio 2013 файлы содержимого для Microsoft Visio 2010 (заменяемого приложения) должны быть доступны в точке распространения, иначе произойдет сбой последовательности задач. Клиент или записанный образ без установленного Microsoft Visio выполнит установку Microsoft Visio 2013 без проверки файлов содержимого для Microsoft Visio 2010.  

> [!NOTE]
> Встроенные переменные SMSTSMPListRequestTimeoutEnabled и SMSTSMPListRequestTimeout можно использовать для включения последовательности задач и указания времени ожидания в миллисекундах перед повторной попыткой установки приложения или обновления ПО после сбоя при получении списка точек управления из служб определения местоположения. Дополнительные сведения см. в статье [Встроенные переменные последовательности задач](task-sequence-built-in-variables.md).

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** для этого шага можно настроить параметры, описываемые в данном разделе.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Задайте повторение этого шага в случае, если компьютер неожиданно перезагружается. Можно также задать количество попыток повторения шага после перезагрузки.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Установить следующие приложения**  
 Этот параметр задает приложения, устанавливаемые в том порядке, в котором они были указаны.  

 Configuration Manager отфильтрует все отключенные приложения или приложения с перечисленными ниже параметрами. Эти приложения не будут отображаться в диалоговом окне **Выбор приложения для установки** .  

-   Только после входа пользователя  

-   Выполнение с правами пользователя  

 **Установить приложения в соответствии со списком динамических переменных**  
 Этот параметр определяет основное имя для набора переменных последовательности задач, задаваемых для коллекции или компьютера. Эти переменные указывают приложения, которые будут установлены для данной коллекции или компьютера. Имя переменной состоит из общего базового имени и числового суффикса, начинающегося с 01. Значение каждой переменной должно содержать имя приложения и ничего более.  

 Для приложений, которые требуется установить с использованием динамического списка переменных, на вкладке **Общие** диалогового окна **Свойства** приложения необходимо включить следующий параметр: **Разрешить установку этого приложения из действия последовательности задач "Установка приложения" вместо развертывания вручную**.  

> [!NOTE]  
>  Установка приложений с помощью динамического списка переменных не поддерживается для развертываний с автономного носителя.  

 Например, чтобы установить отдельное приложение, используя переменную последовательности задач AA01, необходимо указать следующую переменную:  

|Имя переменной|Значение переменной|  
|-------------------|--------------------|  
|AA01|Microsoft Office|  

 Чтобы установить два приложения, потребуется указать следующие переменные:  

|Имя переменной|Значение переменной|  
|-------------------|--------------------|  
|AA01|Microsoft Lync|  
|AA02|Microsoft Office|  

 На устанавливаемые компоненты будут влиять следующие условия:  

-   Если значение переменной содержит любые данные кроме имени приложения, приложение не устанавливается и продолжается выполнение последовательности задач.  

-   Если не удается найти переменную с указанным базовым именем и суффиксом "01", никакие приложения не устанавливаются. Если на вкладке "Параметры" этого шага последовательности задач выбран параметр **Продолжить при ошибке**, то последовательность задач продолжается после сбоя установки приложения. Если этот параметр не выбран, то последовательность задач завершится неудачно и не установит остальные приложения.  

 **В случае сбоя установки одного из приложений продолжить установку других приложений в списке**  
 Этот параметр указывает, что выполнение шага должно продолжаться, даже если происходит сбой установки отдельного приложения. Если указан этот параметр, последовательность задач продолжит выполнение вне зависимости от каких-либо возвращенных ошибок установки. Если этот параметр не указан и установка завершается ошибкой, то шаг последовательности задач завершается немедленно.  

##  <a name="BKMK_InstallDeploymentTools"></a> Установить средства развертывания  
 Шаг последовательности задач **Установить средства развертывания** используется для установки пакета Configuration Manager, содержащего средства развертывания Sysprep.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет Sysprep**  
 Этот параметр указывает пакет Configuration Manager, который содержит средства развертывания Sysprep для следующих операционных систем:  

-   Windows XP с пакетом обновления 3 (SP3)  

-   Windows XP X64 пакетом обновления 2 (SP2),  

-   Windows Server 2003 с пакетом обновления 2 (SP2)  

##  <a name="BKMK_InstallPackage"></a> Установить пакет

 Шаг последовательности задач **Установить пакет** используется для установки программного обеспечения при выполнении последовательности задач. При выполнении этого шага установка начинается немедленно без ожидания завершения интервала опроса политики.  

 Устанавливаемое программное обеспечение должно удовлетворять следующим условиям.  

-   Оно должно выполняться в контексте учетной записи Local System, а не учетной записи пользователя.  

-   Оно не должно взаимодействовать с рабочим столом. Программа должна запускаться без вмешательства пользователя или в автоматическом режиме.  

-   Оно не должно запускать перезагрузку. Программное обеспечение должно запрашивать перезагрузку, используя стандартный код перезагрузки (код выхода 3010). Это гарантирует правильную обработку перезагрузки шагом последовательности задач. Если программное обеспечение не возвращает код выхода 3010, базовая подсистема выполнения последовательности задач выполняет перезагрузку. После перезагрузки выполнение последовательности задач продолжается автоматически.  

 Программы, которые используют параметр **Запустить сначала другую программу** для установки зависимых программ, не поддерживаются при развертывании ОС. Если параметр **Запустить сначала другую программу** включен для программного обеспечения, и зависимая программа уже запущена на конечном компьютере, эта программа запускается и продолжается выполнение последовательности задач. Однако если зависимая программа еще не запущена на конечном компьютере, происходит сбой последовательности задач.  

> [!NOTE]  
>  Сайт центра администрирования не имеет политик конфигурации клиентов, необходимых для включения агента распространения программного обеспечения при выполнении последовательности задач. Если при создании автономного носителя для последовательности задач на сайте центра администрирования последовательность задач включает шаг **Установить пакет** , в файле журнала CreateTsMedia.log может появиться следующее сообщение об ошибке:  
>   
>  `"WMI method SMS_TaskSequencePackage.GetClientConfigPolicies failed (0x80041001)"`  
>   
>  Для автономного носителя, включающего шаг "Установить пакет", необходимо проводить создание на первичном сайте с включенным агентом распространения ПО или добавить шаг **Выполнить из командной строки** после шага **Настройка Windows и Configuration Manager** и перед первым шагом **Установить пакет** . Шаг **Выполнить из командной строки** выполняет команду WMIC, чтобы включить программу агент распространения ПО до первого шага "Установить пакет". Можно использовать следующий шаг **Выполнить из командной строки** :  
>   
>  **Командная строка**: **WMIC /namespace:\\\root\ccm\policy\machine\requestedconfig path ccm_SoftwareDistributionClientConfig CREATE ComponentName="Enable SWDist", Enabled="true", LockSettings="TRUE", PolicySource="local", PolicyVersion="1.0", SiteSettingsKey="1" /NOINTERACTIVE**  
>   
>  Дополнительные сведения о создании автономного носителя см. в разделе [Создание автономного носителя](../deploy-use/create-stand-alone-media.md).  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Установить один пакет программного обеспечения**  
 Этот параметр указывает пакет программного обеспечения Configuration Manager. Выполнение шага продолжится после завершения установки.  

 **Установить пакеты программного обеспечения в соответствии со списком динамических переменных**  
 Этот параметр определяет основное имя для набора переменных последовательности задач, задаваемых для коллекции или компьютера. Эти переменные указывают пакеты, которые будут установлены для данной коллекции или компьютера. Имя переменной состоит из общего базового имени и числового суффикса, начинающегося с 001. Значение каждой переменной должно содержать идентификатор пакета и имя программы, разделенные двоеточием.  

 Для программного обеспечения, которое требуется установить с использованием динамического списка переменных, на вкладке **Дополнительно** диалогового окна **Свойства** пакета необходимо включить следующий параметр: **Разрешить установку этой программы из последовательности задач "Установка пакета" без развертывания**.  

> [!NOTE]  
>  Установка программного обеспечения с помощью динамического списка переменных не поддерживается для развертываний с автономного носителя.  

 Например, чтобы установить отдельный программный пакет, используя переменную последовательности задач AA001, необходимо указать следующую переменную:  

|Имя переменной|Значение переменной|  
|-------------------|--------------------|  
|AA001|CEN00054:Install|  

 Чтобы установить три пакета программного обеспечения, необходимо указать следующие переменные:  

|Имя переменной|Значение переменной|  
|-------------------|--------------------|  
|AA001|CEN00054:Install|  
|AA002|CEN00107:Install Silent|  
|AA003|CEN00031:Install|  

 На устанавливаемые компоненты будут влиять следующие условия:  

-   Если значение переменной не создано, имеет неправильный формат или не указывает действительный идентификатор и имя приложения, установка ПО завершится ошибкой.  

-   Если идентификатор пакета содержит символы нижнего регистра, установка ПО завершится ошибкой.  

-   Если переменных с указанным базовым именем и суффиксом "001" не найдено, никакие пакеты не устанавливаются и последовательность задач продолжает работу.  

 **Если не удастся установить программный пакет, продолжить установку других пакетов в списке**  
 Этот параметр указывает, что шаг продолжает работу, если установка отдельного пакета ПО завершается ошибкой. Если указан этот параметр, последовательность задач продолжит выполнение вне зависимости от каких-либо возвращенных ошибок установки. Если этот параметр не указан и установка завершается ошибкой, то шаг последовательности задач завершается немедленно.  

##  <a name="BKMK_InstallSoftwareUpdates"></a> Установить обновления программного обеспечения  
 Используйте шаг последовательности задач **Установить обновления программного обеспечения** , чтобы установить на конечный компьютер обновления программного обеспечения. Конечный компьютер не оценивается на наличие применимых обновлений программного обеспечения, пока не будет запущен этот шаг последовательности задач. В это время конечный компьютер оценивается на наличие обновлений ПО как и любой другой клиент, управляемый Configuration Manager. В частности, этот шаг устанавливает только те обновления программного обеспечения, которые предназначены для коллекций, в которые компьютер входит в настоящее время.  
>  [!IMPORTANT]
>Мы настоятельно рекомендуем устанавливать последнюю версию агента обновления Windows. Он обеспечивает более высокую производительность по сравнению с последовательностью задач "Установка обновлений программного обеспечения".
>* Для Windows 7 см. [статью базы знаний 3161647](https://support.microsoft.com/kb/3161647).
>* Для Windows 8 см. [статью базы знаний 3163023](https://support.microsoft.com/kb/3163023).

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Установить обновления программного обеспечения"](task-sequence-action-variables.md#BKMK_InstallSoftwareUpdates).

 > [!NOTE]
 > Встроенные переменные SMSTSMPListRequestTimeoutEnabled и SMSTSMPListRequestTimeout можно использовать для включения последовательности задач и указания времени ожидания в миллисекундах перед повторной попыткой установки приложения или обновления ПО после сбоя при получении списка точек управления из служб определения местоположения. Дополнительные сведения см. в разделе [Встроенные переменные последовательности задач](task-sequence-built-in-variables.md).

> [!NOTE]
>На вкладке "Параметры" вы можете задать для этой последовательности задач повторное выполнение в случае неожиданной перезагрузки компьютера. Например, при установке обновления, выполняющего автоматическую перезагрузку компьютера. В Configuration Manager 1602 и более поздних версиях можно настроить переменную SMSTSWaitForSecondReboot, чтобы указать продолжительность (в секундах) приостановки последовательности задач после перезагрузки компьютера при установке обновлений программного обеспечения. Дополнительные сведения см. в разделе [Встроенные переменные последовательности задач](task-sequence-built-in-variables.md).

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Задайте повторение этого шага в случае, если компьютер неожиданно перезагружается. Можно также задать количество попыток повторения шага после перезагрузки.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Требуется для установки — только обязательные обновления программного обеспечения**  
 Выберите этот параметр, чтобы установить все обновления программного обеспечения, отмеченные в Configuration Manager как обязательные для конечных компьютеров, получающих последовательность задач. Обязательные обновления программного обеспечения имеют сроки установки, определенные администратором.  

 **Доступно для установки — все обновления программного обеспечения**  
 Выберите этот параметр, чтобы установить все доступные обновления программного обеспечения, предназначенные для коллекции Configuration Manager, получающей последовательность задач. Все доступные обновления программного обеспечения будут установлены на конечные компьютеры.  

 **Оценка обновлений программного обеспечения на основе кэшированных результатов проверки**  
Начиная с версии Configuration Manager 1606, у вас есть возможность выполнять полную проверку на наличие обновлений программного обеспечения вместо использования кэшированных результатов проверки. По умолчанию последовательность задач использует кэшированные результаты. Можно снять этот флажок, чтобы клиент подключался к точке обновления программного обеспечения для обработки и загрузки каталога последних обновлений программного обеспечения. Этот параметр может быть удобным при использовании последовательности задач для [снятия и создания образа операционной системы](../deploy-use/create-a-task-sequence-to-capture-an-operating-system.md), когда вам известно о наличии большого числа обновлений программного обеспечения, особенно с зависимостями (требуется установить X, прежде чем Y будет отображаться как применимое). Если снять этот флажок и начать развертывание последовательности задач на большом числе клиентов, все они подключатся к точке обновления программного обеспечения одновременно. Это может привести к проблемам с производительностью во время обработки и загрузки каталога. В большинстве случаев рекомендуется использовать значение по умолчанию.

Новая переменная последовательности задач, SMSTSSoftwareUpdateScanTimeout, была представлена в версии Configuration Manager 1606, чтобы дать вам возможность управлять временем ожидания для проверки обновлений программного обеспечения во время шага последовательности задач "Установка программного обеспечения". Значение по умолчанию — 30 минут. Дополнительные сведения см. в разделе [Встроенные переменные последовательности задач](task-sequence-built-in-variables.md).


##  <a name="BKMK_JoinDomainorWorkgroup"></a> Присоединить к домену или рабочей группе  
 Используйте шаг последовательности задач **Присоединить к домену или рабочей группе** , чтобы добавить конечный компьютер в рабочую группу или домен.  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Присоединить к домену или рабочей группе"](task-sequence-action-variables.md#BKMK_JoinDomainWorkgroup).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Присоединить к рабочей группе**  
 Выберите этот параметр, чтобы присоединить конечный компьютер к указанной рабочей группе. Если компьютер в настоящий момент является членом домена, выбор этого параметра вызовет перезагрузку компьютера.  

 **Присоединить к домену**  
 Выберите этот параметр, чтобы присоединить конечный компьютер к указанному домену.  

 Дополнительно введите или найдите подразделение в заданном домене, к которому требуется присоединить компьютер. Если компьютер в настоящий момент является членом другого домена или рабочей группы, выбор этого параметра вызовет перезагрузку компьютера. Если компьютер уже является членом другого подразделения, служба каталогов Active Directory не позволит изменить подразделение и параметр будет проигнорирован.  

 **Укажите учетную запись, которая имеет разрешение на присоединение к домену**  
 Нажмите кнопку **Задать** , чтобы указать учетную запись и пароль, имеющую разрешение на присоединение к домену. Учетная запись должна вводиться в следующем формате:  

 *домен\учетная запись*  

## <a name="BKMK_PrepareConfigMgrClientforCapture"></a> Подготовка клиента Configuration Manager перед снятием образа  
Используйте шаг **Подготовка клиента Configuration Manager перед снятием образа** для удаления клиента Configuration Manager или настройки клиента на компьютере-образце и подготовки его для записи образа.

Начиная с версии Configuration Manager 1610 на шаге "Подготовка клиента Configuration Manager" полностью удаляется клиент, а не только основные сведения. Когда последовательность задач развертывает записанный образ операционной системы, она каждый раз будет устанавливать новый клиент Configuration Manager.  

До версии Configuration Manager 1610 этот шаг выполняет указанные ниже задачи.  

-   Удаление из файла smscfg.ini, находящегося в каталоге Windows, раздела свойств конфигурации. Эти свойства включают сведения, относящиеся к клиенту, включая идентификатор GUID Configuration Manager и другие идентификаторы клиента.  

-   Удаление всех сертификатов компьютеров SMS или Configuration Manager.  

-   Удаление кэша клиента Configuration Manager.  

-   Очистка назначенных переменных сайта для клиента Configuration Manager.  

-   Удаление всех локальных политик Configuration Manager.  

-   Удаление доверенного корневого ключа клиента Configuration Manager.  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

##  <a name="BKMK_PrepareWindowsforCapture"></a> Подготовка Windows перед снятием образа  
 Используйте шаг последовательности задач **Подготовка Windows перед снятием образа** , чтобы указать параметры Sysprep, используемые во время записи образа операционной системы на компьютере-образце. Этот действие последовательности задач выполняет программу Sysprep и затем перезагружает компьютер с помощью загрузочного образа Windows PE, определенного в последовательности задач. Чтобы это действие было выполнено успешно, компьютер-образец не должен входить в состав домена.  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Подготовка Windows перед снятием образа"](task-sequence-action-variables.md#BKMK_PrepareWindowsCapture).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Автоматически создавать список драйверов запоминающих устройств**  
 Выберите этот параметр, чтобы программа Sysprep автоматически создавала список драйверов запоминающих устройств на компьютере-образце. Этот параметр включает параметр Build Mass Storage Drivers (добавить драйверы запоминающих устройств) в файле sysprep.inf на компьютере-образце. Дополнительные сведения об этом параметре см. в документации к программе Sysprep.  

 **Не сбрасывать флаг активации**  
 Выберите этот параметр, чтобы запретить программе Sysprep сброс флага активации продукта.  

##  <a name="BKMK_PreProvisionBitLocker"></a> Предварительная инициализация BitLocker  
 Используйте шаг последовательности задач **Предварительная инициализация BitLocker** для включения BitLocker на диске в Windows PE. Шифруется только используемое дисковое пространство, и таким образом шифрование выполняется гораздо быстрее. Параметры управления ключами применяются с помощью шага последовательности задач [Включить BitLocker](#BKMK_EnableBitLocker) после установки операционной системы. Этот шаг выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе.  

> [!IMPORTANT]  
>  Для предварительной инициализации BitLocker вы должны развернуть операционную систему не ниже Windows 7, и на этом компьютере должен быть включен и поддерживаться доверенный платформенный модуль.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Укажите краткое определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Укажите подробные сведения о действии, которое выполняется на этом шаге.  

 **Применить BitLocker к указанному диску**  
 Укажите диск, для которого хотите включить BitLocker. Шифруется только занятое место на диске.  

 **Пропустить этот шаг для компьютеров, на которых отсутствует или не включен доверенный платформенный модуль**  
 Выберите этот параметр, чтобы пропустить шифрование диска, если оборудование компьютера не поддерживает доверенный платформенный модуль, или если доверенный платформенный модуль не включен. Например, вы можете использовать этот параметр при развертывании операционной системы на виртуальной машине.  

##  <a name="BKMK_ReleaseStateStore"></a> Освободить хранилище состояний  
 Используйте шаг последовательности задач **Освободить хранилище состояний** , чтобы уведомить точку миграции состояния о том, что действие записи или восстановления выполнено. Этот шаг используется совместно с шагами последовательности задач **Запросить хранилище состояний**, **Записать пользовательское состояние**и **Восстановить пользовательское состояние** , чтобы выполнить миграцию данных пользовательской среды с помощью точки миграции состояния и средства миграции пользовательской среды (USMT).  

 Дополнительные сведения об управлении состоянием пользователей при развертывании операционных систем см. в разделе [Управление пользовательской средой](../get-started/manage-user-state.md).  

 Если вы запросили доступ к точке миграции состояния с целью записи пользовательского состояния в шаге последовательности задач **Запросить хранилище состояний**  , этот шаг уведомит точку миграции состояний о том, что процесс записи завершен и что данные пользовательского состояния доступны для восстановления. Точка миграции состояния задает разрешения на доступ к записанному состоянию таким образом, что к нему может получить доступ (в режиме только чтения) восстанавливаемый компьютер.  

 Если запрошен доступ к точке миграции состояния для восстановления пользовательского состояния в шаге последовательности задач **Запросить хранилище состояний** , этот шаг последовательности задач уведомляет точку миграции состояний о том, что процесс восстановления завершен. В этот момент активируются параметры хранения, настроенные для точки миграции состояний.  

> [!IMPORTANT]  
>  Рекомендуется настроить параметр **Продолжать при ошибке** для всех шагов последовательности задач между шагом **Запросить хранилище состояний** и шагом **Освободить хранилище состояний** , чтобы все действия последовательности задач **Запросить хранилище состояний** имели соответствующее действие **Освободить хранилище состояний** .  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Освободить хранилище состояний"](task-sequence-action-variables.md#BKMK_ReleaseStateStore).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

##  <a name="BKMK_RequestStateStore"></a> Запросить хранилище состояний  
 Используйте шаг последовательности задач **Запросить хранилище состояний** , чтобы запросить доступ к точке миграции состояния во время записи состояния из компьютера или восстановления состояния на компьютер.  

 Дополнительные сведения об управлении состоянием пользователей при развертывании операционных систем см. в разделе [Управление пользовательской средой](../get-started/manage-user-state.md).  

 Шаг последовательности задач **Запросить хранилище состояний** можно использовать совместно с шагами последовательности задач **Освободить хранилище состояний**, **Записать пользовательское состояние**и **Восстановить пользовательское состояние** , чтобы выполнить миграцию состояния компьютера с помощью точки миграции состояния и средства миграции пользовательской среды (USMT).  

> [!NOTE]  
>  Если вы только что настроили новую роль сайта точки миграции состояния (SMP), может потребоваться до одного часа, чтобы она стала доступна для хранилища пользовательских состояний. Чтобы определить доступность точки миграции состояния, можно настроить любой параметр точки миграции состояния для запуска обновления файла управления сайта.  

 Этот шаг последовательности задач выполняется в стандартной операционной системе и в Windows PE для автономного средства миграции пользовательской среды. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Запросить хранилище состояний"](task-sequence-action-variables.md#BKMK_RequestState).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Захват состояния компьютера**  
 Выполняет поиск точки миграции состояния, которая удовлетворяет минимальным необходимым требованиям, настроенным в параметрах точки миграции состояния (максимальное число клиентов и минимальный объем дискового пространства), но это не гарантирует наличие достаточного пространства во время миграции состояния. Выбор этого параметра потребует доступа к точке миграции состояния с целью захвата состояния и параметров пользователя на компьютере.  

 Если на сайте Configuration Manager включено несколько точек миграции состояний, этот шаг последовательности задач выполняет поиск точки миграции состояния, имеющей доступное пространство на диске, запрашивая в точке управления сайтом список точек миграции состояний и затем оценивая каждую, пока не найдет удовлетворяющую минимальным требованиям.  

 **Восстановление состояния с другого компьютера**  
 Выберите этот параметр, чтобы запросить доступ к точке миграции состояния с целью восстановления ранее записанного состояния и параметров пользователя на целевом компьютере.  

 Если сайт Configuration Manager имеет несколько точек миграции состояния, этот шаг последовательности задач выполняет поиск точки миграции состояния, содержащей состояние компьютера, сохраненное для целевого компьютера.  

 **Число повторных попыток**  
 Число попыток, которое будет выполнять этот шаг последовательности задач для поиска подходящей точки миграции состояния перед тем, как выдать ошибку.  

 **Пауза между попытками (в секундах)**  
 Время в секундах, которое шаг последовательности задач ожидает между повторными попытками.  

 **Если учетной записи компьютера не удается подключиться к хранилищу состояний, использовать учетную запись сетевого доступа.**  
 Указывает, что для подключения к точке миграции состояния будут использоваться учетные данные сетевого доступа Configuration Manager, если клиент Configuration Manager не сможет получить доступ к хранилищу состояний SMP с использованием учетной записи компьютера. Этот вариант является менее защищенным, так как другие компьютеры могут использовать учетную запись сетевого доступа для доступа к сохраненному состоянию, однако его применение является обязательным, если конечный компьютер не присоединен к домену.  

##  <a name="BKMK_RestartComputer"></a> Перезагрузить компьютер  
 Используйте шаг последовательности задач **Перезагрузка компьютера** , чтобы перезагрузить компьютер, на котором выполняется последовательность задач. После перезагрузки компьютер автоматически перейдет к следующему шагу последовательности задач.  

 Этот шаг может быть выполнен либо в стандартной операционной системе, либо в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Перезагрузка компьютера"](task-sequence-action-variables.md#BKMK_RestartComputer).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Образ загрузки, назначенный данной последовательности задач**  
 Выберите этот параметр для конечного компьютера, чтобы использовать образ загрузки, назначенный последовательности задач. Образ загрузки будет использоваться для выполнения следующих шагов последовательности, выполняемых в среде предустановки Windows.  

 **Установленная по умолчанию операционная система**  
 Выберите этот параметр для перезагрузки конечного компьютера с использованием установленной операционной системы.  

 **Уведомлять пользователя перед перезагрузкой**  
 Выберите этот параметр, чтобы отображать уведомления пользователю о перезагрузке компьютера. Этот параметр установлен по умолчанию.  

 **Сообщение уведомления**  
 Введите сообщение уведомления, отображаемое пользователю перед перезагрузкой конечного компьютера.  

 **Время ожидания при отображении сообщений**  
 Укажите врем в секундах, которое будет предоставлено пользователю перед перезагрузкой конечного компьютера. Период по умолчанию — 60 секунд.  

##  <a name="BKMK_RestoreUserState"></a> Восстановить пользовательское состояние  
 Используйте шаг последовательности задач **Восстановить пользовательское состояние** , чтобы инициировать средство миграции пользовательской среды (USMT) для восстановления состояния пользователя и параметров на конечном компьютере. Этот шаг последовательности задач используется в сочетании с шагом **Записать пользовательское состояние** последовательности задач.  

 Дополнительные сведения об управлении состоянием пользователей при развертывании операционных систем см. в разделе [Управление пользовательской средой](../get-started/manage-user-state.md).  

 Шаг последовательности задач **Восстановить пользовательское состояние** также можно использовать вместе с шагами **Запросить хранилище состояний** и **Освободить хранилище состояний**, если требуется сохранить параметры состояния в точке миграции состояния сайта Configuration Manager или восстановить их из этой точки. При использовании средства USMT 3.0 и более поздних версий всегда выполняется расшифровка хранилища состояний USMT с помощью ключа шифрования, созданного и управляемого Configuration Manager.  

 Шаг **Восстановить пользовательское состояние** последовательности задач позволяет управлять ограниченным набором наиболее широко используемых параметров USMT. С помощью переменной OSDMigrateAdditionalRestoreOptions последовательности задач можно указать дополнительные параметры командной строки.  

> [!IMPORTANT]  
>  Если шаг **Восстановить пользовательское состояние** последовательности задач используется для цели, не связанной со сценарием развертывания, добавьте шаг [Перезагрузка компьютера](#BKMK_RestartComputer) сразу после шага **Восстановить пользовательское состояние** последовательности задач.  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Восстановить пользовательское состояние"](task-sequence-action-variables.md#BKMK_RestoreUserState).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Содержит дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет средств миграции пользовательской среды**  
 Укажите пакет Configuration Manager, содержащий версию USMT, которая будет использоваться в этом шаге при восстановлении состояния и параметров пользователя. Для этого пакета не требуется программа. При выполнении шага последовательности задач используется версия USMT в указанном пакете. Укажите пакет, содержащий 32-разрядную или 64-разрядную версию USMT, в зависимости от архитектуры операционной системы, в которую восстанавливается состояние.  

 **Восстановление всех записанных профилей пользователей со стандартными параметрами**  
 Восстановление записанных профилей пользователей со стандартными параметрами. Чтобы указать параметры, которые должны быть восстановлены, выберите **Настройка записи профиля пользователя**.  

 **Настройка способа восстановления профилей пользователей**  
 Позволяет указывать файлы, которые вы хотите восстановить на целевом компьютере. Выберите **Файлы** , чтобы указать файлы конфигурации в пакете USMT, который будет использоваться для восстановления профилей пользователей. Чтобы добавить файл конфигурации, введите имя файла в поле **Имя файла** и нажмите кнопку **Добавить**. Файлы конфигурации, которые будут использоваться для выполнения операции, перечислены на панели "Файлы". Указанный XML-файл определяет, какой файл пользователя будет восстановлен.  

 **Восстановить профили локальных пользователей компьютера**  
 Восстанавливает профили пользователей локального компьютера (т. е. не пользователей домена). Вам потребуется назначить новые пароли восстановленным учетным записям локальных пользователей, так как перенос паролей исходных учетных записей невозможен. Введите новый пароль в поле **Пароль** и подтвердите пароль в поле **Подтверждение пароля** .  

 **Продолжить операцию при невозможности восстановления некоторых файлов**  
 Продолжает восстановление состояния и параметров пользователей при невозможности восстановления некоторых файлов. Этот параметр по умолчанию включен. Если этот параметр отключен, и во время восстановления файлов возникают ошибки, шаг последовательности задач будет немедленно завершен со сбоем, и при этом будут восстановлены не все файлы.  

 **Включить подробное ведение журнала**  
 Включите этот параметр, чтобы сформировать более подробные сведения о файле журнала. При восстановлении состояния создается файл Loadstate.log, который по умолчанию сохраняется в папке журнала последовательности задач папки \windows\system32\ccm\logs.  

##  <a name="BKMK_RunCommandLine"></a> Выполнить из командной строки  
 Используйте шаг последовательности задач **Выполнить из командной строки** , чтобы выполнить указанную командную строку.  

 Этот шаг может быть выполнен либо в стандартной операционной системе, либо в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Выполнить из командной строки"](task-sequence-action-variables.md#BKMK_RunCommand).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает короткое определяемое пользователем имя, описывающее выполняемую командную строку.  

 **Описание**  
 Указывает более детальные сведения о выполняемой командной строке.  

 **Командная строка**  
 Задает командную строку, которая будет выполняться. Это обязательное поле. Рекомендуется указывать расширения имен файлов, например VBS и EXE. Включите все требуемые файлы параметров, параметры командной строки и ключи.  

 Если в имени файла не указано расширение, Configuration Manager пытается использовать расширения COM, EXE и BAT. Если имя файла имеет расширение, не являющееся исполняемым, Configuration Manager пытается использовать локальную ассоциацию. Например, если в командной строке указано имя файла readme.gif, то Configuration Manager запускает приложение, связанное на компьютере назначения с файлами, имеющими расширение GIF.  

 Примеры:  

 **setup.exe /a**  

 **cmd.exe /c copy Jan98.dat c:\sales\Jan98.dat**  

> [!NOTE]  
>  Действия командной строки, такие как перенаправление выходных данных, туннелирование или копирование (в примере выше), для успешного выполнения должны указываться после команды **cmd.exe /c**.  

 **Отключить перенаправление в 64-разрядной файловой системе**  
 По умолчанию при использовании 64-разрядной операционной системы исполняемый файл в командной строке размещается и выполняется при помощи перенаправителя файловой системы WOW64. Таким образом происходит обнаружение 32-разрядных версий исполняемых файлов операционной системы и библиотек DLL.  При выборе этого варианта отключается использование перенаправителя файловой системы WOW64, и в результате будут обнаруживаться собственные 64-разрядные версии исполняемых файлов операционной системы и библиотек DLL.  Выбор этого варианта не имеет значения при использовании 32-разрядной операционной системы.  

 **Рабочая папка**  
 Указывает папку с исполняемым файлом программы, не более 127 символов. Эта папка может быть абсолютным путем на компьютере назначения или относительным путем к папке в точке распространения, содержащей пакет. Это поле является необязательным.  

 Примеры:  

 **c:\officexp**  

 **i386**  

> [!NOTE]  
>  Кнопка **Обзор** позволяет находить файлы и папки на локальном компьютере, поэтому все выбираемые таким образом элементы должны также присутствовать на компьютере назначения в том же месте и с такими же именами файлов и папок.  

 **Пакет**  
 При указании в командной строке файлов или программ, которых еще нет на целевом компьютере, выберите этот параметр, чтобы задать пакет Configuration Manager, содержащий соответствующие файлы. Для этого пакета не требуется программа. Этот параметр не требуется, если указанные файлы имеются на целевом компьютере.  

 **Время ожидания**  
 Определяет время, в течение которого Configuration Manager разрешает выполнение командной строки. Это значение может составлять от 1 до 999 минут. Значение по умолчанию — 15 минут.  

 Этот параметр отключен по умолчанию.  

> [!IMPORTANT]  
>  Если указывается значение, не предусматривающее достаточно времени для успешного выполнения шага последовательности задач "Выполнить из командной строки", выполнение шага последовательности задач завершится неудачей, и может прерваться вся последовательность задач, в зависимости от других параметров управления. Если время ожидания истекает, Configuration Manager завершает процесс командной строки.  

 **Выполнить этот шаг из следующей учетной записи**  
 Указывает, что командная строка должна выполняться из учетной записи пользователя Windows, а не через локальную системную учетную запись.  

> [!NOTE]  
>  Если для этого шага указана другая учетная запись и он следует после установки операционной системы, эту учетную запись необходимо добавить на компьютер до того, как вы сможете выполнять простые сценарии или команды, а для более сложных программ, таких как MSI, должен быть восстановлен профиль для учетной записи пользователя Windows.  

 **Учетная запись**  
 Указывает учетную запись пользователя Windows для задачи командной строки в последовательности задач, выполняемой данным действием. Командная строка будет выполнена с разрешениями указанной учетной записи. Нажмите кнопку **Задать** для указания учетной записи локального пользователя или домена.  

> [!IMPORTANT]  
>  Если действие последовательности задач **Выполнить из командной строки** с указанием учетной записи пользователя выполняется в среде предустановки Windows, оно завершится сбоем, так как среду предустановки Windows нельзя присоединить к домену. Ошибка будет занесена в файл журнала smsts.log.  

##  <a name="BKMK_RunPowerShellScript"></a> Запустить сценарий PowerShell  
 Для запуска указанного сценария PowerShell используйте шаг последовательности задач **Запуск сценария PowerShell** .  

 Этот шаг может быть выполнен либо в стандартной операционной системе, либо в среде предустановки Windows. Чтобы выполнить этот шаг в среде предустановки Windows, необходимо включить PowerShell в загрузочный образ. Можно включить Windows PowerShell (WinPE-PowerShell) на вкладке **Дополнительные компоненты** в свойствах загрузочного образа. Дополнительные сведения об изменении образа загрузки см. в разделе [Управление загрузочным образом](../get-started/manage-boot-images.md).  

> [!NOTE]  
>  В операционных системах Windows Embedded PowerShell не включается по умолчанию.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает короткое определяемое пользователем имя, описывающее выполняемую командную строку.  

 **Описание**  
 Указывает более детальные сведения о выполняемой командной строке.  

 **Пакет**  
 Укажите пакет Configuration Manager, содержащий сценарий PowerShell. Один пакет может содержать несколько сценариев PowerShell.  

 **Имя сценария**  
 Задает имя сценария PowerShell для выполнения. Это обязательное поле.  

 **Параметры**  
 Задает параметры для передачи в сценарий Windows PowerShell. Настройте параметры, как если бы вы добавляли их в сценарий Windows PowerShell из командной строки.  

> [!IMPORTANT]  
>  Укажите параметры, используемые сценарием, а не для командной строки Windows PowerShell.  
>   
>  В следующем примере показаны допустимые параметры:  
>   
>  **-MyParameter1 MyValue1 -MyParameter2 MyValue2**  
>   
>  В следующем примере показаны недопустимые параметры. Элементы, выделенные жирным шрифтом, являются параметрами командной строки Windows PowerShell (-nologo и -executionpolicy unrestricted) и не используются сценарием.  
>   
>  **-nologo-executionpolicy unrestricted-File MyScript.ps1 -MyParameter1 MyValue1 -MyParameter2 MyValue2**  

 **Политика выполнения PowerShell**  
 Выбор политики выполнения PowerShell позволяет вам определить, какие сценарии Windows PowerShell (при их наличии) будет разрешено выполнять на компьютере. Выберите одну из следующих политик выполнения.  

-   **Все подписанные**: могут выполняться только сценарии, подписанные доверенным издателем.  

-   **Неопределенный**: политика выполнения не определена. .  

-   **Обход**: загружаются все файлы конфигурации и выполняются все сценарии. При запуске неподписанного сценария, который был загружен из Интернета, перед его выполнением будет запрашиваться ваше разрешение.  

> [!IMPORTANT]  
>  PowerShell 1.0 не поддерживает политики выполнения Undefined и Bypass.  

##  <a name="BKMK_SetDynamicVariables"></a> Задать динамические переменные  
 Используйте шаг последовательности задач **Установка динамических переменных** , чтобы выполнить следующие действия.  

1.  Сбор сведений о компьютере и среде, в которой он находится, и установка переменных указанной последовательности задач с этими сведениями.  

2.  Оценка заданных правил и установка переменных последовательности задач на основе переменных и значений, настроенных для правил, которые были оценены как истинные.  

 Последовательность задач автоматически задает переменные следующей последовательности задач, доступные только для чтения.  

 -   &#95;SMSTSMake  

 -   &#95;SMSTSModel  

 -   &#95;SMSTSMacAddresses  

 -   &#95;SMSTSIPAddresses  

 -   &#95;SMSTSSerialNumber  

 -   &#95;SMSTSAssetTag  

 -   &#95;SMSTSUUID  

 Этот шаг может быть выполнен либо в стандартной операционной системе, либо в среде предустановки Windows. Дополнительные сведения о переменных последовательности задач см. в разделе [Переменные действия последовательности задач](task-sequence-action-variables.md).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

**Имя**  
 Короткое определенное пользователем имя для этого шага последовательности задач.  

**Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

**Динамические правила и переменные**  
 Чтобы задать динамическую переменную для использования в последовательности задач, добавьте правило, а затем укажите значение для каждой переменной, задаваемой для правила, или добавьте одну или несколько переменных для установки без добавления правила. При добавлении правила вы можете выбирать следующие категории правил.  

 -   **Компьютер**: используйте эту категорию для оценки значений для тега актива, UUID, серийного номера или MAC-адреса. Можно задать несколько значений, и если какое-либо значение истинно, то правило будет оцениваться как истинное (true). Например, следующее правило оценивается как истинное, если серийный номер имеет значение 5892087, независимо от того, имеет ли MAC-адрес значение 26-78-13-5A-A4-22.  

     `IF Serial Number = 5892087 OR MAC address = 26-78-13-5A-A4-22 THEN`  

-   **Расположение**: используйте эту категорию для оценки значений для шлюза по умолчанию.  

-   **Изготовитель и модель**: используйте эту категорию для оценки значений для марки и модели компьютера. Чтобы правило оценивалось как истинное, и марка, и модель должны оцениваться как истинные.   

    Начиная с версии Configuration Manager 1610 можно указывать звездочку (*****) и вопросительный знак (**?**) в качестве подстановочных знаков, где ***** соответствует нескольким символам, а **?** соответствует одиночному символу. Например, строка "DELL*900?" соответствует "DELL-ABC-9001" и "DELL9009".

-   **Переменная последовательности задач**: используйте эту категорию правил для добавления переменной последовательности задач, условия и значения для оценки. Правило оценивается как истинное, если значение переменной удовлетворяет заданному условию.  

Можно указать одну или несколько переменных, которые будут задаваться для правила, имеющего значение true, или задать переменные без использования правила. Можно выбрать из существующих переменных или создать пользовательскую переменную.  

 -   **Существующие переменные последовательности задач**: используйте этот параметр, чтобы выбрать одну или несколько переменных из списка существующих переменных последовательности задач. Переменные массива выбирать нельзя.  

 -   **Пользовательские переменные последовательности задач**: используйте этот параметр, чтобы задать пользовательскую переменную последовательности задач. Можно также указать существующую переменную последовательности задач. Это полезно для указания существующей переменной массива, такой как OSDAdapter, поскольку переменные массива не входят в список существующих переменных последовательности задач.  

После выбора переменных для правила вы должны предоставить значение для каждой переменной. Переменная устанавливается в указанное значение, если правило возвращает значение true. Для каждой переменной можно указать **секретное значение** , чтобы скрыть значение переменной. По умолчанию некоторые существующие переменные скрывают значения, например, переменная последовательности задач OSDCaptureAccountPassword.  

> [!IMPORTANT]  
>  Если вы импортируете последовательность задач с помощью шага "Установка динамических переменных", и для значения переменной выбрано **Секретное значение** , то при импорте последовательности задач значение переменной удаляется. В результате вы должны повторно ввести значение для этой динамической переменной после импорта последовательности задач.  

##  <a name="BKMK_SetTaskSequenceVariable"></a> Задать переменную последовательности задач  
Используйте шаг последовательности задач **Задать переменную последовательности задач** , чтобы задать значение переменной, используемой с последовательностью задач.  

Этот шаг может быть выполнен либо в стандартной операционной системе, либо в среде предустановки Windows. Переменные последовательности задач считываются действиями последовательности задач и определяют поведение этих действий. Дополнительные сведения о конкретных переменных последовательности задач см. в разделе [Переменные действия последовательности задач](task-sequence-action-variables.md).  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Короткое определенное пользователем имя для этого шага последовательности задач.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Переменная последовательности задач**  
 Определенное пользователем имя переменной последовательности задач.  

 **Значение**  
 Значение, связанное с переменной последовательности задач. Значением может быть другая переменная последовательности задач при использовании синтаксиса %<имя_переменной\>%.  

## <a name="hide-task-sequence-progress"></a>Скрытие хода выполнения последовательности задач
<!-- 1354291 -->
В выпуске 1706 вы получаете новую переменную, которая указывает, нужно ли демонстрировать пользователям ход выполнения последовательности задач. В последовательности задач с помощью шага **Задать переменную последовательности задач** укажите значение для переменной **TSDisableProgressUI**, чтобы скрыть или отобразить ход выполнения последовательности задач. Шаг задания переменной последовательности задач можно использовать в последовательности задач многократно, чтобы изменять значение переменной. Так вы сможете скрывать или отображать ход выполнения последовательности задач на разных этапах последовательности задач.

 - **Скрытие хода выполнения последовательности задач**  
В редакторе последовательности задач, используйте шаг [Задать переменную последовательности задач](#BKMK_SetTaskSequenceVariable), чтобы присвоить переменной **TSDisableProgressUI** значение **True** и скрыть ход выполнения последовательности задач.

 - **Отображение хода выполнения последовательности задач**  
В редакторе последовательности задач, используйте шаг [Задать переменную последовательности задач](#BKMK_SetTaskSequenceVariable), чтобы присвоить переменной **TSDisableProgressUI** значение **False** и отобразить ход выполнения последовательности задач.

##  <a name="BKMK_SetupWindowsandConfigMgr"></a> Настройка Windows и Configuration Manager  
 Шаг последовательности задач **Настройка Windows и Configuration Manager** используется для перехода от среды предустановки Windows к новой операционной системе. Он является обязательным этапом любого развертывания операционной системы. В этом шаге выполняется установка клиента Configuration Manager в новой операционной системе и подготовка к продолжению выполнения последовательности задач в новой операционной системе.  

 Этот шаг выполняется только в среде предустановки Windows. Он не работает в стандартной операционной системе. Дополнительные сведения о переменных последовательности задач для этого действия см. в разделе [Переменные действия последовательности задач "Настройка Windows и Configuration Manager"](task-sequence-action-variables.md#BKMK_SetupWindows).  

 Действие последовательности задач **Настройка Windows и Configuration Manager** заменяет переменные каталогов sysprep.inf или unattend.xml, такие как %WINDIR% и %ProgramFiles%, на каталог установки Windows PE X:\Windows. Переменные последовательности задач, заданные при помощи этих переменных среды, будут проигнорированы.  

 Используйте этот шаг последовательности задач для выполнения указанных ниже действий.  

1.  Предварительные условия: Windows PE  

    1.  Замена переменных последовательности задач в файле unattend.xml.  

    2.  Загрузка пакета, содержащего клиент Configuration Manager, и помещение этого пакета в развертываемый образ.  

2.  Настройка Windows  

    1.  Установка с использованием образа.  

        1.  Отключение клиента Configuration Manager в образе (то есть отключение автоматического запуска для службы клиента Configuration Manager).  

        2.  Обновление реестра в развертываемом образе, чтобы развернутая операционная система загружалась с диска с той же буквой, что и на эталонном компьютере.  

        3.  Перезапускает компьютер с использованием развернутой операционной системы.  

        4.  Запуск мини-установки Windows с использованием ранее указанного файла sysprep.inf или unattend.xml без какого-либо взаимодействия с пользователем. Примечание. Если в шаге последовательности задач **Применить параметры сети** указан домен, к которому следует присоединить компьютер, все необходимые для этого сведения будут содержаться в файле sysprep.inf или unattend.xml и программа мини-установки Windows присоединит компьютер к домену.  

    2.  Установка с использованием файла Setup.exe.  Запускает Setup.exe для выполнения обычного процесса установки Windows:  

        1.  Копирование на жесткий диск пакета установки операционной системы, указанного в предыдущем шаге последовательности задач **Применить операционную систему** .  

        2.  Перезагружает компьютер с использованием развернутой операционной системы.  

        3.  Запуск мини-установки Windows с использованием ранее указанного файла sysprep.inf или unattend.xml без учета каких-либо параметров пользовательского интерфейса. Примечание. Если в шаге последовательности задач **Применить параметры сети** указан домен, к которому следует присоединить компьютер, все необходимые для этого сведения будут содержаться в файле sysprep.inf или unattend.xml и программа мини-установки Windows присоединит компьютер к домену.  

3.  Настройка клиента Configuration Manager  

    1.  После завершения мини-установки Windows выполнение последовательности задач будет продолжено с использованием setupcomplete.cmd.  

    2.  Включение или отключение учетной записи локального администратора в зависимости от параметра, выбранного в шаге **Применить параметры Windows** .  

    3.  Установка клиента Configuration Manager с использованием ранее загруженного пакета (1.b) и свойств установки, заданных в редакторе последовательности задач. Клиент устанавливается в "режиме инициализации", чтобы он не обрабатывал новые запросы политики, пока не завершится выполнение последовательности задач.  

    4.  Ожидание, пока клиент перейдет в рабочее состояние.  

    5.  Если компьютер работает в среде с включенной защитой доступа к сети, клиент проверяет наличие и выполняет установку всех необходимых обновлений, чтобы они были установлены до того, как будет продолжено выполнение последовательности задач.  

4.  Продолжение выполнения последовательности задач со следующего шага.  

> [!NOTE]  
>  При выполнении действия последовательности задач **Настройка Windows и Configuration Manager** на компьютерах с только что установленной операционной системой должна быть запущена групповая политика. Групповая политика применяется по завершении последовательности задач.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Не выбирайте этот вариант, если требуется продолжение выполнения последовательности задач при возникновении ошибки на этом шаге. При возникновении ошибки произойдет сбой последовательности задач независимо от того, выбран этот вариант или нет.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется на этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет клиента**  
 Пакет установки клиента Configuration Manager, который будет использоваться в этом действии последовательности задач. Нажмите кнопку **Обзор** и выберите пакет, с помощью которого будет устанавливаться клиент Configuration Manager.  

 **Использовать пакет подготовительной версии клиента при наличии**  
 Указывает, что, если доступен пакет подготовительной версии клиента, данный шаг последовательности задач будет использовать этот пакет вместо пакета рабочей версии клиента. Обычно предварительная версия клиента — это более новая версия, тестируемая в рабочей среде. Нажмите кнопку **Обзор** и выберите пакет подготовительной версии клиента, с помощью которого будет устанавливаться клиент Configuration Manager.  

 **Свойства установки**  
 Назначение сайта и конфигурация по умолчанию будут автоматически заданы действием последовательности задач. В этом поле можно указывать любые дополнительные свойства установки, которые будут выполняться при установке клиента. Чтобы ввести несколько свойств установки, разделите их пробелами.  

 Вы можете указать параметры командной строки для использования во время установки клиента. Например, вы можете ввести **/skipprereq: silverlight.exe** , чтобы указать CCMSetup.exe, что не следует устанавливать необходимый компонент Microsoft Silverlight. Дополнительные сведения о доступных параметрах командной строки для CCMSetup.exe см. в разделе [Сведения о свойствах установки клиента в System Center Configuration Manager](../../core/clients/deploy/about-client-installation-properties.md).  

##  <a name="BKMK_UpgradeOS"></a> Обновление операционной системы  
 Используйте шаг последовательности задач **Обновить операционную систему** для обновления существующей операционной системы Windows 7, Windows 8, Windows 8.1 или Windows 10 до Windows 10.  

 Этот шаг выполняется только в стандартной операционной системе. Он не работает в среде предустановки Windows.  

### <a name="details"></a>Подробные сведения  
 На вкладке **Свойства** этого шага можно настроить параметры, описанные в этой статье.  

 Кроме того, на вкладке **Параметры** можно выполнить следующие действия.  

-   Отключить шаг.  

-   Укажите это действие в случае продолжения выполнения последовательности задач при возникновении ошибки в шаге.  

-   Укажите условия, которые должны быть соблюдены для выполнения шага.  

 **Имя**  
 Указывает краткое, определяемое пользователем имя, описывающее действие, которое выполняется в этом шаге.  

 **Описание**  
 Дополнительные сведения о действии, которое выполняется на этом шаге.  

 **Пакет обновления**  
 Выберите этот параметр, чтобы указать пакет обновления операционной системы Windows 10, используемый для обновления.  

 **Исходный путь**  
 Указывает локальный или сетевой путь к носителю Windows 10, который планируется использовать (соответствует параметру командной строки /installFrom). Кроме того, вы можете указать переменную, например %mycontentpath% или % DPC01%. Если для исходного пути используется переменная, ее необходимо указать ранее в последовательности задач. Например, если вы используете шаг [Скачать содержимое пакета](#BKMK_DownloadPackageContent) в последовательности задач, вы можете указать переменную для расположения пакета обновления операционной системы. Затем вы можете использовать эту переменную для исходного пути в этом шаге.  

 **Выпуск**  
 Укажите выпуск на носителе операционной системы, используемый для обновления.  

 **Ключ продукта**  
 Введите ключ продукта для применения в процессе обновления.  

 **Укажите следующие драйверы для установщика Windows в ходе обновления**  
 Выберите этот параметр для добавления драйверов на конечный компьютер в ходе процесса обновления (соответствует параметру командной строки /InstallDriver). Драйверы должны быть совместимы с Windows 10. Выберите один из следующих вариантов.  

-   **Пакет драйверов**: нажмите кнопку **Обзор** и выберите существующий пакет драйверов в списке.  

-   **Промежуточное содержимое**: выберите этот параметр, чтобы указать расположение пакета драйверов. Вы можете указать локальную папку, сетевой путь или переменную последовательности задач. Если для исходного пути используется переменная, ее необходимо указать ранее в последовательности задач. Например, с помощью шага [Загрузить содержимое пакета](task-sequence-steps.md#BKMK_DownloadPackageContent).  

 **Время ожидания (минут)**  
 Указывает количество минут, в течение которых должна выполняться программа установки, прежде чем Configuration Manager завершает последовательность задач со сбоем.  

 **Выполнять проверку совместимости программы установки Windows без запуска обновления**  
 Указывает, что необходимо выполнить проверку совместимости программы установки Windows без запуска процесса обновления (соответствует параметру командной строки /Compat ScanOnly). При использовании этого параметра по-прежнему необходимо развернуть весь источник установки. Программа установки возвращает код выхода в качестве результата проверки. В следующей таблице приведены некоторые из наиболее распространенных кодов выхода.  

|Код выхода|Подробные сведения|  
|-|-|  
|MOSETUP_E_COMPAT_SCANONLY (0xC1900210)|Нет проблем совместимости ("успех").|  
|MOSETUP_E_COMPAT_INSTALLREQ_BLOCK (0xC1900208)|Проблемы функциональной совместимости.|  
|MOSETUP_E_COMPAT_MIGCHOICE_BLOCK (0xC1900204)|Выбранный вариант миграции недоступен. Например, обновление с профессионального выпуска до корпоративного.|  
|MOSETUP_E_COMPAT_SYSREQ_BLOCK (0xC1900200)|Не подходит для Windows 10.|  
|MOSETUP_E_COMPAT_INSTALLDISKSPACE_BLOCK (0xC190020E)|Недостаточно свободного места на диске.|  

 Дополнительные сведения об этом параметре см. в статье [Параметры командной строки программы установки Windows](https://msdn.microsoft.com/library/windows/hardware/dn938368\(v=vs.85\).aspx).  

 **Пропускать маловажные сообщения о совместимости**  
 Указывает, что программа установки завершит установку, игнорируя все маловажные сообщения о совместимости (соответствует параметру командной строки /Compat IgnoreWarning).  

 **Динамическое обновление установки Windows в Центре обновления Windows**  
 Указывает, будет ли программа установки выполнять операции динамического обновления, такие как поиск, скачивание и установка обновлений (соответствует параметру командной строки /DynamicUpdate). Этот параметр не совместим с обновлениями программного обеспечения Configuration Manager, но его можно включить при обработке обновлений с помощью служб WSUS (автономный режим) или Центра обновления Windows.  

 **Переопределение политики (Центр обновления Майкрософт по умолчанию)**: выберите этот параметр, чтобы временно переопределить локальную политику в режиме реального времени для выполнения операций динамического обновления и дать компьютеру возможность получить обновления из Центра обновления Windows.  
