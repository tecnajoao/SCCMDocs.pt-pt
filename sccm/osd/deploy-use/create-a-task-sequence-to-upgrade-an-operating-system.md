---
title: "Создание последовательности задач для обновления операционной системы | Документация Майкрософт"
description: "Последовательности задач в System Center Configuration Manager позволяют выполнять автоматическое обновление операционной системы Windows 7 или более поздних версий до Windows 10."
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 7591e386-a9ab-4640-8643-332dce5aa006
caps.latest.revision: "12"
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.openlocfilehash: 4a3c69edc85a4ea7501510b6b3f12c72ad3a24ff
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2017
---
# <a name="create-a-task-sequence-to-upgrade-an-operating-system-in-system-center-configuration-manager"></a>Создание последовательности задач для обновления операционной системы в System Center Configuration Manager

*Применимо к: System Center Configuration Manager (Current Branch)*

Используйте последовательности задач в System Center Configuration Manager для автоматического обновления операционной системы Windows 7 или более поздних версий до Windows 10, а также Windows Server 2012 или более поздних версий до Windows Server 2016 на целевом компьютере. Вы создаете последовательность задач, обращающуюся к образу операционной системы, который требуется установить на целевом компьютере, а также любому дополнительному содержимому (например, к приложениям или обновлениям программного обеспечения), которое требуется установить. Последовательность задач для обновления операционной системы входит в состав сценария [Обновление Windows до последней версии](upgrade-windows-to-the-latest-version.md).  

##  <a name="BKMK_UpgradeOS"></a> Создание последовательности задач для обновления операционной системы  
 Чтобы обновить операционную систему на компьютерах, можно создать последовательность задач и выбрать **Обновить операционную систему из пакета обновления** в мастере создания последовательности задач. Мастер добавит шаги по обновлению операционной системы, применению обновлений программного обеспечения и установке приложений. Прежде чем создавать последовательность задач, необходимо выполнить следующие требования:    

-   **Обязательное**  

     - В консоли Configuration Manager должен быть доступен [пакет обновления операционной системы](../get-started/manage-operating-system-upgrade-packages.md).
     - При обновлении до Windows Server 2016 вам нужно выбрать параметр **Ignore any dismissable compatibility messages** (Пропускать отклоняемые сообщения о совместимости) в шаге последовательности задач обновления операционной системы. В противном случае обновление завершится ошибкой.

-   **Обязательно (если используется)**  

    -   [Обновления программного обеспечения](../../sum/get-started/synchronize-software-updates.md) должны быть синхронизированы в консоли Configuration Manager.  

    -   [Приложения](../../apps/deploy-use/create-applications.md) должны быть добавлены в консоль Configuration Manager.  

#### <a name="to-create-a-task-sequence-that-upgrades-an-operating-system"></a>Создание последовательности задач, обновляющей операционную систему  

1.  В консоли Configuration Manager щелкните **Библиотека программного обеспечения**.  

2.  В рабочей области **Библиотека программного обеспечения** разверните узел **Операционные системы**и выберите элемент **Последовательности задач**.  

3.  В группе **Создать** вкладки **Главная** выберите команду **Создать последовательность задач** , чтобы запустить мастер создания последовательности задач.  

4.  На странице **Создание новой последовательности задач** выберите элемент **Обновить операционную систему из пакета обновления**и нажмите кнопку **Далее**.  

5.  На странице **Сведения о последовательности задач** настройте следующие параметры, затем нажмите кнопку **Далее**.  

    -   **Имя последовательности задач**. Укажите имя последовательности задач.  

    -   **Описание**. Введите описание задачи, выполняющейся последовательностью.  

6.  На странице **Обновление операционной системы Windows** настройте следующие параметры, а затем нажмите кнопку **Далее**.  

    -   **Пакет обновления**. Укажите пакет обновления, содержащий исходные файлы обновления операционной системы. Убедитесь, что выбран правильный пакет обновления, просмотрев информацию в области **Свойства** . Дополнительные сведения см. в статье [Управление пакетами обновления операционной системы](../get-started/manage-operating-system-upgrade-packages.md).  

    -   **Edition index**(Индекс выпуска). Если в пакете доступно несколько индексов выпусков операционной системы, выберите нужный индекс выпуска. По умолчанию выбран первый элемент.  

    -   **Ключ продукта**. Введите ключ продукта для устанавливаемой операционной системы Windows. Можно указать зашифрованные ключи многократной установки или стандартные ключи продукта. Если вы используете незашифрованный ключ продукта, каждая группа из пяти символов должна быть разделена дефисом (-). Например, *XXXXX-XXXXX-XXXXX-XXXXX-XXXXX*. При установке новой версии выпуска в рамках корпоративного лицензирования ключ продукта не требуется. Ключ продукта необходим только при обновлении розничной версии Windows.  

    -   **Ignore any dismissable compatibility messages** (Игнорировать все отклоняемые сообщения о совместимости). Выберите этот параметр при обновлении до Windows Server 2016. Если этот параметр не выбран, последовательность задач не удастся завершить, так как программа установки Windows будет ожидать, пока пользователь щелкнет **Подтвердить** в диалоговом окне совместимости приложений Windows.   

7.  На странице **Включить обновления** укажите, следует ли устанавливать только обязательные обновления ПО, все обновления или не устанавливать их вообще, и нажмите кнопку **Далее**. Если выбран вариант установки обновлений программного обеспечения, Configuration Manager устанавливает только те обновления ПО, которые относятся к коллекциям, в которые входит конечный компьютер.  

8.  На странице **Установить приложения** укажите приложения, которые необходимо установить на конечный компьютер, а затем нажмите кнопку **Далее**. Если задано несколько приложений, можно настроить продолжение выполнения последовательности задач в случае сбоя установки определенного приложения.  

9. Завершите работу мастера.  



## <a name="configure-pre-cache-content"></a>Настройка предварительного кэширования содержимого
Начиная с версии 1702 для доступных развертываний последовательностей задач можно использовать функцию предварительного кэширования, благодаря которой клиенты будут скачивать только необходимое содержимое, прежде чем пользователь установит содержимое.
> [!TIP]  
> Предварительное кэширование появилось в версии 1702 и пока находится в статусе предварительной версии. Сведения о ее включении см. в статье [Использование функций предварительной версии из обновлений](/sccm/core/servers/manage/pre-release-features).

Например, предположим, что нужно развернуть последовательность задач обновления Windows 10 на месте, требуется единственная последовательность задач для всех пользователей и имеется несколько архитектур или языков. В версиях до 1702 содержимое для доступного развертывания скачивается только после того, как пользователь нажмет кнопку **Установить** в центре программного обеспечения. Из-за этого момент, когда установка может начаться, откладывается еще на некоторое время. Кроме того, скачивается все содержимое, указанное в последовательности задач. Сюда относятся пакеты обновления операционной системы для всех языков и архитектур. Если размер каждого из них составляет приблизительно 3 ГБ, скачиваемый пакет может быть весьма большим.

Предварительное кэширование содержимого позволяет предоставить клиенту возможность скачивать только нужное содержимое, когда будет получено развертывание. Поэтому, когда пользователь нажимает кнопку **Установить** в центре программного обеспечения, содержимое готово и установка начинается быстро, так как содержимое находится на локальном жестком диске.

### <a name="to-configure-the-pre-cache-feature"></a>Настройка функции предварительного кэширования

1. Создайте пакеты обновления операционной системы для определенных архитектур и языков. Укажите архитектуру и язык на вкладке **Источник данных** пакета. Для языка используйте десятичное преобразование (например, 1033 — это десятичное обозначение английского языка, а 0x0409 — шестнадцатеричный эквивалент). Подробные сведения см. в разделе [Создание последовательности задач для обновления операционной системы](/sccm/osd/deploy-use/create-a-task-sequence-to-upgrade-an-operating-system).

    Значения архитектуры и языка позволяют сопоставить условия шагов последовательности задач. Вы создадите их на следующем шаге, чтобы определить необходимость предварительного кэширования пакета обновления операционной системы.
2. Создайте последовательность задач с условными шагами для разных языков и архитектур. Например, для английской версии можно создать шаг наподобие следующего:

    ![свойства предварительного кэширования](../media/precacheproperties2.png)

    ![параметры предварительного кэширования](../media/precacheoptions2.png)  

3. Выполнить развертывание последовательности задач. Для функции предварительного кэширования настройте указанные ниже значения.
    - На вкладке **Общие** выберите **Предварительно скачивать содержимое для этой последовательности задач**.
    - На вкладке **Параметры развертывания** настройте последовательность задач с **целью** **Доступное**. Если вы создадите **обязательное** развертывание, функция предварительного кэширования работать не будет.
    - На вкладке **Планирование** для параметра **Развертывание доступно с** выберите время в будущем, чтобы у клиентов было достаточно времени для предварительного кэширования содержимого перед тем, как развертывание станет доступно пользователям. Например, можно указать, что развертывание будет доступно через 3 часа.  
    - На вкладке **Точки развертывания** настройте **Параметры развертывания**. Если содержимое не было предварительно кэшировано на клиенте, когда пользователь начинает установку, применяются эти параметры.


### <a name="user-experience"></a>Взаимодействие с пользователем
- Когда клиент получает политику развертывания, он начинает предварительно кэшировать содержимое. Сюда относится все содержимое, на которое имеются ссылки (любые другие типы пакетов), и только тот пакет обновления операционной системы, который соответствует клиенту согласно условиям, заданным в последовательности задач.
- Когда развертывание становится доступным пользователям (параметр на вкладке **Планирование** развертывания), выводится уведомление, сообщающее пользователям о новом развертывании, и развертывание отображается в центре программного обеспечения. Пользователь может перейти в центр программного обеспечения и нажать кнопку **Установить**, чтобы начать установку.
- Если предварительное кэширование содержимого не было выполнено полностью, то применяются параметры, указанные на вкладке **Параметры развертывания** развертывания. Мы рекомендуем, чтобы с момента создания развертывания до того момента, когда оно станет доступно пользователям, было достаточно времени для предварительного кэширования содержимого клиентами.



## <a name="download-package-content-task-sequence-step"></a>Шаг последовательности задач "Скачать содержимое пакета"  
 Шаг [Скачать содержимое пакета](../understand/task-sequence-steps.md#BKMK_DownloadPackageContent) можно использовать перед шагом **Обновить операционную систему** в следующих сценариях:  

-   Вы используете единственную последовательность задач обновления, которая может работать с платформами x86 и x64. Для этого включите в группу **Подготовка к обновлению** два шага **Скачать содержимое пакета** с условиями обнаружения архитектуры клиента и скачивания только соответствующего пакета обновления операционной системы. Настройте каждый шаг **Скачать содержимое пакета** так, чтобы использовалась одна и та же переменная, и используйте переменную для пути к носителю в шаге **Обновить операционную систему** .  

-   Для динамического скачивания применимого пакета драйверов используйте два шага загрузки **Скачать содержимое пакета** с условиями определения соответствующего типа оборудования для каждого пакета драйверов. Настройте каждый шаг **Скачать содержимое пакета** так, чтобы использовалась одна и та же переменная, и используйте переменную для значения **Промежуточное содержимое** в разделе драйверов в шаге **Обновить операционную систему** .  

   > [!NOTE]
   > При наличии более одного пакета Configuration Manager добавляет к имени переменной числовой суффикс. Например, если указать переменную %mycontent% как пользовательскую переменную, это корневой элемент для сохранения всего содержимого, на которое указывает ссылка (оно может быть представлено несколькими пакетами). При ссылке на эту переменную в последующем шаге, таком как "Обновить операционную систему", она используется с числовым суффиксом. В этом примере используются переменные %mycontent01% или %mycontent02%, где номер соответствует порядку указания пакета в этом шаге.

## <a name="optional-post-processing-task-sequence-steps"></a>Дополнительные шаги последовательности задач постобработки  
 После создания последовательности задач можно добавить дополнительные шаги по удалению приложений с известными проблемами совместимости или добавить действия постобработки, которые должны выполняться после перезапуска компьютера и успешного завершения обновления до Windows 10. Добавьте следующие дополнительные шаги в группу постобработки последовательности задач.  

> [!NOTE]  
>  Так как эта последовательность задач не является линейной, существуют условия для шагов, которые могут повлиять на результаты последовательности задач в зависимости от того, был ли успешно обновлен клиентский компьютер или необходим откат клиентского компьютера до версии операционной системы, с которой начиналась процедура обновления.  

## <a name="optional-rollback-task-sequence-steps"></a>Дополнительные шаги последовательности задач отката  
 В случае возникновения проблем с обновлением после перезагрузки компьютера программа установки выполнит откат обновления до предыдущей операционной системы, а выполнение последовательности задач будет продолжено по шагам в группе отката. После создания последовательности задач можно добавить дополнительные шаги в группу отката.  

## <a name="folder-and-files-removed-after-computer-restart"></a>Папка и файлы, удаляемые после перезапуска компьютера  
 После завершения последовательности задач для обновления операционной системы до Windows 10 и всех остальных действий в последовательности задач сценарии после обработки и сценарии отката не удаляются до перезагрузки компьютера.  Эти файлы сценариев не содержат конфиденциальной информации.  
